"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/index.ts
var src_exports = {};
__export(src_exports, {
  AppleMusicExtractor: () => AppleMusicExtractor,
  AttachmentExtractor: () => AttachmentExtractor,
  BridgeProvider: () => BridgeProvider,
  BridgeSource: () => BridgeSource,
  BridgedExtractor: () => BridgedExtractor,
  Internal: () => internal_exports,
  ReverbnationExtractor: () => ReverbnationExtractor,
  SoundCloudExtractor: () => SoundCloudExtractor,
  SpotifyExtractor: () => SpotifyExtractor,
  UA: () => UA,
  VimeoExtractor: () => VimeoExtractor,
  YouTubeExtractor: () => YoutubeExtractor,
  YouTubeLibs: () => YouTubeLibs,
  YoutubeExtractor: () => YoutubeExtractor,
  createBridgeProvider: () => createBridgeProvider,
  createImport: () => createImport,
  defaultBridgeProvider: () => defaultBridgeProvider,
  fetch: () => fetch,
  filterSoundCloudPreviews: () => filterSoundCloudPreviews,
  loadYtdl: () => loadYtdl,
  lyricsExtractor: () => lyricsExtractor,
  makeSCSearch: () => makeSCSearch,
  makeYTSearch: () => makeYTSearch,
  pullSCMetadata: () => pullSCMetadata,
  pullYTMetadata: () => pullYTMetadata,
  version: () => version
});
module.exports = __toCommonJS(src_exports);

// src/extractors/SoundCloudExtractor.ts
var import_discord_player = require("discord-player");
var SoundCloud = __toESM(require("soundcloud.ts"));

// src/extractors/common/helper.ts
var import_youtube_sr = require("youtube-sr");
var import_isomorphic_unfetch = __toESM(require("isomorphic-unfetch"));
var import_http = __toESM(require("http"));
var import_https = __toESM(require("https"));
var factory;
var createImport = /* @__PURE__ */ __name((lib) => import(lib).catch(() => null), "createImport");
var UA = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.49";
var fetch = import_isomorphic_unfetch.default;
var YouTubeLibs = [
  "youtube-ext",
  "ytdl-core",
  "@distube/ytdl-core",
  "play-dl",
  "yt-stream"
  // add more to the list if you have any
];
var ERR_NO_YT_LIB = new Error(`Could not load youtube library. Install one of ${YouTubeLibs.map((lib) => `"${lib}"`).join(", ")}`);
var forcedLib = process.env.DP_FORCE_YTDL_MOD;
if (forcedLib)
  YouTubeLibs.unshift(...forcedLib.split(","));
var httpAgent;
var httpsAgent;
async function loadYtdl(options, force = false) {
  if (factory && !force)
    return factory;
  let lib, _ytLibName, _stream;
  for (const ytlib of YouTubeLibs) {
    lib = await import(ytlib).then(
      (m) => m,
      () => null
    );
    if (!lib)
      continue;
    lib = lib.default || lib;
    _ytLibName = ytlib;
    break;
  }
  if (lib) {
    const isYtdl = ["ytdl-core"].some((lib2) => lib2 === _ytLibName);
    const hlsRegex = /\/manifest\/hls_(variant|playlist)\//;
    _stream = /* @__PURE__ */ __name(async (query, extractor, demuxable = false) => {
      const planner = extractor.context.player.routePlanner;
      const applyPlannerConfig = /* @__PURE__ */ __name((opt, applyAgents = false) => {
        if (planner) {
          try {
            const { ip, family } = planner.getIP();
            if (!applyAgents) {
              opt.requestOptions.localAddress = ip;
              opt.requestOptions.family = family;
            } else {
              const options2 = opt?.requestOptions || {};
              options2.localAddress = ip;
              options2.family = family;
              if (!httpAgent)
                httpAgent = new import_http.default.Agent(options2);
              if (!httpsAgent)
                httpsAgent = new import_https.default.Agent(options2);
              return Object.assign(opt, {
                requestOptions: options2,
                httpAgent,
                httpsAgent
              });
            }
          } catch {
          }
        }
        return opt;
      }, "applyPlannerConfig");
      if (_ytLibName === "youtube-ext") {
        const dl = lib;
        const opt = applyPlannerConfig(
          {
            ...options,
            requestOptions: options?.requestOptions || {}
          },
          true
        );
        const info = await dl.videoInfo(query, opt);
        const videoFormats = await dl.getFormats(info.stream, opt);
        if (demuxable) {
          const demuxableFormat = info.duration.lengthSec != "0" ? videoFormats.find((fmt2) => {
            return /audio\/webm; codecs="opus"/.test(fmt2.mimeType || "") && fmt2.audioSampleRate == "48000";
          }) : null;
          if (demuxableFormat) {
            return {
              stream: await dl.getReadableStream(demuxableFormat, opt),
              $fmt: "webm/opus"
            };
          }
        }
        const formats = videoFormats.filter((format) => {
          if (!format.url)
            return false;
          if (info.isLive)
            return dl.utils.isHlsContentURL(format.url) && format.url.endsWith(".m3u8");
          return typeof format.bitrate === "number";
        }).sort((a, b) => Number(b.bitrate) - Number(a.bitrate));
        const fmt = formats.find((format) => !format.qualityLabel) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        const url = fmt?.url;
        if (!url)
          throw new Error(`Failed to parse stream url for ${query}`);
        return url;
      } else if (isYtdl) {
        const dl = lib;
        const info = await dl.getInfo(query, applyPlannerConfig(options));
        if (demuxable) {
          const filter = /* @__PURE__ */ __name((format2) => {
            return format2.codecs === "opus" && format2.container === "webm" && format2.audioSampleRate == "48000";
          }, "filter");
          const format = info.formats.find(filter);
          if (format && info.videoDetails.lengthSeconds != "0") {
            return {
              stream: dl.downloadFromInfo(info, {
                ...applyPlannerConfig(options),
                filter
              }),
              $fmt: "webm/opus"
            };
          }
        }
        const formats = info.formats.filter((format) => {
          return info.videoDetails.isLiveContent ? format.isHLS && format.hasAudio : format.hasAudio;
        }).sort((a, b) => Number(b.audioBitrate) - Number(a.audioBitrate) || Number(a.bitrate) - Number(b.bitrate));
        const fmt = formats.find((format) => !format.hasVideo) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        const url = fmt?.url;
        if (!url)
          throw new Error(`Failed to parse stream url for ${query}`);
        return url;
      } else if (_ytLibName === "@distube/ytdl-core") {
        const dl = lib;
        let opt;
        if (planner) {
          opt = {
            localAddress: planner.getIP().ip,
            autoSelectFamily: true
          };
        }
        const cookie = options?.requestOptions?.headers?.cookie;
        const agent = dl.createAgent(Array.isArray(cookie) ? cookie : void 0, opt);
        const reqOpt = {
          agent
        };
        if (cookie && !Array.isArray(cookie)) {
          reqOpt.requestOptions = {
            headers: {
              cookie
            }
          };
        }
        const info = await dl.getInfo(query, reqOpt);
        if (demuxable) {
          const filter = /* @__PURE__ */ __name((format2) => {
            return format2.codecs === "opus" && format2.container === "webm" && format2.audioSampleRate == "48000";
          }, "filter");
          const format = info.formats.find(filter);
          if (format && info.videoDetails.lengthSeconds != "0") {
            return {
              stream: dl.downloadFromInfo(info, {
                ...applyPlannerConfig(options),
                filter
              }),
              $fmt: "webm/opus"
            };
          }
        }
        const formats = info.formats.filter((format) => {
          return info.videoDetails.isLiveContent ? format.isHLS && format.hasAudio : format.hasAudio;
        }).sort((a, b) => Number(b.audioBitrate) - Number(a.audioBitrate) || Number(a.bitrate) - Number(b.bitrate));
        const fmt = formats.find((format) => !format.hasVideo) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        const url = fmt?.url;
        if (!url)
          throw new Error(`Failed to parse stream url for ${query}`);
        return url;
      } else if (_ytLibName === "play-dl") {
        const dl = lib;
        if (typeof options?.requestOptions?.headers?.cookie === "string") {
          dl.setToken({
            youtube: {
              cookie: options.requestOptions.headers.cookie
            }
          });
        }
        const info = await dl.video_info(query);
        if (demuxable) {
          try {
            const stream = await dl.stream(query, {
              discordPlayerCompatibility: false
            });
            return {
              stream: stream.stream,
              $fmt: stream.type
            };
          } catch {
          }
        }
        const formats = info.format.filter((format) => {
          if (!format.url)
            return false;
          if (info.video_details.live)
            return hlsRegex.test(format.url) && typeof format.bitrate === "number" || hlsRegex.test(format.url) && format.url.endsWith(".m3u8");
          return typeof format.bitrate === "number";
        }).sort((a, b) => Number(b.bitrate) - Number(a.bitrate));
        const fmt = formats.find((format) => !format.qualityLabel) || formats.sort((a, b) => Number(a.bitrate) - Number(b.bitrate))[0];
        const url = fmt?.url;
        if (!url)
          throw new Error(`Failed to parse stream url for ${query}`);
        return url;
      } else if (_ytLibName === "yt-stream") {
        const dl = lib;
        const cookie = options?.requestOptions?.headers?.cookie;
        if (cookie && typeof cookie === "string")
          dl.cookie = cookie;
        const decipher = await import("yt-stream/src/stream/decipher.js");
        const info = await dl.getInfo(query);
        info.formats = await decipher?.format_decipher(info.formats, info.html5player);
        const url = info.formats.filter((val) => val.mimeType.startsWith("audio") && val.audioQuality !== "AUDIO_QUALITY_LOW").map((val) => val.url);
        if (url.length !== 0)
          return url[0];
        return info.formats.filter((val) => val.mimeType.startsWith("audio")).map((val) => val.url)[0];
      } else {
        throw ERR_NO_YT_LIB;
      }
    }, "_stream");
  } else {
    throw ERR_NO_YT_LIB;
  }
  factory = { name: _ytLibName, stream: _stream, lib };
  return factory;
}
__name(loadYtdl, "loadYtdl");
async function makeYTSearch(query, opt) {
  const res = await import_youtube_sr.YouTube.search(query, {
    type: "video",
    safeSearch: opt?.safeSearch,
    requestOptions: opt
  }).catch(() => {
  });
  return res || [];
}
__name(makeYTSearch, "makeYTSearch");
async function makeSCSearch(query) {
  const { instance } = SoundCloudExtractor;
  if (!instance?.internal)
    return [];
  let data;
  try {
    const info = await instance.internal.tracks.searchV2({
      q: query,
      limit: 5
    });
    data = info.collection;
  } catch {
    const info = await instance.internal.tracks.searchAlt(query);
    data = info;
  }
  return filterSoundCloudPreviews(data);
}
__name(makeSCSearch, "makeSCSearch");
async function pullYTMetadata(ext, info) {
  const meta = await makeYTSearch(ext.createBridgeQuery(info), "video").then((r) => r[0]).catch(() => null);
  return meta;
}
__name(pullYTMetadata, "pullYTMetadata");
async function pullSCMetadata(ext, info) {
  const meta = await makeSCSearch(ext.createBridgeQuery(info)).then((r) => r[0]).catch(() => null);
  return meta;
}
__name(pullSCMetadata, "pullSCMetadata");
function filterSoundCloudPreviews(tracks) {
  const filtered = tracks.filter((t) => {
    if (typeof t.policy === "string")
      return t.policy.toUpperCase() === "ALLOW";
    return !(t.duration === 3e4 && t.full_duration > 3e4);
  });
  const result = filtered.length > 0 ? filtered : tracks;
  return result;
}
__name(filterSoundCloudPreviews, "filterSoundCloudPreviews");

// src/extractors/SoundCloudExtractor.ts
var _SoundCloudExtractor = class _SoundCloudExtractor extends import_discord_player.BaseExtractor {
  constructor() {
    super(...arguments);
    this.internal = new SoundCloud.default({
      clientId: this.options.clientId,
      oauthToken: this.options.oauthToken,
      proxy: this.options.proxy
    });
  }
  async activate() {
    this.protocols = ["scsearch", "soundcloud"];
    _SoundCloudExtractor.instance = this;
  }
  async deactivate() {
    this.protocols = [];
    _SoundCloudExtractor.instance = null;
  }
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [
      import_discord_player.QueryType.SOUNDCLOUD,
      import_discord_player.QueryType.SOUNDCLOUD_PLAYLIST,
      import_discord_player.QueryType.SOUNDCLOUD_SEARCH,
      import_discord_player.QueryType.SOUNDCLOUD_TRACK,
      import_discord_player.QueryType.AUTO,
      import_discord_player.QueryType.AUTO_SEARCH
    ].some((r) => r === type);
  }
  async getRelatedTracks(track, history) {
    if (track.queryType === import_discord_player.QueryType.SOUNDCLOUD_TRACK) {
      const data = await this.internal.tracks.relatedV2(track.url, 5);
      const unique = filterSoundCloudPreviews(data).filter((t) => !history.tracks.some((h) => h.url === t.permalink_url));
      return this.createResponse(
        null,
        (unique.length > 0 ? unique : data).map((trackInfo) => {
          const newTrack = new import_discord_player.Track(this.context.player, {
            title: trackInfo.title,
            url: trackInfo.permalink_url,
            duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(trackInfo.duration)),
            description: trackInfo.description ?? "",
            thumbnail: trackInfo.artwork_url,
            views: trackInfo.playback_count,
            author: trackInfo.user.username,
            requestedBy: track.requestedBy,
            source: "soundcloud",
            engine: trackInfo,
            queryType: import_discord_player.QueryType.SOUNDCLOUD_TRACK,
            metadata: trackInfo,
            requestMetadata: async () => {
              return trackInfo;
            },
            cleanTitle: trackInfo.title
          });
          newTrack.extractor = this;
          return newTrack;
        })
      );
    }
    return this.createResponse();
  }
  async handle(query, context) {
    if (context.protocol === "scsearch")
      context.type = import_discord_player.QueryType.SOUNDCLOUD_SEARCH;
    switch (context.type) {
      case import_discord_player.QueryType.SOUNDCLOUD_TRACK: {
        const trackInfo = await this.internal.tracks.getV2(query).catch(import_discord_player.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.permalink_url,
          duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description ?? "",
          thumbnail: trackInfo.artwork_url,
          views: trackInfo.playback_count,
          author: trackInfo.user.username,
          requestedBy: context.requestedBy,
          source: "soundcloud",
          engine: trackInfo,
          queryType: context.type,
          metadata: trackInfo,
          requestMetadata: async () => {
            return trackInfo;
          },
          cleanTitle: trackInfo.title
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      case import_discord_player.QueryType.SOUNDCLOUD_PLAYLIST: {
        const data = await this.internal.playlists.getV2(query).catch(import_discord_player.Util.noop);
        if (!data)
          return { playlist: null, tracks: [] };
        const res = new import_discord_player.Playlist(this.context.player, {
          title: data.title,
          description: data.description ?? "",
          thumbnail: data.artwork_url ?? data.tracks[0].artwork_url,
          type: "playlist",
          source: "soundcloud",
          author: {
            name: data.user.username,
            url: data.user.permalink_url
          },
          tracks: [],
          id: `${data.id}`,
          url: data.permalink_url,
          rawPlaylist: data
        });
        for (const song of data.tracks) {
          const track = new import_discord_player.Track(this.context.player, {
            title: song.title,
            description: song.description ?? "",
            author: song.user.username,
            url: song.permalink_url,
            thumbnail: song.artwork_url,
            duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(song.duration)),
            views: song.playback_count,
            requestedBy: context.requestedBy,
            playlist: res,
            source: "soundcloud",
            engine: song,
            queryType: context.type,
            metadata: song,
            requestMetadata: async () => {
              return song;
            },
            cleanTitle: song.title
          });
          track.extractor = this;
          track.playlist = res;
          res.tracks.push(track);
        }
        return { playlist: res, tracks: res.tracks };
      }
      default: {
        let tracks = await this.internal.tracks.searchV2({ q: query }).then((t) => t.collection).catch(import_discord_player.Util.noop);
        if (!tracks)
          tracks = await this.internal.tracks.searchAlt(query).catch(import_discord_player.Util.noop);
        if (!tracks || !tracks.length)
          return this.emptyResponse();
        tracks = filterSoundCloudPreviews(tracks);
        const resolvedTracks = [];
        for (const trackInfo of tracks) {
          if (!trackInfo.streamable)
            continue;
          const track = new import_discord_player.Track(this.context.player, {
            title: trackInfo.title,
            url: trackInfo.permalink_url,
            duration: import_discord_player.Util.buildTimeCode(import_discord_player.Util.parseMS(trackInfo.duration)),
            description: trackInfo.description ?? "",
            thumbnail: trackInfo.artwork_url,
            views: trackInfo.playback_count,
            author: trackInfo.user.username,
            requestedBy: context.requestedBy,
            source: "soundcloud",
            engine: trackInfo,
            queryType: "soundcloudTrack",
            metadata: trackInfo,
            requestMetadata: async () => {
              return trackInfo;
            }
          });
          track.extractor = this;
          resolvedTracks.push(track);
        }
        return { playlist: null, tracks: resolvedTracks };
      }
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const url = await this.internal.util.streamLink(info.url).catch(import_discord_player.Util.noop);
    if (!url)
      throw new Error("Could not extract stream from this track source");
    return url;
  }
  async bridge(track, sourceExtractor) {
    if (sourceExtractor?.identifier === this.identifier) {
      return this.stream(track);
    }
    const query = sourceExtractor?.createBridgeQuery(track) ?? `${track.author} - ${track.title}`;
    const info = await this.handle(query, {
      requestedBy: track.requestedBy,
      type: import_discord_player.QueryType.SOUNDCLOUD_SEARCH
    });
    if (!info.tracks.length)
      return null;
    return this.stream(info.tracks[0]);
  }
};
__name(_SoundCloudExtractor, "SoundCloudExtractor");
_SoundCloudExtractor.identifier = "com.discord-player.soundcloudextractor";
_SoundCloudExtractor.instance = null;
var SoundCloudExtractor = _SoundCloudExtractor;

// src/extractors/YoutubeExtractor.ts
var import_youtube_sr2 = require("youtube-sr");
var import_discord_player2 = require("discord-player");
var validQueryDomains = /* @__PURE__ */ new Set(["youtube.com", "www.youtube.com", "m.youtube.com", "music.youtube.com", "gaming.youtube.com"]);
var validPathDomains = /^https?:\/\/(youtu\.be\/|(www\.)?youtube\.com\/(embed|v|shorts)\/)/;
var idRegex = /^[a-zA-Z0-9-_]{11}$/;
var _YoutubeExtractor = class _YoutubeExtractor extends import_discord_player2.BaseExtractor {
  async activate() {
    this.protocols = ["ytsearch", "youtube"];
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._stream = (q) => {
        return fn(this, q);
      };
    } else {
      const { stream, name } = await loadYtdl(this.context.player.options.ytdlOptions);
      this._stream = stream;
      this._ytLibName = name;
    }
    process.emitWarning(
      "YoutubeExtractor uses scraping-based streaming libraries which is known to be unstable at times.\nAn alternative is to use discord-player-youtubei https://npm.im/discord-player-youtubei\nView this GitHub issue for more information: https://github.com/Androz2091/discord-player/issues/1922"
    );
    _YoutubeExtractor.instance = this;
  }
  async deactivate() {
    this.protocols = [];
    _YoutubeExtractor.instance = null;
  }
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [
      import_discord_player2.QueryType.YOUTUBE,
      import_discord_player2.QueryType.YOUTUBE_PLAYLIST,
      import_discord_player2.QueryType.YOUTUBE_SEARCH,
      import_discord_player2.QueryType.YOUTUBE_VIDEO,
      import_discord_player2.QueryType.AUTO,
      import_discord_player2.QueryType.AUTO_SEARCH
    ].some((r) => r === type);
  }
  async handle(query, context) {
    if (context.protocol === "ytsearch")
      context.type = import_discord_player2.QueryType.YOUTUBE_SEARCH;
    query = query.includes("youtube.com") ? query.replace(/(m(usic)?|gaming)\./, "") : query;
    if (!query.includes("list=RD") && _YoutubeExtractor.validateURL(query))
      context.type = import_discord_player2.QueryType.YOUTUBE_VIDEO;
    switch (context.type) {
      case import_discord_player2.QueryType.YOUTUBE_PLAYLIST: {
        const ytpl = await import_youtube_sr2.YouTube.getPlaylist(query, {
          fetchAll: true,
          // eslint-disable-next-line @typescript-eslint/no-explicit-any
          limit: context.requestOptions?.limit,
          requestOptions: context.requestOptions
        }).catch(import_discord_player2.Util.noop);
        if (!ytpl)
          return this.emptyResponse();
        const playlist = new import_discord_player2.Playlist(this.context.player, {
          title: ytpl.title,
          thumbnail: ytpl.thumbnail?.displayThumbnailURL("maxresdefault"),
          description: ytpl.title || "",
          type: "playlist",
          source: "youtube",
          author: {
            name: ytpl.channel.name,
            url: ytpl.channel.url
          },
          tracks: [],
          id: ytpl.id,
          url: ytpl.url,
          rawPlaylist: ytpl
        });
        playlist.tracks = ytpl.videos.map((video) => {
          const track = new import_discord_player2.Track(this.context.player, {
            title: video.title,
            description: video.description,
            author: video.channel?.name,
            url: video.url,
            requestedBy: context.requestedBy,
            thumbnail: video.thumbnail.url,
            views: video.views,
            duration: video.durationFormatted,
            raw: video,
            playlist,
            source: "youtube",
            queryType: "youtubeVideo",
            metadata: video,
            async requestMetadata() {
              return video;
            },
            live: video.live
          });
          track.extractor = this;
          track.playlist = playlist;
          return track;
        });
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player2.QueryType.YOUTUBE_VIDEO: {
        const id = /[a-zA-Z0-9-_]{11}/.exec(query);
        if (!id?.[0])
          return this.emptyResponse();
        const video = await import_youtube_sr2.YouTube.getVideo(`https://www.youtube.com/watch?v=${id}`, context.requestOptions).catch(import_discord_player2.Util.noop);
        if (!video)
          return this.emptyResponse();
        video.source = "youtube";
        const track = new import_discord_player2.Track(this.context.player, {
          title: video.title,
          description: video.description,
          author: video.channel?.name,
          url: video.url,
          requestedBy: context.requestedBy,
          thumbnail: video.thumbnail?.displayThumbnailURL("maxresdefault"),
          views: video.views,
          duration: video.durationFormatted,
          source: "youtube",
          raw: video,
          queryType: context.type,
          metadata: video,
          async requestMetadata() {
            return video;
          },
          live: video.live
        });
        track.extractor = this;
        return {
          playlist: null,
          tracks: [track]
        };
      }
      default: {
        const tracks = await this._makeYTSearch(query, context);
        return { playlist: null, tracks };
      }
    }
  }
  async _makeYTSearch(query, context) {
    const res = await makeYTSearch(query, context.requestOptions).catch(import_discord_player2.Util.noop);
    if (!res || !res.length)
      return [];
    return res.map((video) => {
      video.source = "youtube";
      const track = new import_discord_player2.Track(this.context.player, {
        title: video.title,
        description: video.description,
        author: video.channel?.name,
        url: video.url,
        requestedBy: context.requestedBy,
        thumbnail: video.thumbnail?.displayThumbnailURL("maxresdefault"),
        views: video.views,
        duration: video.durationFormatted,
        source: "youtube",
        raw: video,
        queryType: context.type,
        metadata: video,
        async requestMetadata() {
          return video;
        },
        live: video.live
      });
      track.extractor = this;
      return track;
    });
  }
  async getRelatedTracks(track, history) {
    let info = void 0;
    if (_YoutubeExtractor.validateURL(track.url))
      info = await import_youtube_sr2.YouTube.getVideo(track.url).then((x) => x.videos).catch(import_discord_player2.Util.noop);
    if (!info)
      info = await import_youtube_sr2.YouTube.search(track.author || track.title, { limit: 5, type: "video" }).then((x) => x).catch(import_discord_player2.Util.noop);
    if (!info?.length) {
      return this.createResponse();
    }
    const unique = info.filter((t) => !history.tracks.some((x) => x.url === t.url));
    const similar = (unique.length > 0 ? unique : info).map((video) => {
      const t = new import_discord_player2.Track(this.context.player, {
        title: video.title,
        url: `https://www.youtube.com/watch?v=${video.id}`,
        duration: video.durationFormatted || import_discord_player2.Util.buildTimeCode(import_discord_player2.Util.parseMS(video.duration * 1e3)),
        description: video.title,
        thumbnail: typeof video.thumbnail === "string" ? video.thumbnail : video.thumbnail.url,
        views: video.views,
        author: video.channel.name,
        requestedBy: track.requestedBy,
        source: "youtube",
        queryType: "youtubeVideo",
        metadata: video,
        async requestMetadata() {
          return video;
        },
        live: video.live
      });
      t.extractor = this;
      return t;
    });
    return this.createResponse(null, similar);
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    if (!this._stream) {
      throw new Error(`Could not find youtube streaming library. Install one of ${YouTubeLibs.join(", ")}`);
    }
    let url = info.url;
    url = url.includes("youtube.com") ? url.replace(/(m(usic)?|gaming)\./, "") : url;
    return this._stream(url, this, this.supportsDemux);
  }
  async bridge(track, sourceExtractor) {
    if (sourceExtractor?.identifier === this.identifier) {
      return this.stream(track);
    }
    const query = sourceExtractor?.createBridgeQuery(track) ?? `${track.author} - ${track.title}`;
    const info = await this.handle(query, {
      requestedBy: track.requestedBy,
      type: import_discord_player2.QueryType.YOUTUBE
    });
    if (!info.tracks.length)
      return null;
    return this.stream(info.tracks[0]);
  }
  static validateURL(link) {
    try {
      _YoutubeExtractor.parseURL(link);
      return true;
    } catch {
      return false;
    }
  }
  static validateId(id) {
    return idRegex.test(id.trim());
  }
  static parseURL(link) {
    const parsed = new URL(link.trim());
    let id = parsed.searchParams.get("v");
    if (validPathDomains.test(link.trim()) && !id) {
      const paths = parsed.pathname.split("/");
      id = parsed.host === "youtu.be" ? paths[1] : paths[2];
    } else if (parsed.hostname && !validQueryDomains.has(parsed.hostname)) {
      throw Error("Not a YouTube domain");
    }
    if (!id) {
      throw Error(`No video id found: "${link}"`);
    }
    id = id.substring(0, 11);
    if (!this.validateId(id)) {
      throw TypeError(`Video id (${id}) does not match expected format (${idRegex.toString()})`);
    }
    return id;
  }
};
__name(_YoutubeExtractor, "YoutubeExtractor");
_YoutubeExtractor.identifier = "com.discord-player.youtubeextractor";
var YoutubeExtractor = _YoutubeExtractor;

// src/extractors/LyricsExtractor.ts
var import_genius_lyrics = require("genius-lyrics");
var client;
function lyricsExtractor(apiKey, force) {
  if (!client && !force)
    client = new import_genius_lyrics.Client(apiKey);
  return { search, client };
}
__name(lyricsExtractor, "lyricsExtractor");
function search(query) {
  return new Promise((resolve, reject) => {
    if (typeof query !== "string")
      return reject(new TypeError(`Expected search query to be a string, received "${typeof query}"!`));
    client.songs.search(query).then(async (songs) => {
      const data = {
        title: songs[0].title,
        fullTitle: songs[0].fullTitle,
        id: songs[0].id,
        thumbnail: songs[0].thumbnail,
        image: songs[0].image,
        url: songs[0].url,
        artist: {
          name: songs[0].artist.name,
          id: songs[0].artist.id,
          url: songs[0].artist.url,
          image: songs[0].artist.image
        },
        lyrics: await songs[0].lyrics(false)
      };
      resolve(data);
    }).catch(() => {
      reject(new Error("Could not parse lyrics"));
    });
  });
}
__name(search, "search");

// src/extractors/VimeoExtractor.ts
var import_discord_player3 = require("discord-player");

// src/internal/Vimeo.ts
var import_http2 = __toESM(require("http"));
var import_https2 = __toESM(require("https"));
var _Vimeo = class _Vimeo {
  constructor() {
    throw new Error(`The ${this.constructor.name} class may not be instantiated!`);
  }
  /**
   * @typedef {Readable} Readable
   */
  /**
   * Downloads from vimeo
   * @param {number} id Vimeo video id
   * @returns {Promise<Readable>}
   */
  static download(id) {
    return new Promise(async (resolve) => {
      const info = await _Vimeo.getInfo(id);
      if (!info)
        return null;
      const downloader = info.stream.startsWith("https://") ? import_https2.default : import_http2.default;
      downloader.get(info.stream, (res) => {
        resolve(res);
      });
    });
  }
  /**
   * Returns video info
   * @param {number} id Video id
   */
  static async getInfo(id) {
    if (!id)
      throw new Error("Invalid id");
    const url = `https://player.vimeo.com/video/${id}`;
    try {
      const res = await fetch(url);
      const data = await res.text();
      const json = JSON.parse(data.split("window.playerConfig =")[1].split(";")[0].trim());
      const obj = {
        id: json.video.id,
        duration: json.video.duration * 1e3,
        title: json.video.title,
        url: json.video.url,
        thumbnail: json.video.thumbs["1280"] || json.video.thumbs.base,
        stream: json.request.files.progressive[0].url,
        author: {
          id: json.video.owner.id,
          name: json.video.owner.name,
          url: json.video.owner.url,
          avatar: json.video.owner.img_2x || json.video.owner.img
        }
      };
      return obj;
    } catch {
      return null;
    }
  }
};
__name(_Vimeo, "Vimeo");
var Vimeo = _Vimeo;

// src/extractors/VimeoExtractor.ts
var _VimeoExtractor = class _VimeoExtractor extends import_discord_player3.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player3.QueryType.VIMEO].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player3.QueryType.VIMEO: {
        const trackInfo = await Vimeo.getInfo(
          query.split("/").filter((x) => !!x).pop()
        ).catch(import_discord_player3.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player3.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player3.Util.buildTimeCode(import_discord_player3.Util.parseMS(trackInfo.duration || 0)),
          description: `${trackInfo.title} by ${trackInfo.author.name}`,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author.name,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.stream,
          queryType: context.type,
          metadata: trackInfo,
          async requestMetadata() {
            return trackInfo;
          }
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    if (engine) {
      return engine;
    }
    const track = await Vimeo.getInfo(info.url).catch(import_discord_player3.Util.noop);
    if (!track || !track.stream)
      throw new Error("Could not extract stream from this source");
    info.raw.engine = {
      streamURL: track.stream
    };
    return track.stream;
  }
};
__name(_VimeoExtractor, "VimeoExtractor");
_VimeoExtractor.identifier = "com.discord-player.vimeoextractor";
var VimeoExtractor = _VimeoExtractor;

// src/extractors/ReverbnationExtractor.ts
var import_discord_player4 = require("discord-player");
var import_reverbnation_scraper = __toESM(require("reverbnation-scraper"));
var _ReverbnationExtractor = class _ReverbnationExtractor extends import_discord_player4.BaseExtractor {
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player4.QueryType.REVERBNATION].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player4.QueryType.REVERBNATION: {
        const trackInfo = await import_reverbnation_scraper.default.getInfo(query).catch(import_discord_player4.Util.noop);
        if (!trackInfo)
          return this.emptyResponse();
        const track = new import_discord_player4.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player4.Util.buildTimeCode(import_discord_player4.Util.parseMS(trackInfo.duration)),
          description: trackInfo.lyrics || `${trackInfo.title} by ${trackInfo.artist.name}`,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.artist.name,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.streamURL,
          queryType: context.type,
          metadata: trackInfo,
          async requestMetadata() {
            return trackInfo;
          }
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    if (engine) {
      return engine;
    }
    const track = await import_reverbnation_scraper.default.getInfo(info.url).catch(import_discord_player4.Util.noop);
    if (!track || !track.streamURL)
      throw new Error("Could not extract stream from this source");
    info.raw.engine = {
      streamURL: track.streamURL
    };
    return track.streamURL;
  }
};
__name(_ReverbnationExtractor, "ReverbnationExtractor");
_ReverbnationExtractor.identifier = "com.discord-player.reverbnationextractor";
var ReverbnationExtractor = _ReverbnationExtractor;

// src/extractors/AttachmentExtractor.ts
var import_discord_player5 = require("discord-player");
var import_fs = require("fs");

// src/internal/downloader.ts
var import_http3 = __toESM(require("http"));
var import_https3 = __toESM(require("https"));
function downloadStream(url, opts = {}) {
  return new Promise((resolve, reject) => {
    const lib = url.startsWith("http://") ? import_http3.default : import_https3.default;
    lib.get(url, opts, (res) => resolve(res)).once("error", reject);
  });
}
__name(downloadStream, "downloadStream");

// src/extractors/AttachmentExtractor.ts
var fileType = __toESM(require("file-type"));
var import_path = __toESM(require("path"));
var import_promises = require("fs/promises");
var ATTACHMENT_HEADER = ["audio/", "video/", "application/ogg"];
var _AttachmentExtractor = class _AttachmentExtractor extends import_discord_player5.BaseExtractor {
  constructor() {
    super(...arguments);
    // use lowest priority to avoid conflict with other extractors
    this.priority = 0;
  }
  async validate(query, type) {
    if (typeof query !== "string")
      return false;
    return [import_discord_player5.QueryType.ARBITRARY, import_discord_player5.QueryType.FILE].some((r) => r === type);
  }
  async getRelatedTracks(track) {
    return this.createResponse();
  }
  async handle(query, context) {
    switch (context.type) {
      case import_discord_player5.QueryType.ARBITRARY: {
        const data = await downloadStream(query, context.requestOptions);
        if (!ATTACHMENT_HEADER.some((r) => !!data.headers["content-type"]?.startsWith(r)))
          return this.emptyResponse();
        const trackInfo = {
          title: (query.split("/").filter((x) => x.length).pop() ?? "Attachment").split("?")[0].trim(),
          duration: 0,
          thumbnail: "https://upload.wikimedia.org/wikipedia/commons/2/2a/ITunes_12.2_logo.png",
          engine: query,
          // eslint-disable-next-line
          author: data.client?.servername || "Attachment",
          // eslint-disable-next-line
          description: data.client?.servername || "Attachment",
          url: data.url || query
        };
        try {
          const mediaplex = require("mediaplex");
          const timeout = this.context.player.options.probeTimeout ?? 5e3;
          const { result, stream } = await Promise.race([
            mediaplex.probeStream(data),
            new Promise((_, r) => {
              setTimeout(() => r(new Error("Timeout")), timeout);
            })
          ]);
          if (result) {
            trackInfo.duration = result.duration * 1e3;
            const metadata = mediaplex.readMetadata(result);
            if (metadata.author)
              trackInfo.author = metadata.author;
            if (metadata.title)
              trackInfo.title = metadata.title;
            trackInfo.description = `${trackInfo.title} by ${trackInfo.author}`;
          }
          stream.destroy();
        } catch {
        }
        const track = new import_discord_player5.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player5.Util.buildTimeCode(import_discord_player5.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.url,
          queryType: context.type,
          metadata: trackInfo,
          async requestMetadata() {
            return trackInfo;
          }
        });
        track.extractor = this;
        track.raw.isFile = false;
        return { playlist: null, tracks: [track] };
      }
      case import_discord_player5.QueryType.FILE: {
        if (!(0, import_fs.existsSync)(query))
          return this.emptyResponse();
        const fstat = await (0, import_promises.stat)(query);
        if (!fstat.isFile())
          return this.emptyResponse();
        const mime = await fileType.fromFile(query).catch(() => null);
        if (!mime || !ATTACHMENT_HEADER.some((r) => !!mime.mime.startsWith(r)))
          return this.emptyResponse();
        const trackInfo = {
          title: import_path.default.basename(query) || "Attachment",
          duration: 0,
          thumbnail: "https://upload.wikimedia.org/wikipedia/commons/2/2a/ITunes_12.2_logo.png",
          engine: query,
          author: "Attachment",
          description: "Attachment",
          url: query
        };
        try {
          const mediaplex = require("mediaplex");
          const timeout = this.context.player.options.probeTimeout ?? 5e3;
          const { result, stream } = await Promise.race([
            mediaplex.probeStream(
              (0, import_fs.createReadStream)(query, {
                start: 0,
                end: 1024 * 1024 * 10
              })
            ),
            new Promise((_, r) => {
              setTimeout(() => r(new Error("Timeout")), timeout);
            })
          ]);
          if (result) {
            trackInfo.duration = result.duration * 1e3;
            const metadata = mediaplex.readMetadata(result);
            if (metadata.author)
              trackInfo.author = metadata.author;
            if (metadata.title)
              trackInfo.title = metadata.title;
            trackInfo.description = `${trackInfo.title} by ${trackInfo.author}`;
          }
          stream.destroy();
        } catch {
        }
        const track = new import_discord_player5.Track(this.context.player, {
          title: trackInfo.title,
          url: trackInfo.url,
          duration: import_discord_player5.Util.buildTimeCode(import_discord_player5.Util.parseMS(trackInfo.duration)),
          description: trackInfo.description,
          thumbnail: trackInfo.thumbnail,
          views: 0,
          author: trackInfo.author,
          requestedBy: context.requestedBy,
          source: "arbitrary",
          engine: trackInfo.url,
          queryType: context.type,
          metadata: trackInfo,
          async requestMetadata() {
            return trackInfo;
          }
        });
        track.extractor = this;
        track.raw.isFile = true;
        return { playlist: null, tracks: [track] };
      }
      default:
        return this.emptyResponse();
    }
  }
  emptyResponse() {
    return { playlist: null, tracks: [] };
  }
  async stream(info) {
    const engine = info.raw.engine;
    const isFile = info.raw.isFile;
    if (!engine)
      throw new Error("Could not find stream source");
    if (!isFile) {
      return engine;
    }
    return (0, import_fs.createReadStream)(engine);
  }
};
__name(_AttachmentExtractor, "AttachmentExtractor");
_AttachmentExtractor.identifier = "com.discord-player.attachmentextractor";
var AttachmentExtractor = _AttachmentExtractor;

// src/extractors/AppleMusicExtractor.ts
var import_discord_player8 = require("discord-player");

// src/internal/index.ts
var internal_exports = {};
__export(internal_exports, {
  AppleMusic: () => AppleMusic,
  SpotifyAPI: () => SpotifyAPI,
  Vimeo: () => Vimeo,
  downloadStream: () => downloadStream
});

// src/internal/AppleMusic.ts
var import_discord_player6 = require("discord-player");
var import_node_html_parser = require("node-html-parser");
function getHTML(link) {
  return fetch(link, {
    headers: {
      "User-Agent": UA
    }
  }).then((r) => r.text()).then(
    (txt) => (0, import_node_html_parser.parse)(txt),
    () => null
  );
}
__name(getHTML, "getHTML");
function makeImage({ height, url, width, ext = "jpg" }) {
  return url.replace("{w}", `${width}`).replace("{h}", `${height}`).replace("{f}", ext);
}
__name(makeImage, "makeImage");
function parseDuration(d) {
  const r = /* @__PURE__ */ __name((name, unit) => `((?<${name}>-?\\d*[\\.,]?\\d+)${unit})?`, "r");
  const regex = new RegExp(
    [
      "(?<negative>-)?P",
      r("years", "Y"),
      r("months", "M"),
      r("weeks", "W"),
      r("days", "D"),
      "(T",
      r("hours", "H"),
      r("minutes", "M"),
      r("seconds", "S"),
      ")?"
      // end optional time
    ].join("")
  );
  const test = regex.exec(d);
  if (!test || !test.groups)
    return "0:00";
  const dur = [test.groups.years, test.groups.months, test.groups.weeks, test.groups.days, test.groups.hours, test.groups.minutes, test.groups.seconds];
  return dur.filter((r2, i, a) => !!r2 || i > a.length - 2).map((m, i) => {
    if (!m)
      m = "0";
    return i < 1 ? m : m.padStart(2, "0");
  }).join(":") || "0:00";
}
__name(parseDuration, "parseDuration");
var _AppleMusic = class _AppleMusic {
  constructor() {
    return _AppleMusic;
  }
  static async search(query) {
    try {
      const url = `https://music.apple.com/us/search?term=${encodeURIComponent(query)}`;
      const node = await getHTML(url);
      if (!node)
        return [];
      const rawData = node.getElementById("serialized-server-data");
      if (!rawData)
        return [];
      const data = JSON.parse(rawData.innerText)[0].data.sections;
      const tracks = data.find((s) => s.itemKind === "trackLockup")?.items;
      if (!tracks)
        return [];
      return tracks.map((track) => ({
        id: track.contentDescriptor.identifiers.storeAdamID,
        duration: track.duration || "0:00",
        title: track.title,
        url: track.contentDescriptor.url,
        thumbnail: track?.artwork?.dictionary ? makeImage({
          url: track.artwork.dictionary.url,
          height: track.artwork.dictionary.height,
          width: track.artwork.dictionary.width
        }) : "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: track.subtitleLinks?.[0]?.title ?? "Unknown Artist"
        }
      }));
    } catch {
      return [];
    }
  }
  static async getSongInfoFallback(res, name, id, link) {
    try {
      const metaTags = res.getElementsByTagName("meta");
      if (!metaTags.length)
        return null;
      const title = metaTags.find((r) => r.getAttribute("name") === "apple:title")?.getAttribute("content") || res.querySelector("title")?.innerText || name;
      const contentId = metaTags.find((r) => r.getAttribute("name") === "apple:content_id")?.getAttribute("content") || id;
      const durationRaw = metaTags.find((r) => r.getAttribute("property") === "music:song:duration")?.getAttribute("content");
      const song = {
        id: contentId,
        duration: durationRaw ? parseDuration(durationRaw) : metaTags.find((m) => m.getAttribute("name") === "apple:description")?.textContent.split("Duration: ")?.[1].split('"')?.[0] || "0:00",
        title,
        url: link,
        thumbnail: metaTags.find((r) => ["og:image:secure_url", "og:image"].includes(r.getAttribute("property")))?.getAttribute("content") || "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: res.querySelector(".song-subtitles__artists>a")?.textContent?.trim() || "Apple Music"
        }
      };
      return song;
    } catch {
      return null;
    }
  }
  static async getSongInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicSongRegex.test(link)) {
      return null;
    }
    const url = new URL(link);
    const id = url.searchParams.get("i");
    const name = url.pathname.split("album/")[1]?.split("/")[0];
    if (!id || !name)
      return null;
    const res = await getHTML(`https://music.apple.com/us/song/${name}/${id}`);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("</script>")?.[0];
      if (!datasrc)
        throw "not found";
      const data = JSON.parse(datasrc)[0].data.seoData;
      const song = data.ogSongs[0]?.attributes;
      return {
        id: data.ogSongs[0]?.id || data.appleContentId || id,
        duration: song?.durationInMillis || "0:00",
        title: song?.name || data.appleTitle,
        url: song?.url || data.url || link,
        thumbnail: song?.artwork ? makeImage({
          url: song.artwork.url,
          height: song.artwork.height,
          width: song.artwork.width
        }) : data.artworkUrl ? makeImage({
          height: data.height,
          width: data.width,
          url: data.artworkUrl,
          ext: data.fileType || "jpg"
        }) : "https://music.apple.com/assets/favicon/favicon-180.png",
        artist: {
          name: song?.artistName || data.socialTitle || "Apple Music"
        }
      };
    } catch {
      return this.getSongInfoFallback(res, name, id, link);
    }
  }
  static async getPlaylistInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicPlaylistRegex.test(link)) {
      return null;
    }
    const res = await getHTML(link);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("</script>")?.[0];
      if (!datasrc)
        throw "not found";
      const pl = JSON.parse(datasrc)[0].data.seoData;
      const thumbnail = pl.artworkUrl ? makeImage({
        height: pl.height,
        width: pl.width,
        url: pl.artworkUrl,
        ext: pl.fileType || "jpg"
      }) : "https://music.apple.com/assets/favicon/favicon-180.png";
      return {
        id: pl.appleContentId,
        title: pl.appleTitle,
        thumbnail,
        artist: {
          name: pl.ogSongs?.[0]?.attributes?.artistName || "Apple Music"
        },
        url: pl.url,
        tracks: (
          // eslint-disable-next-line
          pl.ogSongs?.map((m) => {
            const song = m.attributes;
            return {
              id: m.id,
              duration: song.durationInMillis || "0:00",
              title: song.name,
              url: song.url,
              thumbnail: song.artwork ? makeImage({
                url: song.artwork.url,
                height: song.artwork.height,
                width: song.artwork.width
              }) : thumbnail,
              artist: {
                name: song.artistName || "Apple Music"
              }
            };
          }) || []
        )
      };
    } catch {
      return null;
    }
  }
  static async getAlbumInfo(link) {
    if (!import_discord_player6.QueryResolver.regex.appleMusicAlbumRegex.test(link)) {
      return null;
    }
    const res = await getHTML(link);
    if (!res)
      return null;
    try {
      const datasrc = res.getElementById("serialized-server-data")?.innerText || res.innerText.split('<script type="application/json" id="serialized-server-data">')?.[1]?.split("</script>")?.[0];
      if (!datasrc)
        throw "not found";
      const pl = JSON.parse(datasrc)[0].data.seoData;
      const thumbnail = pl.artworkUrl ? makeImage({
        height: pl.height,
        width: pl.width,
        url: pl.artworkUrl,
        ext: pl.fileType || "jpg"
      }) : "https://music.apple.com/assets/favicon/favicon-180.png";
      return {
        id: pl.appleContentId,
        title: pl.appleTitle,
        thumbnail,
        artist: {
          name: pl.ogSongs?.[0]?.attributes?.artistName || "Apple Music"
        },
        url: pl.url,
        tracks: (
          // eslint-disable-next-line
          pl.ogSongs?.map((m) => {
            const song = m.attributes;
            return {
              id: m.id,
              duration: song.durationInMillis || "0:00",
              title: song.name,
              url: song.url,
              thumbnail: song.artwork ? makeImage({
                url: song.artwork.url,
                height: song.artwork.height,
                width: song.artwork.width
              }) : thumbnail,
              artist: {
                name: song.artistName || "Apple Music"
              }
            };
          }) || []
        )
      };
    } catch {
      return null;
    }
  }
};
__name(_AppleMusic, "AppleMusic");
var AppleMusic = _AppleMusic;

// src/internal/Spotify.ts
var SP_ANON_TOKEN_URL = "https://open.spotify.com/get_access_token?reason=transport&productType=embed";
var SP_ACCESS_TOKEN_URL = "https://accounts.spotify.com/api/token?grant_type=client_credentials";
var SP_BASE = "https://api.spotify.com/v1";
var _SpotifyAPI = class _SpotifyAPI {
  constructor(credentials = {
    clientId: null,
    clientSecret: null
  }) {
    this.credentials = credentials;
    this.accessToken = null;
  }
  get authorizationKey() {
    if (!this.credentials.clientId || !this.credentials.clientSecret)
      return null;
    return Buffer.from(`${this.credentials.clientId}:${this.credentials.clientSecret}`).toString("base64");
  }
  async requestToken() {
    const key = this.authorizationKey;
    if (!key)
      return await this.requestAnonymousToken();
    try {
      const res = await fetch(SP_ACCESS_TOKEN_URL, {
        method: "POST",
        headers: {
          "User-Agent": UA,
          Authorization: `Basic ${key}`,
          "Content-Type": "application/json"
        }
      });
      const body = await res.json();
      if (!body.access_token)
        throw "no token";
      const data = {
        token: body.access_token,
        expiresAfter: body.expires_in,
        type: "Bearer"
      };
      return this.accessToken = data;
    } catch {
      return await this.requestAnonymousToken();
    }
  }
  async requestAnonymousToken() {
    try {
      const res = await fetch(SP_ANON_TOKEN_URL, {
        headers: {
          "User-Agent": UA,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        throw "not_ok";
      const body = await res.json();
      if (!body.accessToken)
        throw "no_access_token";
      const data = {
        token: body.accessToken,
        expiresAfter: body.accessTokenExpirationTimestampMs,
        type: "Bearer"
      };
      return this.accessToken = data;
    } catch {
      return null;
    }
  }
  isTokenExpired() {
    if (!this.accessToken)
      return true;
    return Date.now() > this.accessToken.expiresAfter;
  }
  async search(query) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await fetch(`${SP_BASE}/search/?q=${encodeURIComponent(query)}&type=track&market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      return data.tracks.items.map((m) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: m.album.images?.[0]?.url || null
      }));
    } catch {
      return null;
    }
  }
  async getPlaylist(id) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await fetch(`${SP_BASE}/playlists/${id}?market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      if (!data.tracks.items.length)
        return null;
      const t = data.tracks.items;
      let next = data.tracks.next;
      while (typeof next === "string") {
        try {
          const res2 = await fetch(next, {
            headers: {
              "User-Agent": UA,
              Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
              "Content-Type": "application/json"
            }
          });
          if (!res2.ok)
            break;
          const nextPage = await res2.json();
          t.push(...nextPage.items);
          next = nextPage.next;
          if (!next)
            break;
        } catch {
          break;
        }
      }
      const tracks = t.map(({ track: m }) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: m.album.images?.[0]?.url || null
      }));
      if (!tracks.length)
        return null;
      return {
        name: data.name,
        author: data.owner.display_name,
        thumbnail: data.images?.[0]?.url || null,
        id: data.id,
        url: data.external_urls.spotify || `https://open.spotify.com/playlist/${id}`,
        tracks
      };
    } catch {
      return null;
    }
  }
  async getAlbum(id) {
    try {
      if (this.isTokenExpired())
        await this.requestToken();
      if (!this.accessToken)
        return null;
      const res = await fetch(`${SP_BASE}/albums/${id}?market=US`, {
        headers: {
          "User-Agent": UA,
          Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
          "Content-Type": "application/json"
        }
      });
      if (!res.ok)
        return null;
      const data = await res.json();
      if (!data.tracks.items.length)
        return null;
      const t = data.tracks.items;
      let next = data.tracks.next;
      while (typeof next === "string") {
        try {
          const res2 = await fetch(next, {
            headers: {
              "User-Agent": UA,
              Authorization: `${this.accessToken.type} ${this.accessToken.token}`,
              "Content-Type": "application/json"
            }
          });
          if (!res2.ok)
            break;
          const nextPage = await res2.json();
          t.push(...nextPage.items);
          next = nextPage.next;
          if (!next)
            break;
        } catch {
          break;
        }
      }
      const tracks = t.map((m) => ({
        title: m.name,
        duration: m.duration_ms,
        artist: m.artists.map((m2) => m2.name).join(", "),
        url: m.external_urls?.spotify || `https://open.spotify.com/track/${m.id}`,
        thumbnail: data.images?.[0]?.url || null
      }));
      if (!tracks.length)
        return null;
      return {
        name: data.name,
        author: data.artists.map((m) => m.name).join(", "),
        thumbnail: data.images?.[0]?.url || null,
        id: data.id,
        url: data.external_urls.spotify || `https://open.spotify.com/album/${id}`,
        tracks
      };
    } catch {
      return null;
    }
  }
};
__name(_SpotifyAPI, "SpotifyAPI");
var SpotifyAPI = _SpotifyAPI;

// src/extractors/BridgedExtractor.ts
var import_discord_player7 = require("discord-player");

// src/extractors/common/BridgeProvider.ts
var BridgeSource = /* @__PURE__ */ ((BridgeSource3) => {
  BridgeSource3["Auto"] = "auto";
  BridgeSource3["SoundCloud"] = "soundcloud";
  BridgeSource3["YouTube"] = "youtube";
  return BridgeSource3;
})(BridgeSource || {});
var _BridgeProvider = class _BridgeProvider {
  constructor(source) {
    this.bridgeSource = "soundcloud" /* SoundCloud */;
    this.setBridgeSource(source);
  }
  setBridgeSource(source) {
    switch (source) {
      case "soundcloud":
      case "soundcloud" /* SoundCloud */:
        this.bridgeSource = "soundcloud" /* SoundCloud */;
        break;
      case "youtube":
      case "youtube" /* YouTube */:
        this.bridgeSource = "youtube" /* YouTube */;
        break;
      case "auto":
      case "auto" /* Auto */:
        this.bridgeSource = "auto" /* Auto */;
        break;
      default:
        throw new TypeError("invalid bridge source");
    }
  }
  isSoundCloud() {
    return this.bridgeSource === "soundcloud" /* SoundCloud */;
  }
  isYouTube() {
    return this.bridgeSource === "youtube" /* YouTube */;
  }
  isAuto() {
    return this.bridgeSource === "auto" /* Auto */;
  }
  resolveProvider() {
    if (this.isAuto()) {
      if (YoutubeExtractor.instance && !isExtDisabled(YoutubeExtractor.instance)) {
        return "youtube" /* YouTube */;
      }
      if (SoundCloudExtractor.instance && !isExtDisabled(SoundCloudExtractor.instance)) {
        return "soundcloud" /* SoundCloud */;
      }
      throw new Error("Could not find any available extractors for automatic bridging.");
    }
    return this.bridgeSource;
  }
  async resolve(ext, track) {
    const isSoundcloud = this.resolveProvider() === "soundcloud" /* SoundCloud */;
    const bridgefn = isSoundcloud ? pullSCMetadata : pullYTMetadata;
    const oldQc = ext.createBridgeQuery;
    if (isSoundcloud)
      ext.createBridgeQuery = (track2) => `${track2.author} ${track2.title}`;
    const res = await bridgefn(ext, track);
    ext.debug(`Extracted bridge metadata using ${isSoundcloud ? "soundcloud" : "youtube"} extractor: ${JSON.stringify(res)}`);
    ext.createBridgeQuery = oldQc;
    return { source: isSoundcloud ? "soundcloud" : "youtube", data: res };
  }
  async stream(meta) {
    if (!meta.data)
      throw new Error("Could not find bridge metadata info.");
    if (meta.source === "soundcloud") {
      if (!SoundCloudExtractor.instance) {
        throw new Error("Could not find soundcloud extractor, make sure SoundCloudExtractor is instantiated properly.");
      }
      if (isExtDisabled(SoundCloudExtractor.instance)) {
        throw new Error("Cannot stream, SoundCloudExtractor is disabled.");
      }
      return await SoundCloudExtractor.instance.internal.util.streamLink(meta.data, "progressive");
    } else if (meta.source === "youtube") {
      if (!YoutubeExtractor.instance) {
        throw new Error("Could not find youtube extractor, make sure YouTubeExtractor is instantiated properly.");
      }
      if (isExtDisabled(YoutubeExtractor.instance)) {
        throw new Error("Cannot stream, YouTubeExtractor is disabled.");
      }
      return YoutubeExtractor.instance._stream(meta.data.url, YoutubeExtractor.instance, YoutubeExtractor.instance.supportsDemux);
    } else {
      throw new TypeError("invalid bridge source");
    }
  }
};
__name(_BridgeProvider, "BridgeProvider");
var BridgeProvider = _BridgeProvider;
function isExtDisabled(ext) {
  const streamBlocked = !!ext.context.player.options.blockStreamFrom?.some((x) => x === ext.identifier);
  return streamBlocked;
}
__name(isExtDisabled, "isExtDisabled");
var defaultBridgeProvider = new BridgeProvider("auto" /* Auto */);
var createBridgeProvider = /* @__PURE__ */ __name((source) => new BridgeProvider(source), "createBridgeProvider");

// src/extractors/BridgedExtractor.ts
var _BridgedExtractor = class _BridgedExtractor extends import_discord_player7.BaseExtractor {
  constructor(context, options) {
    super(context, options);
  }
  setBridgeProvider(provider) {
    this.options.bridgeProvider = provider;
  }
  setBridgeProviderSource(source) {
    this.bridgeProvider.setBridgeSource(source);
  }
  get bridgeProvider() {
    return this.options.bridgeProvider ?? defaultBridgeProvider;
  }
};
__name(_BridgedExtractor, "BridgedExtractor");
var BridgedExtractor = _BridgedExtractor;

// src/extractors/AppleMusicExtractor.ts
var _AppleMusicExtractor = class _AppleMusicExtractor extends BridgedExtractor {
  async activate() {
    this.protocols = ["amsearch", "applemusic"];
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._stream = (q) => {
        return fn(this, q);
      };
    }
  }
  async deactivate() {
    this.protocols = [];
  }
  async validate(query, type) {
    return [
      import_discord_player8.QueryType.APPLE_MUSIC_ALBUM,
      import_discord_player8.QueryType.APPLE_MUSIC_PLAYLIST,
      import_discord_player8.QueryType.APPLE_MUSIC_SONG,
      import_discord_player8.QueryType.APPLE_MUSIC_SEARCH,
      import_discord_player8.QueryType.AUTO,
      import_discord_player8.QueryType.AUTO_SEARCH
    ].some((t) => t === type);
  }
  async getRelatedTracks(track, history) {
    if (track.queryType === import_discord_player8.QueryType.APPLE_MUSIC_SONG) {
      const data = await this.handle(track.author || track.title, {
        type: import_discord_player8.QueryType.APPLE_MUSIC_SEARCH,
        requestedBy: track.requestedBy
      });
      const unique = data.tracks.filter((t) => !history.tracks.some((h) => h.url === t.url));
      return unique.length > 0 ? this.createResponse(null, unique) : this.createResponse();
    }
    return this.createResponse();
  }
  async handle(query, context) {
    if (context.protocol === "amsearch")
      context.type = import_discord_player8.QueryType.APPLE_MUSIC_SEARCH;
    switch (context.type) {
      case import_discord_player8.QueryType.AUTO:
      case import_discord_player8.QueryType.AUTO_SEARCH:
      case import_discord_player8.QueryType.APPLE_MUSIC_SEARCH: {
        const data = await AppleMusic.search(query);
        if (!data || !data.length)
          return this.createResponse();
        const tracks = data.map(
          // eslint-disable-next-line @typescript-eslint/no-explicit-any
          (m) => {
            const track = new import_discord_player8.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong",
              metadata: {
                source: m,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: m,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, track)).data : await pullYTMetadata(this, track)
                };
              }
            });
            track.extractor = this;
            return track;
          }
        );
        return this.createResponse(null, tracks);
      }
      case import_discord_player8.QueryType.APPLE_MUSIC_ALBUM: {
        const info = await AppleMusic.getAlbumInfo(query);
        if (!info)
          return this.createResponse();
        const playlist = new import_discord_player8.Playlist(this.context.player, {
          author: {
            name: info.artist.name,
            url: ""
          },
          description: info.title,
          id: info.id,
          source: "apple_music",
          thumbnail: info.thumbnail,
          title: info.title,
          tracks: [],
          type: "album",
          url: info.url,
          rawPlaylist: info
        });
        playlist.tracks = info.tracks.map(
          (m) => {
            const track = new import_discord_player8.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong",
              metadata: {
                source: info,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: info,
                  bridge: (await this.options.bridgeProvider?.resolve(this, track))?.data
                };
              }
            });
            track.playlist = playlist;
            track.extractor = this;
            return track;
          }
        );
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player8.QueryType.APPLE_MUSIC_PLAYLIST: {
        const info = await AppleMusic.getPlaylistInfo(query);
        if (!info)
          return this.createResponse();
        const playlist = new import_discord_player8.Playlist(this.context.player, {
          author: {
            name: info.artist.name,
            url: ""
          },
          description: info.title,
          id: info.id,
          source: "apple_music",
          thumbnail: info.thumbnail,
          title: info.title,
          tracks: [],
          type: "playlist",
          url: info.url,
          rawPlaylist: info
        });
        playlist.tracks = info.tracks.map(
          (m) => {
            const track = new import_discord_player8.Track(this.context.player, {
              author: m.artist.name,
              description: m.title,
              duration: typeof m.duration === "number" ? import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(m.duration)) : m.duration,
              thumbnail: m.thumbnail,
              title: m.title,
              url: m.url,
              views: 0,
              source: "apple_music",
              requestedBy: context.requestedBy,
              queryType: "appleMusicSong",
              metadata: {
                source: m,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: m,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, track)).data : await pullYTMetadata(this, track)
                };
              }
            });
            track.playlist = playlist;
            track.extractor = this;
            return track;
          }
        );
        return { playlist, tracks: playlist.tracks };
      }
      case import_discord_player8.QueryType.APPLE_MUSIC_SONG: {
        const info = await AppleMusic.getSongInfo(query);
        if (!info)
          return this.createResponse();
        const track = new import_discord_player8.Track(this.context.player, {
          author: info.artist.name,
          description: info.title,
          duration: typeof info.duration === "number" ? import_discord_player8.Util.buildTimeCode(import_discord_player8.Util.parseMS(info.duration)) : info.duration,
          thumbnail: info.thumbnail,
          title: info.title,
          url: info.url,
          views: 0,
          source: "apple_music",
          requestedBy: context.requestedBy,
          queryType: context.type,
          metadata: {
            source: info,
            bridge: null
          },
          requestMetadata: async () => {
            return {
              source: info,
              bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, track)).data : await pullYTMetadata(this, track)
            };
          }
        });
        track.extractor = this;
        return { playlist: null, tracks: [track] };
      }
      default:
        return { playlist: null, tracks: [] };
    }
  }
  async stream(info) {
    if (this._stream) {
      const stream = await this._stream(info.url, this);
      if (typeof stream === "string")
        return stream;
      return stream;
    }
    if (!("requestBridge" in this.context)) {
      const provider = this.bridgeProvider;
      if (!provider)
        throw new Error(`Could not find bridge provider for '${this.constructor.name}'`);
      const data = await provider.resolve(this, info);
      if (!data)
        throw new Error("Failed to bridge this track");
      info.setMetadata({
        ...info.metadata || {},
        bridge: data.data
      });
      return await provider.stream(data);
    }
    const result = await this.context.requestBridge(info, this);
    if (!result?.result)
      throw new Error("Could not bridge this track");
    return result.result;
  }
};
__name(_AppleMusicExtractor, "AppleMusicExtractor");
_AppleMusicExtractor.identifier = "com.discord-player.applemusicextractor";
var AppleMusicExtractor = _AppleMusicExtractor;

// src/extractors/SpotifyExtractor.ts
var import_discord_player9 = require("discord-player");
var import_spotify_url_info = __toESM(require("spotify-url-info"));
var re = /^(?:https:\/\/open\.spotify\.com\/(intl-([a-z]|[A-Z]){0,3}\/)?(?:user\/[A-Za-z0-9]+\/)?|spotify:)(album|playlist|track)(?:[/:])([A-Za-z0-9]+).*$/;
var _SpotifyExtractor = class _SpotifyExtractor extends BridgedExtractor {
  constructor() {
    super(...arguments);
    this._credentials = {
      clientId: this.options.clientId || process.env.DP_SPOTIFY_CLIENT_ID || null,
      clientSecret: this.options.clientSecret || process.env.DP_SPOTIFY_CLIENT_SECRET || null
    };
    this.internal = new SpotifyAPI(this._credentials);
  }
  async activate() {
    this.protocols = ["spsearch", "spotify"];
    this._lib = (0, import_spotify_url_info.default)(fetch);
    if (this.internal.isTokenExpired())
      await this.internal.requestToken();
    const fn = this.options.createStream;
    if (typeof fn === "function") {
      this._stream = (q) => {
        return fn(this, q);
      };
    }
  }
  async deactivate() {
    this._stream = void 0;
    this._lib = void 0;
    this.protocols = [];
  }
  async validate(query, type) {
    return [
      import_discord_player9.QueryType.SPOTIFY_ALBUM,
      import_discord_player9.QueryType.SPOTIFY_PLAYLIST,
      import_discord_player9.QueryType.SPOTIFY_SONG,
      import_discord_player9.QueryType.SPOTIFY_SEARCH,
      import_discord_player9.QueryType.AUTO,
      import_discord_player9.QueryType.AUTO_SEARCH
    ].some((t) => t === type);
  }
  async getRelatedTracks(track) {
    return await this.handle(track.author || track.title, {
      type: import_discord_player9.QueryType.SPOTIFY_SEARCH,
      requestedBy: track.requestedBy
    });
  }
  async handle(query, context) {
    if (context.protocol === "spsearch")
      context.type = import_discord_player9.QueryType.SPOTIFY_SEARCH;
    switch (context.type) {
      case import_discord_player9.QueryType.AUTO:
      case import_discord_player9.QueryType.AUTO_SEARCH:
      case import_discord_player9.QueryType.SPOTIFY_SEARCH: {
        const data = await this.internal.search(query);
        if (!data)
          return this.createResponse();
        return this.createResponse(
          null,
          data.map((spotifyData) => {
            const track = new import_discord_player9.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player9.QueryType.SPOTIFY_SONG,
              metadata: {
                source: spotifyData,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: spotifyData,
                  bridge: (await this.options.bridgeProvider?.resolve(this, track))?.data
                };
              }
            });
            track.extractor = this;
            return track;
          })
        );
      }
      case import_discord_player9.QueryType.SPOTIFY_SONG: {
        const spotifyData = await this._lib.getData(query, context.requestOptions).catch(import_discord_player9.Util.noop);
        if (!spotifyData)
          return { playlist: null, tracks: [] };
        const spotifyTrack = new import_discord_player9.Track(this.context.player, {
          title: spotifyData.title,
          description: `${spotifyData.name} by ${spotifyData.artists.map((m) => m.name).join(", ")}`,
          author: spotifyData.artists[0]?.name ?? "Unknown Artist",
          url: spotifyData.id ? `https://open.spotify.com/track/${spotifyData.id}` : query,
          thumbnail: spotifyData.coverArt?.sources?.[0]?.url || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
          duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(spotifyData.duration ?? spotifyData.maxDuration ?? 0)),
          views: 0,
          requestedBy: context.requestedBy,
          source: "spotify",
          queryType: context.type,
          metadata: {
            source: spotifyData,
            bridge: null
          },
          requestMetadata: async () => {
            return {
              source: spotifyData,
              bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, spotifyTrack)).data : await pullYTMetadata(this, spotifyTrack)
            };
          }
        });
        spotifyTrack.extractor = this;
        return { playlist: null, tracks: [spotifyTrack] };
      }
      case import_discord_player9.QueryType.SPOTIFY_PLAYLIST: {
        try {
          const { queryType, id } = this.parse(query);
          if (queryType !== "playlist")
            throw "err";
          const spotifyPlaylist = await this.internal.getPlaylist(id);
          if (!spotifyPlaylist)
            throw "err";
          const playlist = new import_discord_player9.Playlist(this.context.player, {
            title: spotifyPlaylist.name,
            description: spotifyPlaylist.name ?? "",
            thumbnail: spotifyPlaylist.thumbnail ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: "playlist",
            source: "spotify",
            author: {
              name: spotifyPlaylist.author ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyPlaylist.id,
            url: spotifyPlaylist.url || query,
            rawPlaylist: spotifyPlaylist
          });
          playlist.tracks = spotifyPlaylist.tracks.map((spotifyData) => {
            const data = new import_discord_player9.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player9.QueryType.SPOTIFY_SONG,
              metadata: {
                source: spotifyData,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: spotifyData,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, data)).data : await pullYTMetadata(this, data)
                };
              }
            });
            data.extractor = this;
            data.playlist = playlist;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        } catch {
          const spotifyPlaylist = await this._lib.getData(query, context.requestOptions).catch(import_discord_player9.Util.noop);
          if (!spotifyPlaylist)
            return { playlist: null, tracks: [] };
          const playlist = new import_discord_player9.Playlist(this.context.player, {
            title: spotifyPlaylist.name ?? spotifyPlaylist.title,
            description: spotifyPlaylist.title ?? "",
            thumbnail: spotifyPlaylist.coverArt?.sources?.[0]?.url ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: spotifyPlaylist.type,
            source: "spotify",
            author: {
              name: spotifyPlaylist.subtitle ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyPlaylist.id,
            url: spotifyPlaylist.id ? `https://open.spotify.com/playlist/${spotifyPlaylist.id}` : query,
            rawPlaylist: spotifyPlaylist
          });
          playlist.tracks = spotifyPlaylist.trackList.map((m) => {
            const data = new import_discord_player9.Track(this.context.player, {
              title: m.title ?? "",
              description: m.title ?? "",
              author: m.subtitle ?? "Unknown Artist",
              url: m.uid ? `https://open.spotify.com/tracks/${m.uid}` : query,
              thumbnail: "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(m.duration)),
              views: 0,
              requestedBy: context.requestedBy,
              playlist,
              source: "spotify",
              queryType: "spotifySong",
              metadata: {
                source: m,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: m,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, data)).data : await pullYTMetadata(this, data)
                };
              }
            });
            data.extractor = this;
            data.playlist = playlist;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        }
      }
      case import_discord_player9.QueryType.SPOTIFY_ALBUM: {
        try {
          const { queryType, id } = this.parse(query);
          if (queryType !== "album")
            throw "err";
          const spotifyAlbum = await this.internal.getAlbum(id);
          if (!spotifyAlbum)
            throw "err";
          const playlist = new import_discord_player9.Playlist(this.context.player, {
            title: spotifyAlbum.name,
            description: spotifyAlbum.name ?? "",
            thumbnail: spotifyAlbum.thumbnail ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: "album",
            source: "spotify",
            author: {
              name: spotifyAlbum.author ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: spotifyAlbum.id,
            url: spotifyAlbum.url || query,
            rawPlaylist: spotifyAlbum
          });
          playlist.tracks = spotifyAlbum.tracks.map((spotifyData) => {
            const data = new import_discord_player9.Track(this.context.player, {
              title: spotifyData.title,
              description: `${spotifyData.title} by ${spotifyData.artist}`,
              author: spotifyData.artist ?? "Unknown Artist",
              url: spotifyData.url,
              thumbnail: spotifyData.thumbnail || "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(spotifyData.duration ?? 0)),
              views: 0,
              requestedBy: context.requestedBy,
              source: "spotify",
              queryType: import_discord_player9.QueryType.SPOTIFY_SONG,
              metadata: {
                source: spotifyData,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: spotifyData,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, data)).data : await pullYTMetadata(this, data)
                };
              }
            });
            data.extractor = this;
            data.playlist = playlist;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        } catch {
          const album = await this._lib.getData(query, context.requestOptions).catch(import_discord_player9.Util.noop);
          if (!album)
            return { playlist: null, tracks: [] };
          const playlist = new import_discord_player9.Playlist(this.context.player, {
            title: album.name ?? album.title,
            description: album.title ?? "",
            thumbnail: album.coverArt?.sources?.[0]?.url ?? "https://www.scdn.co/i/_global/twitter_card-default.jpg",
            type: album.type,
            source: "spotify",
            author: {
              name: album.subtitle ?? "Unknown Artist",
              url: null
            },
            tracks: [],
            id: album.id,
            url: album.id ? `https://open.spotify.com/playlist/${album.id}` : query,
            rawPlaylist: album
          });
          playlist.tracks = album.trackList.map((m) => {
            const data = new import_discord_player9.Track(this.context.player, {
              title: m.title ?? "",
              description: m.title ?? "",
              author: m.subtitle ?? "Unknown Artist",
              url: m.uid ? `https://open.spotify.com/tracks/${m.uid}` : query,
              thumbnail: "https://www.scdn.co/i/_global/twitter_card-default.jpg",
              duration: import_discord_player9.Util.buildTimeCode(import_discord_player9.Util.parseMS(m.duration)),
              views: 0,
              requestedBy: context.requestedBy,
              playlist,
              source: "spotify",
              queryType: "spotifySong",
              metadata: {
                source: m,
                bridge: null
              },
              requestMetadata: async () => {
                return {
                  source: m,
                  bridge: this.options.bridgeProvider ? (await this.options.bridgeProvider.resolve(this, data)).data : await pullYTMetadata(this, data)
                };
              }
            });
            data.extractor = this;
            data.playlist = playlist;
            return data;
          });
          return { playlist, tracks: playlist.tracks };
        }
      }
      default:
        return { playlist: null, tracks: [] };
    }
  }
  async stream(info) {
    if (this._stream) {
      const stream = await this._stream(info.url, this);
      if (typeof stream === "string")
        return stream;
      return stream;
    }
    if (!("requestBridge" in this.context)) {
      const provider = this.bridgeProvider;
      if (!provider)
        throw new Error(`Could not find bridge provider for '${this.constructor.name}'`);
      const data = await provider.resolve(this, info);
      if (!data)
        throw new Error("Failed to bridge this track");
      info.setMetadata({
        ...info.metadata || {},
        bridge: data.data
      });
      return await provider.stream(data);
    }
    const result = await this.context.requestBridge(info, this);
    if (!result?.result)
      throw new Error("Could not bridge this track");
    return result.result;
  }
  parse(q) {
    const [, , , queryType, id] = re.exec(q) || [];
    return { queryType, id };
  }
};
__name(_SpotifyExtractor, "SpotifyExtractor");
_SpotifyExtractor.identifier = "com.discord-player.spotifyextractor";
var SpotifyExtractor = _SpotifyExtractor;

// src/index.ts
var version = "4.5.1";
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  AppleMusicExtractor,
  AttachmentExtractor,
  BridgeProvider,
  BridgeSource,
  BridgedExtractor,
  Internal,
  ReverbnationExtractor,
  SoundCloudExtractor,
  SpotifyExtractor,
  UA,
  VimeoExtractor,
  YouTubeExtractor,
  YouTubeLibs,
  YoutubeExtractor,
  createBridgeProvider,
  createImport,
  defaultBridgeProvider,
  fetch,
  filterSoundCloudPreviews,
  loadYtdl,
  lyricsExtractor,
  makeSCSearch,
  makeYTSearch,
  pullSCMetadata,
  pullYTMetadata,
  version
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL2luZGV4LnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL1NvdW5kQ2xvdWRFeHRyYWN0b3IudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvY29tbW9uL2hlbHBlci50cyIsICIuLi9zcmMvZXh0cmFjdG9ycy9Zb3V0dWJlRXh0cmFjdG9yLnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL0x5cmljc0V4dHJhY3Rvci50cyIsICIuLi9zcmMvZXh0cmFjdG9ycy9WaW1lb0V4dHJhY3Rvci50cyIsICIuLi9zcmMvaW50ZXJuYWwvVmltZW8udHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvUmV2ZXJibmF0aW9uRXh0cmFjdG9yLnRzIiwgIi4uL3NyYy9leHRyYWN0b3JzL0F0dGFjaG1lbnRFeHRyYWN0b3IudHMiLCAiLi4vc3JjL2ludGVybmFsL2Rvd25sb2FkZXIudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvQXBwbGVNdXNpY0V4dHJhY3Rvci50cyIsICIuLi9zcmMvaW50ZXJuYWwvaW5kZXgudHMiLCAiLi4vc3JjL2ludGVybmFsL0FwcGxlTXVzaWMudHMiLCAiLi4vc3JjL2ludGVybmFsL1Nwb3RpZnkudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvQnJpZGdlZEV4dHJhY3Rvci50cyIsICIuLi9zcmMvZXh0cmFjdG9ycy9jb21tb24vQnJpZGdlUHJvdmlkZXIudHMiLCAiLi4vc3JjL2V4dHJhY3RvcnMvU3BvdGlmeUV4dHJhY3Rvci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0ICogZnJvbSAnLi9leHRyYWN0b3JzJztcbmV4cG9ydCAqIGFzIEludGVybmFsIGZyb20gJy4vaW50ZXJuYWwnO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWluZmVycmFibGUtdHlwZXNcbmV4cG9ydCBjb25zdCB2ZXJzaW9uOiBzdHJpbmcgPSAnNC41LjEnO1xuIiwgIi8vIHByZXR0aWVyLWlnbm9yZVxuaW1wb3J0IHtcbiAgICBCYXNlRXh0cmFjdG9yLFxuICAgIEV4dHJhY3RvckluZm8sXG4gICAgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCxcbiAgICBFeHRyYWN0b3JTdHJlYW1hYmxlLFxuICAgIHR5cGUgR3VpbGRRdWV1ZUhpc3RvcnksXG4gICAgUGxheWxpc3QsXG4gICAgUXVlcnlUeXBlLFxuICAgIFNlYXJjaFF1ZXJ5VHlwZSxcbiAgICBUcmFjayxcbiAgICBVdGlsXG59IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCAqIGFzIFNvdW5kQ2xvdWQgZnJvbSAnc291bmRjbG91ZC50cyc7XG5pbXBvcnQgeyBmaWx0ZXJTb3VuZENsb3VkUHJldmlld3MgfSBmcm9tICcuL2NvbW1vbi9oZWxwZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNvdW5kQ2xvdWRFeHRyYWN0b3JJbml0IHtcbiAgICBjbGllbnRJZD86IHN0cmluZztcbiAgICBvYXV0aFRva2VuPzogc3RyaW5nO1xuICAgIHByb3h5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgU291bmRDbG91ZEV4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3I8U291bmRDbG91ZEV4dHJhY3RvckluaXQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnNvdW5kY2xvdWRleHRyYWN0b3InIGFzIGNvbnN0O1xuICAgIHB1YmxpYyBzdGF0aWMgaW5zdGFuY2U6IFNvdW5kQ2xvdWRFeHRyYWN0b3IgfCBudWxsID0gbnVsbDtcblxuICAgIHB1YmxpYyBpbnRlcm5hbCA9IG5ldyBTb3VuZENsb3VkLmRlZmF1bHQoe1xuICAgICAgICBjbGllbnRJZDogdGhpcy5vcHRpb25zLmNsaWVudElkLFxuICAgICAgICBvYXV0aFRva2VuOiB0aGlzLm9wdGlvbnMub2F1dGhUb2tlbixcbiAgICAgICAgcHJveHk6IHRoaXMub3B0aW9ucy5wcm94eVxuICAgIH0pO1xuXG4gICAgcHVibGljIGFzeW5jIGFjdGl2YXRlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnByb3RvY29scyA9IFsnc2NzZWFyY2gnLCAnc291bmRjbG91ZCddO1xuICAgICAgICBTb3VuZENsb3VkRXh0cmFjdG9yLmluc3RhbmNlID0gdGhpcztcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZGVhY3RpdmF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5wcm90b2NvbHMgPSBbXTtcbiAgICAgICAgU291bmRDbG91ZEV4dHJhY3Rvci5pbnN0YW5jZSA9IG51bGw7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGlmICh0eXBlb2YgcXVlcnkgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICByZXR1cm4gKFtcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TT1VORENMT1VELFxuICAgICAgICAgICAgUXVlcnlUeXBlLlNPVU5EQ0xPVURfUExBWUxJU1QsXG4gICAgICAgICAgICBRdWVyeVR5cGUuU09VTkRDTE9VRF9TRUFSQ0gsXG4gICAgICAgICAgICBRdWVyeVR5cGUuU09VTkRDTE9VRF9UUkFDSyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPLFxuICAgICAgICAgICAgUXVlcnlUeXBlLkFVVE9fU0VBUkNIXG4gICAgICAgIF0gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaywgaGlzdG9yeTogR3VpbGRRdWV1ZUhpc3RvcnkpIHtcbiAgICAgICAgaWYgKHRyYWNrLnF1ZXJ5VHlwZSA9PT0gUXVlcnlUeXBlLlNPVU5EQ0xPVURfVFJBQ0spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmludGVybmFsLnRyYWNrcy5yZWxhdGVkVjIodHJhY2sudXJsLCA1KTtcblxuICAgICAgICAgICAgY29uc3QgdW5pcXVlID0gZmlsdGVyU291bmRDbG91ZFByZXZpZXdzKGRhdGEpLmZpbHRlcigodCkgPT4gIWhpc3RvcnkudHJhY2tzLnNvbWUoKGgpID0+IGgudXJsID09PSB0LnBlcm1hbGlua191cmwpKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAodW5pcXVlLmxlbmd0aCA+IDAgPyB1bmlxdWUgOiBkYXRhKS5tYXAoKHRyYWNrSW5mbykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdUcmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB0cmFja0luZm8ucGVybWFsaW5rX3VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRyYWNrSW5mby5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdHJhY2tJbmZvLmFydHdvcmtfdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IHRyYWNrSW5mby5wbGF5YmFja19jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLnVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzb3VuZGNsb3VkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZ2luZTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBRdWVyeVR5cGUuU09VTkRDTE9VRF9UUkFDSyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB0cmFja0luZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWV0YWRhdGE6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2tJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVGl0bGU6IHRyYWNrSW5mby50aXRsZVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBuZXdUcmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdUcmFjaztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIGlmIChjb250ZXh0LnByb3RvY29sID09PSAnc2NzZWFyY2gnKSBjb250ZXh0LnR5cGUgPSBRdWVyeVR5cGUuU09VTkRDTE9VRF9TRUFSQ0g7XG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5TT1VORENMT1VEX1RSQUNLOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tJbmZvID0gYXdhaXQgdGhpcy5pbnRlcm5hbC50cmFja3MuZ2V0VjIocXVlcnkpLmNhdGNoKFV0aWwubm9vcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRyYWNrSW5mbykgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby5wZXJtYWxpbmtfdXJsLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyh0cmFja0luZm8uZHVyYXRpb24pKSxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRyYWNrSW5mby5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB0cmFja0luZm8uYXJ0d29ya191cmwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB0cmFja0luZm8ucGxheWJhY2tfY291bnQsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLnVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzb3VuZGNsb3VkJyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiB0cmFja0luZm8sXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWV0YWRhdGE6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFja0luZm87XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNsZWFuVGl0bGU6IHRyYWNrSW5mby50aXRsZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLlNPVU5EQ0xPVURfUExBWUxJU1Q6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5pbnRlcm5hbC5wbGF5bGlzdHMuZ2V0VjIocXVlcnkpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGRhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uID8/ICcnLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGRhdGEuYXJ0d29ya191cmwgPz8gZGF0YS50cmFja3NbMF0uYXJ0d29ya191cmwsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwbGF5bGlzdCcsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3NvdW5kY2xvdWQnLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEudXNlci51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZGF0YS51c2VyLnBlcm1hbGlua191cmxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGAke2RhdGEuaWR9YCxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBkYXRhLnBlcm1hbGlua191cmwsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBkYXRhXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNvbmcgb2YgZGF0YS50cmFja3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNvbmcudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc29uZy5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc29uZy51c2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nLnBlcm1hbGlua191cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNvbmcuYXJ0d29ya191cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhzb25nLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3czogc29uZy5wbGF5YmFja19jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWxpc3Q6IHJlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3NvdW5kY2xvdWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5naW5lOiBzb25nLFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBjb250ZXh0LnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogc29uZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzb25nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVGl0bGU6IHNvbmcudGl0bGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLnBsYXlsaXN0ID0gcmVzO1xuICAgICAgICAgICAgICAgICAgICByZXMudHJhY2tzLnB1c2godHJhY2spO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiByZXMsIHRyYWNrczogcmVzLnRyYWNrcyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgIGxldCB0cmFja3MgPSBhd2FpdCB0aGlzLmludGVybmFsLnRyYWNrc1xuICAgICAgICAgICAgICAgICAgICAuc2VhcmNoVjIoeyBxOiBxdWVyeSB9KVxuICAgICAgICAgICAgICAgICAgICAudGhlbigodCkgPT4gdC5jb2xsZWN0aW9uKVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goVXRpbC5ub29wKTtcblxuICAgICAgICAgICAgICAgIGlmICghdHJhY2tzKSB0cmFja3MgPSBhd2FpdCB0aGlzLmludGVybmFsLnRyYWNrcy5zZWFyY2hBbHQocXVlcnkpLmNhdGNoKFV0aWwubm9vcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRyYWNrcyB8fCAhdHJhY2tzLmxlbmd0aCkgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgdHJhY2tzID0gZmlsdGVyU291bmRDbG91ZFByZXZpZXdzKHRyYWNrcyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZXNvbHZlZFRyYWNrczogVHJhY2tbXSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0cmFja0luZm8gb2YgdHJhY2tzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdHJhY2tJbmZvLnN0cmVhbWFibGUpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB0cmFja0luZm8ucGVybWFsaW5rX3VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRyYWNrSW5mby5kZXNjcmlwdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdHJhY2tJbmZvLmFydHdvcmtfdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IHRyYWNrSW5mby5wbGF5YmFja19jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLnVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3NvdW5kY2xvdWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5naW5lOiB0cmFja0luZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6ICdzb3VuZGNsb3VkVHJhY2snLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHRyYWNrSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFja0luZm87XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRUcmFja3MucHVzaCh0cmFjayk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogcmVzb2x2ZWRUcmFja3MgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBlbXB0eVJlc3BvbnNlKCk6IEV4dHJhY3RvckluZm8ge1xuICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spIHtcbiAgICAgICAgY29uc3QgdXJsID0gYXdhaXQgdGhpcy5pbnRlcm5hbC51dGlsLnN0cmVhbUxpbmsoaW5mby51cmwpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgIGlmICghdXJsKSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBleHRyYWN0IHN0cmVhbSBmcm9tIHRoaXMgdHJhY2sgc291cmNlJyk7XG5cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgYnJpZGdlKHRyYWNrOiBUcmFjaywgc291cmNlRXh0cmFjdG9yOiBCYXNlRXh0cmFjdG9yIHwgbnVsbCk6IFByb21pc2U8RXh0cmFjdG9yU3RyZWFtYWJsZSB8IG51bGw+IHtcbiAgICAgICAgaWYgKHNvdXJjZUV4dHJhY3Rvcj8uaWRlbnRpZmllciA9PT0gdGhpcy5pZGVudGlmaWVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHJlYW0odHJhY2spO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcXVlcnkgPSBzb3VyY2VFeHRyYWN0b3I/LmNyZWF0ZUJyaWRnZVF1ZXJ5KHRyYWNrKSA/PyBgJHt0cmFjay5hdXRob3J9IC0gJHt0cmFjay50aXRsZX1gO1xuXG4gICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCB0aGlzLmhhbmRsZShxdWVyeSwge1xuICAgICAgICAgICAgcmVxdWVzdGVkQnk6IHRyYWNrLnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgdHlwZTogUXVlcnlUeXBlLlNPVU5EQ0xPVURfU0VBUkNIXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaW5mby50cmFja3MubGVuZ3RoKSByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gdGhpcy5zdHJlYW0oaW5mby50cmFja3NbMF0pO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBCYXNlRXh0cmFjdG9yLCBUcmFjayB9IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB7IFlvdVR1YmUgfSBmcm9tICd5b3V0dWJlLXNyJztcbmltcG9ydCB7IFNvdW5kQ2xvdWRFeHRyYWN0b3IgfSBmcm9tICcuLi9Tb3VuZENsb3VkRXh0cmFjdG9yJztcbmltcG9ydCB1bmZldGNoIGZyb20gJ2lzb21vcnBoaWMtdW5mZXRjaCc7XG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCBodHRwcyBmcm9tICdodHRwcyc7XG5pbXBvcnQgdHlwZSAqIGFzIFNvdW5kQ2xvdWQgZnJvbSAnc291bmRjbG91ZC50cyc7XG5cbmxldCBmYWN0b3J5OiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHN0cmVhbTogU3RyZWFtRk47XG4gICAgbGliOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlSW1wb3J0ID0gKGxpYjogc3RyaW5nKSA9PiBpbXBvcnQobGliKS5jYXRjaCgoKSA9PiBudWxsKTtcbmV4cG9ydCBjb25zdCBVQSA9ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTA5LjAuMC4wIFNhZmFyaS81MzcuMzYgRWRnLzEwOS4wLjE1MTguNDknO1xuZXhwb3J0IGNvbnN0IGZldGNoID0gdW5mZXRjaDtcblxuZXhwb3J0IGNvbnN0IFlvdVR1YmVMaWJzID0gW1xuICAgICd5b3V0dWJlLWV4dCcsXG4gICAgJ3l0ZGwtY29yZScsXG4gICAgJ0BkaXN0dWJlL3l0ZGwtY29yZScsXG4gICAgJ3BsYXktZGwnLFxuICAgICd5dC1zdHJlYW0nXG4gICAgLy8gYWRkIG1vcmUgdG8gdGhlIGxpc3QgaWYgeW91IGhhdmUgYW55XG5dO1xuXG5jb25zdCBFUlJfTk9fWVRfTElCID0gbmV3IEVycm9yKGBDb3VsZCBub3QgbG9hZCB5b3V0dWJlIGxpYnJhcnkuIEluc3RhbGwgb25lIG9mICR7WW91VHViZUxpYnMubWFwKChsaWIpID0+IGBcIiR7bGlifVwiYCkuam9pbignLCAnKX1gKTtcblxuLy8gZm9yY2VkIGxpYlxuY29uc3QgZm9yY2VkTGliID0gcHJvY2Vzcy5lbnYuRFBfRk9SQ0VfWVRETF9NT0Q7XG5pZiAoZm9yY2VkTGliKSBZb3VUdWJlTGlicy51bnNoaWZ0KC4uLmZvcmNlZExpYi5zcGxpdCgnLCcpKTtcblxuZXhwb3J0IHR5cGUgU3RyZWFtRk4gPSAoXG4gICAgcTogc3RyaW5nLFxuICAgIGV4dDogQmFzZUV4dHJhY3RvcixcbiAgICBkZW11eGFibGU/OiBib29sZWFuXG4pID0+IFByb21pc2U8XG4gICAgfCBpbXBvcnQoJ3N0cmVhbScpLlJlYWRhYmxlXG4gICAgfCBzdHJpbmdcbiAgICB8IHtcbiAgICAgICAgICBzdHJlYW06IGltcG9ydCgnc3RyZWFtJykuUmVhZGFibGU7XG4gICAgICAgICAgJGZtdDogc3RyaW5nO1xuICAgICAgfVxuPjtcblxubGV0IGh0dHBBZ2VudDogaHR0cC5BZ2VudCwgaHR0cHNBZ2VudDogaHR0cHMuQWdlbnQ7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZFl0ZGwob3B0aW9ucz86IGFueSwgZm9yY2UgPSBmYWxzZSkge1xuICAgIGlmIChmYWN0b3J5ICYmICFmb3JjZSkgcmV0dXJuIGZhY3Rvcnk7XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGxldCBsaWI6IGFueSwgX3l0TGliTmFtZTogc3RyaW5nLCBfc3RyZWFtOiBTdHJlYW1GTjtcblxuICAgIGZvciAoY29uc3QgeXRsaWIgb2YgWW91VHViZUxpYnMpIHtcbiAgICAgICAgbGliID0gYXdhaXQgaW1wb3J0KHl0bGliKS50aGVuKFxuICAgICAgICAgICAgKG0pID0+IG0sXG4gICAgICAgICAgICAoKSA9PiBudWxsXG4gICAgICAgICk7XG4gICAgICAgIGlmICghbGliKSBjb250aW51ZTtcbiAgICAgICAgbGliID0gbGliLmRlZmF1bHQgfHwgbGliO1xuICAgICAgICBfeXRMaWJOYW1lID0geXRsaWI7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChsaWIpIHtcbiAgICAgICAgY29uc3QgaXNZdGRsID0gWyd5dGRsLWNvcmUnXS5zb21lKChsaWIpID0+IGxpYiA9PT0gX3l0TGliTmFtZSk7XG5cbiAgICAgICAgY29uc3QgaGxzUmVnZXggPSAvXFwvbWFuaWZlc3RcXC9obHNfKHZhcmlhbnR8cGxheWxpc3QpXFwvLztcbiAgICAgICAgX3N0cmVhbSA9IGFzeW5jIChxdWVyeSwgZXh0cmFjdG9yLCBkZW11eGFibGUgPSBmYWxzZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGxhbm5lciA9IGV4dHJhY3Rvci5jb250ZXh0LnBsYXllci5yb3V0ZVBsYW5uZXI7XG5cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICBjb25zdCBhcHBseVBsYW5uZXJDb25maWcgPSAob3B0OiBhbnksIGFwcGx5QWdlbnRzID0gZmFsc2UpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGxhbm5lcikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBpcCwgZmFtaWx5IH0gPSBwbGFubmVyLmdldElQKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXBwbHlBZ2VudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHQucmVxdWVzdE9wdGlvbnMubG9jYWxBZGRyZXNzID0gaXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0LnJlcXVlc3RPcHRpb25zLmZhbWlseSA9IGZhbWlseTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IG9wdD8ucmVxdWVzdE9wdGlvbnMgfHwge307XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmxvY2FsQWRkcmVzcyA9IGlwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZmFtaWx5ID0gZmFtaWx5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFodHRwQWdlbnQpIGh0dHBBZ2VudCA9IG5ldyBodHRwLkFnZW50KG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaHR0cHNBZ2VudCkgaHR0cHNBZ2VudCA9IG5ldyBodHRwcy5BZ2VudChvcHRpb25zKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKG9wdCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0T3B0aW9uczogb3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cEFnZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwc0FnZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBvcHQ7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoX3l0TGliTmFtZSA9PT0gJ3lvdXR1YmUtZXh0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRsID0gbGliIGFzIHR5cGVvZiBpbXBvcnQoJ3lvdXR1YmUtZXh0Jyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0ID0gYXBwbHlQbGFubmVyQ29uZmlnKFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE9wdGlvbnM6IG9wdGlvbnM/LnJlcXVlc3RPcHRpb25zIHx8IHt9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IGRsLnZpZGVvSW5mbyhxdWVyeSwgb3B0KTtcbiAgICAgICAgICAgICAgICBjb25zdCB2aWRlb0Zvcm1hdHMgPSBhd2FpdCBkbC5nZXRGb3JtYXRzKGluZm8uc3RyZWFtLCBvcHQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRlbXV4YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZW11eGFibGVGb3JtYXQgPVxuICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5kdXJhdGlvbi5sZW5ndGhTZWMgIT0gJzAnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB2aWRlb0Zvcm1hdHMuZmluZCgoZm10KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC9hdWRpb1xcL3dlYm07IGNvZGVjcz1cIm9wdXNcIi8udGVzdChmbXQubWltZVR5cGUgfHwgJycpICYmIGZtdC5hdWRpb1NhbXBsZVJhdGUgPT0gJzQ4MDAwJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChkZW11eGFibGVGb3JtYXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtOiBhd2FpdCBkbC5nZXRSZWFkYWJsZVN0cmVhbShkZW11eGFibGVGb3JtYXQsIG9wdCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZtdDogJ3dlYm0vb3B1cydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXRzID0gdmlkZW9Gb3JtYXRzXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3JtYXQudXJsKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5pc0xpdmUpIHJldHVybiBkbC51dGlscy5pc0hsc0NvbnRlbnRVUkwoZm9ybWF0LnVybCkgJiYgZm9ybWF0LnVybC5lbmRzV2l0aCgnLm0zdTgnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZm9ybWF0LmJpdHJhdGUgPT09ICdudW1iZXInO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gTnVtYmVyKGIuYml0cmF0ZSkgLSBOdW1iZXIoYS5iaXRyYXRlKSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmbXQgPSBmb3JtYXRzLmZpbmQoKGZvcm1hdCkgPT4gIWZvcm1hdC5xdWFsaXR5TGFiZWwpIHx8IGZvcm1hdHMuc29ydCgoYSwgYikgPT4gTnVtYmVyKGEuYml0cmF0ZSkgLSBOdW1iZXIoYi5iaXRyYXRlKSlbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgdXJsID0gZm10Py51cmw7XG4gICAgICAgICAgICAgICAgaWYgKCF1cmwpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIHN0cmVhbSB1cmwgZm9yICR7cXVlcnl9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNZdGRsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGwgPSBsaWIgYXMgdHlwZW9mIGltcG9ydCgneXRkbC1jb3JlJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IGRsLmdldEluZm8ocXVlcnksIGFwcGx5UGxhbm5lckNvbmZpZyhvcHRpb25zKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGVtdXhhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IChmb3JtYXQ6IGltcG9ydCgneXRkbC1jb3JlJykudmlkZW9Gb3JtYXQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXQuY29kZWNzID09PSAnb3B1cycgJiYgZm9ybWF0LmNvbnRhaW5lciA9PT0gJ3dlYm0nICYmIGZvcm1hdC5hdWRpb1NhbXBsZVJhdGUgPT0gJzQ4MDAwJztcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBpbmZvLmZvcm1hdHMuZmluZChmaWx0ZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXQgJiYgaW5mby52aWRlb0RldGFpbHMubGVuZ3RoU2Vjb25kcyAhPSAnMCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtOiBkbC5kb3dubG9hZEZyb21JbmZvKGluZm8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uYXBwbHlQbGFubmVyQ29uZmlnKG9wdGlvbnMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZm10OiAnd2VibS9vcHVzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHMgPSBpbmZvLmZvcm1hdHNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoZm9ybWF0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5mby52aWRlb0RldGFpbHMuaXNMaXZlQ29udGVudCA/IGZvcm1hdC5pc0hMUyAmJiBmb3JtYXQuaGFzQXVkaW8gOiBmb3JtYXQuaGFzQXVkaW87XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBOdW1iZXIoYi5hdWRpb0JpdHJhdGUpIC0gTnVtYmVyKGEuYXVkaW9CaXRyYXRlKSB8fCBOdW1iZXIoYS5iaXRyYXRlKSAtIE51bWJlcihiLmJpdHJhdGUpKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGZtdCA9IGZvcm1hdHMuZmluZCgoZm9ybWF0KSA9PiAhZm9ybWF0Lmhhc1ZpZGVvKSB8fCBmb3JtYXRzLnNvcnQoKGEsIGIpID0+IE51bWJlcihhLmJpdHJhdGUpIC0gTnVtYmVyKGIuYml0cmF0ZSkpWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IGZtdD8udXJsO1xuICAgICAgICAgICAgICAgIGlmICghdXJsKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBwYXJzZSBzdHJlYW0gdXJsIGZvciAke3F1ZXJ5fWApO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIGRsKHF1ZXJ5LCB0aGlzLmNvbnRleHQucGxheWVyLm9wdGlvbnMueXRkbE9wdGlvbnMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfeXRMaWJOYW1lID09PSAnQGRpc3R1YmUveXRkbC1jb3JlJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRsID0gbGliIGFzIHR5cGVvZiBpbXBvcnQoJ0BkaXN0dWJlL3l0ZGwtY29yZScpO1xuICAgICAgICAgICAgICAgIGxldCBvcHQ6IGFueTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhbm5lcikge1xuICAgICAgICAgICAgICAgICAgICBvcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhbEFkZHJlc3M6IHBsYW5uZXIuZ2V0SVAoKS5pcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZWxlY3RGYW1pbHk6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb29raWUgPSBvcHRpb25zPy5yZXF1ZXN0T3B0aW9ucz8uaGVhZGVycz8uY29va2llO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgYWdlbnQgPSBkbC5jcmVhdGVBZ2VudChBcnJheS5pc0FycmF5KGNvb2tpZSkgPyBjb29raWUgOiB1bmRlZmluZWQsIG9wdCk7XG5cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcU9wdDogYW55ID0ge1xuICAgICAgICAgICAgICAgICAgICBhZ2VudFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAoY29va2llICYmICFBcnJheS5pc0FycmF5KGNvb2tpZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxT3B0LnJlcXVlc3RPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBkbC5nZXRJbmZvKHF1ZXJ5LCByZXFPcHQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRlbXV4YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXIgPSAoZm9ybWF0OiBpbXBvcnQoJ0BkaXN0dWJlL3l0ZGwtY29yZScpLnZpZGVvRm9ybWF0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LmNvZGVjcyA9PT0gJ29wdXMnICYmIGZvcm1hdC5jb250YWluZXIgPT09ICd3ZWJtJyAmJiBmb3JtYXQuYXVkaW9TYW1wbGVSYXRlID09ICc0ODAwMCc7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gaW5mby5mb3JtYXRzLmZpbmQoZmlsdGVyKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWF0ICYmIGluZm8udmlkZW9EZXRhaWxzLmxlbmd0aFNlY29uZHMgIT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbTogZGwuZG93bmxvYWRGcm9tSW5mbyhpbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmFwcGx5UGxhbm5lckNvbmZpZyhvcHRpb25zKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZtdDogJ3dlYm0vb3B1cydcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXRzID0gaW5mby5mb3JtYXRzXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZm8udmlkZW9EZXRhaWxzLmlzTGl2ZUNvbnRlbnQgPyBmb3JtYXQuaXNITFMgJiYgZm9ybWF0Lmhhc0F1ZGlvIDogZm9ybWF0Lmhhc0F1ZGlvO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gTnVtYmVyKGIuYXVkaW9CaXRyYXRlKSAtIE51bWJlcihhLmF1ZGlvQml0cmF0ZSkgfHwgTnVtYmVyKGEuYml0cmF0ZSkgLSBOdW1iZXIoYi5iaXRyYXRlKSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmbXQgPSBmb3JtYXRzLmZpbmQoKGZvcm1hdCkgPT4gIWZvcm1hdC5oYXNWaWRlbykgfHwgZm9ybWF0cy5zb3J0KChhLCBiKSA9PiBOdW1iZXIoYS5iaXRyYXRlKSAtIE51bWJlcihiLmJpdHJhdGUpKVswXTtcbiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBmbXQ/LnVybDtcbiAgICAgICAgICAgICAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcGFyc2Ugc3RyZWFtIHVybCBmb3IgJHtxdWVyeX1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfeXRMaWJOYW1lID09PSAncGxheS1kbCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkbCA9IGxpYiBhcyB0eXBlb2YgaW1wb3J0KCdwbGF5LWRsJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnM/LnJlcXVlc3RPcHRpb25zPy5oZWFkZXJzPy5jb29raWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGRsLnNldFRva2VuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlvdXR1YmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWU6IG9wdGlvbnMucmVxdWVzdE9wdGlvbnMuaGVhZGVycy5jb29raWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBkbC52aWRlb19pbmZvKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICAgIGlmIChkZW11eGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IGRsLnN0cmVhbShxdWVyeSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2NvcmRQbGF5ZXJDb21wYXRpYmlsaXR5OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtOiBzdHJlYW0uc3RyZWFtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmbXQ6IHN0cmVhbS50eXBlIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0cyA9IGluZm8uZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3JtYXQudXJsKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby52aWRlb19kZXRhaWxzLmxpdmUpIHJldHVybiAoaGxzUmVnZXgudGVzdChmb3JtYXQudXJsKSAmJiB0eXBlb2YgZm9ybWF0LmJpdHJhdGUgPT09ICdudW1iZXInKSB8fCAoaGxzUmVnZXgudGVzdChmb3JtYXQudXJsKSAmJiBmb3JtYXQudXJsLmVuZHNXaXRoKCcubTN1OCcpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZm9ybWF0LmJpdHJhdGUgPT09ICdudW1iZXInO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gTnVtYmVyKGIuYml0cmF0ZSkgLSBOdW1iZXIoYS5iaXRyYXRlKSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmbXQgPSBmb3JtYXRzLmZpbmQoKGZvcm1hdCkgPT4gIWZvcm1hdC5xdWFsaXR5TGFiZWwpIHx8IGZvcm1hdHMuc29ydCgoYSwgYikgPT4gTnVtYmVyKGEuYml0cmF0ZSkgLSBOdW1iZXIoYi5iaXRyYXRlKSlbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgdXJsID0gZm10Py51cmw7XG4gICAgICAgICAgICAgICAgaWYgKCF1cmwpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHBhcnNlIHN0cmVhbSB1cmwgZm9yICR7cXVlcnl9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3l0TGliTmFtZSA9PT0gJ3l0LXN0cmVhbScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkbCA9IGxpYiBhcyB0eXBlb2YgaW1wb3J0KCd5dC1zdHJlYW0nKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IG9wdGlvbnM/LnJlcXVlc3RPcHRpb25zPy5oZWFkZXJzPy5jb29raWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29va2llICYmIHR5cGVvZiBjb29raWUgPT09ICdzdHJpbmcnKSBkbC5jb29raWUgPSBjb29raWU7XG5cbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIERlZmF1bHQgbGliIGRpZCBub3QgcHJvdmlkZSB0eXBlcyBmb3IgdGhpcyBmdW5jdGlvblxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjaXBoZXI6IGFueSA9IGF3YWl0IGltcG9ydCgneXQtc3RyZWFtL3NyYy9zdHJlYW0vZGVjaXBoZXIuanMnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBkbC5nZXRJbmZvKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICAgIGluZm8uZm9ybWF0cyA9IGF3YWl0IGRlY2lwaGVyPy5mb3JtYXRfZGVjaXBoZXIoaW5mby5mb3JtYXRzLCBpbmZvLmh0bWw1cGxheWVyKTtcblxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgVGhlIGxpYiBkaWQgbm90IHByb3ZpZGUgdHMgc3VwcG9ydFxuICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IGluZm8uZm9ybWF0cy5maWx0ZXIoKHZhbCkgPT4gdmFsLm1pbWVUeXBlLnN0YXJ0c1dpdGgoJ2F1ZGlvJykgJiYgdmFsLmF1ZGlvUXVhbGl0eSAhPT0gJ0FVRElPX1FVQUxJVFlfTE9XJykubWFwKCh2YWwpID0+IHZhbC51cmwpIGFzIEFycmF5PHN0cmluZz47XG5cbiAgICAgICAgICAgICAgICBpZiAodXJsLmxlbmd0aCAhPT0gMCkgcmV0dXJuIHVybFswXTtcblxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgVGhlIGxpYiBkaWQgbm90IHByb3ZpZGUgdHMgc3VwcG9ydFxuICAgICAgICAgICAgICAgIHJldHVybiBpbmZvLmZvcm1hdHMuZmlsdGVyKCh2YWwpID0+IHZhbC5taW1lVHlwZS5zdGFydHNXaXRoKCdhdWRpbycpKS5tYXAoKHZhbCkgPT4gdmFsLnVybClbMF0gYXMgc3RyaW5nO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFUlJfTk9fWVRfTElCO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IEVSUl9OT19ZVF9MSUI7XG4gICAgfVxuXG4gICAgZmFjdG9yeSA9IHsgbmFtZTogX3l0TGliTmFtZSEsIHN0cmVhbTogX3N0cmVhbSwgbGliIH07XG4gICAgcmV0dXJuIGZhY3Rvcnk7XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFrZVlUU2VhcmNoKHF1ZXJ5OiBzdHJpbmcsIG9wdDogYW55KSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgWW91VHViZS5zZWFyY2gocXVlcnksIHtcbiAgICAgICAgdHlwZTogJ3ZpZGVvJyxcbiAgICAgICAgc2FmZVNlYXJjaDogb3B0Py5zYWZlU2VhcmNoLFxuICAgICAgICByZXF1ZXN0T3B0aW9uczogb3B0XG4gICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAvL1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlcyB8fCBbXTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1ha2VTQ1NlYXJjaChxdWVyeTogc3RyaW5nKSB7XG4gICAgY29uc3QgeyBpbnN0YW5jZSB9ID0gU291bmRDbG91ZEV4dHJhY3RvcjtcbiAgICBpZiAoIWluc3RhbmNlPy5pbnRlcm5hbCkgcmV0dXJuIFtdO1xuXG4gICAgbGV0IGRhdGE6IFNvdW5kQ2xvdWQuU291bmRjbG91ZFRyYWNrVjJbXTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBpbnN0YW5jZS5pbnRlcm5hbC50cmFja3Muc2VhcmNoVjIoe1xuICAgICAgICAgICAgcTogcXVlcnksXG4gICAgICAgICAgICBsaW1pdDogNVxuICAgICAgICB9KTtcblxuICAgICAgICBkYXRhID0gaW5mby5jb2xsZWN0aW9uO1xuICAgIH0gY2F0Y2gge1xuICAgICAgICAvLyBmYWxsYmFja1xuICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgaW5zdGFuY2UuaW50ZXJuYWwudHJhY2tzLnNlYXJjaEFsdChxdWVyeSk7XG5cbiAgICAgICAgZGF0YSA9IGluZm87XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlclNvdW5kQ2xvdWRQcmV2aWV3cyhkYXRhKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHB1bGxZVE1ldGFkYXRhKGV4dDogQmFzZUV4dHJhY3RvciwgaW5mbzogVHJhY2spIHtcbiAgICBjb25zdCBtZXRhID0gYXdhaXQgbWFrZVlUU2VhcmNoKGV4dC5jcmVhdGVCcmlkZ2VRdWVyeShpbmZvKSwgJ3ZpZGVvJylcbiAgICAgICAgLnRoZW4oKHIpID0+IHJbMF0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiBudWxsKTtcblxuICAgIHJldHVybiBtZXRhO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHVsbFNDTWV0YWRhdGEoZXh0OiBCYXNlRXh0cmFjdG9yLCBpbmZvOiBUcmFjaykge1xuICAgIGNvbnN0IG1ldGEgPSBhd2FpdCBtYWtlU0NTZWFyY2goZXh0LmNyZWF0ZUJyaWRnZVF1ZXJ5KGluZm8pKVxuICAgICAgICAudGhlbigocikgPT4gclswXSlcbiAgICAgICAgLmNhdGNoKCgpID0+IG51bGwpO1xuXG4gICAgcmV0dXJuIG1ldGE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJTb3VuZENsb3VkUHJldmlld3ModHJhY2tzOiBTb3VuZENsb3VkLlNvdW5kY2xvdWRUcmFja1YyW10pOiBTb3VuZENsb3VkLlNvdW5kY2xvdWRUcmFja1YyW10ge1xuICAgIGNvbnN0IGZpbHRlcmVkID0gdHJhY2tzLmZpbHRlcigodCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHQucG9saWN5ID09PSAnc3RyaW5nJykgcmV0dXJuIHQucG9saWN5LnRvVXBwZXJDYXNlKCkgPT09ICdBTExPVyc7XG4gICAgICAgIHJldHVybiAhKHQuZHVyYXRpb24gPT09IDMwXzAwMCAmJiB0LmZ1bGxfZHVyYXRpb24gPiAzMF8wMDApO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gZmlsdGVyZWQubGVuZ3RoID4gMCA/IGZpbHRlcmVkIDogdHJhY2tzO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsICJpbXBvcnQgeyBWaWRlbywgWW91VHViZSB9IGZyb20gJ3lvdXR1YmUtc3InO1xuXG4vLyBwcmV0dGllci1pZ25vcmVcbmltcG9ydCB7XG4gICAgQmFzZUV4dHJhY3RvcixcbiAgICBFeHRyYWN0b3JJbmZvLFxuICAgIEV4dHJhY3RvclNlYXJjaENvbnRleHQsXG4gICAgdHlwZSBHdWlsZFF1ZXVlSGlzdG9yeSxcbiAgICBQbGF5bGlzdCxcbiAgICBRdWVyeVR5cGUsXG4gICAgU2VhcmNoUXVlcnlUeXBlLFxuICAgIFRyYWNrLFxuICAgIFV0aWwsXG4gICAgRXh0cmFjdG9yU3RyZWFtYWJsZVxufSBmcm9tICdkaXNjb3JkLXBsYXllcic7XG5cbmltcG9ydCB7IFN0cmVhbUZOLCBZb3VUdWJlTGlicywgbG9hZFl0ZGwsIG1ha2VZVFNlYXJjaCB9IGZyb20gJy4vY29tbW9uL2hlbHBlcic7XG5pbXBvcnQgdHlwZSB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcblxuLy8gdGFrZW4gZnJvbSB5dGRsLWNvcmVcbmNvbnN0IHZhbGlkUXVlcnlEb21haW5zID0gbmV3IFNldChbJ3lvdXR1YmUuY29tJywgJ3d3dy55b3V0dWJlLmNvbScsICdtLnlvdXR1YmUuY29tJywgJ211c2ljLnlvdXR1YmUuY29tJywgJ2dhbWluZy55b3V0dWJlLmNvbSddKTtcbmNvbnN0IHZhbGlkUGF0aERvbWFpbnMgPSAvXmh0dHBzPzpcXC9cXC8oeW91dHVcXC5iZVxcL3wod3d3XFwuKT95b3V0dWJlXFwuY29tXFwvKGVtYmVkfHZ8c2hvcnRzKVxcLykvO1xuY29uc3QgaWRSZWdleCA9IC9eW2EtekEtWjAtOS1fXXsxMX0kLztcblxuZXhwb3J0IGludGVyZmFjZSBZb3V0dWJlRXh0cmFjdG9ySW5pdCB7XG4gICAgY3JlYXRlU3RyZWFtPzogKGV4dDogWW91dHViZUV4dHJhY3RvciwgdXJsOiBzdHJpbmcpID0+IFByb21pc2U8UmVhZGFibGUgfCBzdHJpbmc+O1xufVxuXG5leHBvcnQgY2xhc3MgWW91dHViZUV4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3I8WW91dHViZUV4dHJhY3RvckluaXQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnlvdXR1YmVleHRyYWN0b3InIGFzIGNvbnN0O1xuICAgIHB1YmxpYyBfc3RyZWFtITogU3RyZWFtRk47XG4gICAgcHVibGljIF95dExpYk5hbWUhOiBzdHJpbmc7XG4gICAgcHVibGljIHN0YXRpYyBpbnN0YW5jZTogWW91dHViZUV4dHJhY3RvciB8IG51bGw7XG5cbiAgICBwdWJsaWMgYXN5bmMgYWN0aXZhdGUoKSB7XG4gICAgICAgIHRoaXMucHJvdG9jb2xzID0gWyd5dHNlYXJjaCcsICd5b3V0dWJlJ107XG4gICAgICAgIGNvbnN0IGZuID0gdGhpcy5vcHRpb25zLmNyZWF0ZVN0cmVhbTtcblxuICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLl9zdHJlYW0gPSAocTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKHRoaXMsIHEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHsgc3RyZWFtLCBuYW1lIH0gPSBhd2FpdCBsb2FkWXRkbCh0aGlzLmNvbnRleHQucGxheWVyLm9wdGlvbnMueXRkbE9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5fc3RyZWFtID0gc3RyZWFtO1xuICAgICAgICAgICAgdGhpcy5feXRMaWJOYW1lID0gbmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByb2Nlc3MuZW1pdFdhcm5pbmcoXG4gICAgICAgICAgICAnWW91dHViZUV4dHJhY3RvciB1c2VzIHNjcmFwaW5nLWJhc2VkIHN0cmVhbWluZyBsaWJyYXJpZXMgd2hpY2ggaXMga25vd24gdG8gYmUgdW5zdGFibGUgYXQgdGltZXMuXFxuQW4gYWx0ZXJuYXRpdmUgaXMgdG8gdXNlIGRpc2NvcmQtcGxheWVyLXlvdXR1YmVpIGh0dHBzOi8vbnBtLmltL2Rpc2NvcmQtcGxheWVyLXlvdXR1YmVpXFxuVmlldyB0aGlzIEdpdEh1YiBpc3N1ZSBmb3IgbW9yZSBpbmZvcm1hdGlvbjogaHR0cHM6Ly9naXRodWIuY29tL0FuZHJvejIwOTEvZGlzY29yZC1wbGF5ZXIvaXNzdWVzLzE5MjInXG4gICAgICAgICk7XG5cbiAgICAgICAgWW91dHViZUV4dHJhY3Rvci5pbnN0YW5jZSA9IHRoaXM7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGRlYWN0aXZhdGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMucHJvdG9jb2xzID0gW107XG4gICAgICAgIFlvdXR1YmVFeHRyYWN0b3IuaW5zdGFuY2UgPSBudWxsO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICAvLyBwcmV0dGllci1pZ25vcmVcbiAgICAgICAgcmV0dXJuIChbXG4gICAgICAgICAgICBRdWVyeVR5cGUuWU9VVFVCRSxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5ZT1VUVUJFX1BMQVlMSVNULFxuICAgICAgICAgICAgUXVlcnlUeXBlLllPVVRVQkVfU0VBUkNILFxuICAgICAgICAgICAgUXVlcnlUeXBlLllPVVRVQkVfVklERU8sXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVVUTyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPX1NFQVJDSFxuICAgICAgICBdIGFzIFNlYXJjaFF1ZXJ5VHlwZVtdKS5zb21lKChyKSA9PiByID09PSB0eXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgaGFuZGxlKHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ6IEV4dHJhY3RvclNlYXJjaENvbnRleHQpOiBQcm9taXNlPEV4dHJhY3RvckluZm8+IHtcbiAgICAgICAgaWYgKGNvbnRleHQucHJvdG9jb2wgPT09ICd5dHNlYXJjaCcpIGNvbnRleHQudHlwZSA9IFF1ZXJ5VHlwZS5ZT1VUVUJFX1NFQVJDSDtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5pbmNsdWRlcygneW91dHViZS5jb20nKSA/IHF1ZXJ5LnJlcGxhY2UoLyhtKHVzaWMpP3xnYW1pbmcpXFwuLywgJycpIDogcXVlcnk7XG4gICAgICAgIGlmICghcXVlcnkuaW5jbHVkZXMoJ2xpc3Q9UkQnKSAmJiBZb3V0dWJlRXh0cmFjdG9yLnZhbGlkYXRlVVJMKHF1ZXJ5KSkgY29udGV4dC50eXBlID0gUXVlcnlUeXBlLllPVVRVQkVfVklERU87XG5cbiAgICAgICAgc3dpdGNoIChjb250ZXh0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLllPVVRVQkVfUExBWUxJU1Q6IHtcbiAgICAgICAgICAgICAgICBjb25zdCB5dHBsID0gYXdhaXQgWW91VHViZS5nZXRQbGF5bGlzdChxdWVyeSwge1xuICAgICAgICAgICAgICAgICAgICBmZXRjaEFsbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgICAgbGltaXQ6IChjb250ZXh0LnJlcXVlc3RPcHRpb25zIGFzIGFueSk/LmxpbWl0LFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0T3B0aW9uczogY29udGV4dC5yZXF1ZXN0T3B0aW9ucyBhcyB1bmtub3duIGFzIFJlcXVlc3RJbml0XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICBpZiAoIXl0cGwpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHl0cGwudGl0bGUhLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHl0cGwudGh1bWJuYWlsPy5kaXNwbGF5VGh1bWJuYWlsVVJMKCdtYXhyZXNkZWZhdWx0JykgYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogeXRwbC50aXRsZSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAneW91dHViZScsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogeXRwbC5jaGFubmVsIS5uYW1lIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogeXRwbC5jaGFubmVsIS51cmwgYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgIGlkOiB5dHBsLmlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB5dHBsLnVybCBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiB5dHBsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSB5dHBsLnZpZGVvcy5tYXAoKHZpZGVvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB2aWRlby50aXRsZSBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24gYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB2aWRlby5jaGFubmVsPy5uYW1lIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdmlkZW8udXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHZpZGVvLnRodW1ibmFpbCEudXJsIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiB2aWRlby52aWV3cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdzogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdDogcGxheWxpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICd5b3V0dWJlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ3lvdXR1YmVWaWRlbycsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3luYyByZXF1ZXN0TWV0YWRhdGEoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZGVvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpdmU6IHZpZGVvLmxpdmVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdHJhY2sucGxheWxpc3QgPSBwbGF5bGlzdDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5ZT1VUVUJFX1ZJREVPOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSAvW2EtekEtWjAtOS1fXXsxMX0vLmV4ZWMocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghaWQ/LlswXSkgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZGVvID0gYXdhaXQgWW91VHViZS5nZXRWaWRlbyhgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke2lkfWAsIGNvbnRleHQucmVxdWVzdE9wdGlvbnMgYXMgdW5rbm93biBhcyBSZXF1ZXN0SW5pdCkuY2F0Y2goVXRpbC5ub29wKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZpZGVvKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICAgICAgICAgICAgdmlkZW8uc291cmNlID0gJ3lvdXR1YmUnO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdmlkZW8udGl0bGUhLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24hLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHZpZGVvLmNoYW5uZWw/Lm5hbWUgYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHZpZGVvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdmlkZW8udGh1bWJuYWlsPy5kaXNwbGF5VGh1bWJuYWlsVVJMKCdtYXhyZXNkZWZhdWx0JykgYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czogdmlkZW8udmlld3MsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAneW91dHViZScsXG4gICAgICAgICAgICAgICAgICAgIHJhdzogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdmlkZW8sXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIHJlcXVlc3RNZXRhZGF0YSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWRlbztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbGl2ZTogdmlkZW8ubGl2ZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHBsYXlsaXN0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0cmFja3M6IFt0cmFja11cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrcyA9IGF3YWl0IHRoaXMuX21ha2VZVFNlYXJjaChxdWVyeSwgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrcyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfbWFrZVlUU2VhcmNoKHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ6IEV4dHJhY3RvclNlYXJjaENvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgbWFrZVlUU2VhcmNoKHF1ZXJ5LCBjb250ZXh0LnJlcXVlc3RPcHRpb25zKS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLmxlbmd0aCkgcmV0dXJuIFtdO1xuXG4gICAgICAgIHJldHVybiByZXMubWFwKCh2aWRlbykgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgICAgdmlkZW8uc291cmNlID0gJ3lvdXR1YmUnO1xuXG4gICAgICAgICAgICBjb25zdCB0cmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHZpZGVvLnRpdGxlISxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24hLFxuICAgICAgICAgICAgICAgIGF1dGhvcjogdmlkZW8uY2hhbm5lbD8ubmFtZSBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgdXJsOiB2aWRlby51cmwsXG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB2aWRlby50aHVtYm5haWw/LmRpc3BsYXlUaHVtYm5haWxVUkwoJ21heHJlc2RlZmF1bHQnKSBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgdmlld3M6IHZpZGVvLnZpZXdzLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCxcbiAgICAgICAgICAgICAgICBzb3VyY2U6ICd5b3V0dWJlJyxcbiAgICAgICAgICAgICAgICByYXc6IHZpZGVvLFxuICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlISxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogdmlkZW8sXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVxdWVzdE1ldGFkYXRhKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlkZW87XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsaXZlOiB2aWRlby5saXZlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHRyYWNrO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2ssIGhpc3Rvcnk6IEd1aWxkUXVldWVIaXN0b3J5KSB7XG4gICAgICAgIGxldCBpbmZvOiBWaWRlb1tdIHwgdm9pZCA9IHVuZGVmaW5lZDtcblxuICAgICAgICBpZiAoWW91dHViZUV4dHJhY3Rvci52YWxpZGF0ZVVSTCh0cmFjay51cmwpKVxuICAgICAgICAgICAgaW5mbyA9IGF3YWl0IFlvdVR1YmUuZ2V0VmlkZW8odHJhY2sudXJsKVxuICAgICAgICAgICAgICAgIC50aGVuKCh4KSA9PiB4LnZpZGVvcylcbiAgICAgICAgICAgICAgICAuY2F0Y2goVXRpbC5ub29wKTtcblxuICAgICAgICAvLyBmYWxsYmFja1xuICAgICAgICBpZiAoIWluZm8pXG4gICAgICAgICAgICBpbmZvID0gYXdhaXQgWW91VHViZS5zZWFyY2godHJhY2suYXV0aG9yIHx8IHRyYWNrLnRpdGxlLCB7IGxpbWl0OiA1LCB0eXBlOiAndmlkZW8nIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKHgpID0+IHgpXG4gICAgICAgICAgICAgICAgLmNhdGNoKFV0aWwubm9vcCk7XG5cbiAgICAgICAgaWYgKCFpbmZvPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1bmlxdWUgPSBpbmZvLmZpbHRlcigodCkgPT4gIWhpc3RvcnkudHJhY2tzLnNvbWUoKHgpID0+IHgudXJsID09PSB0LnVybCkpO1xuXG4gICAgICAgIGNvbnN0IHNpbWlsYXIgPSAodW5pcXVlLmxlbmd0aCA+IDAgPyB1bmlxdWUgOiBpbmZvKS5tYXAoKHZpZGVvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdmlkZW8udGl0bGUhLFxuICAgICAgICAgICAgICAgIHVybDogYGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9JHt2aWRlby5pZH1gLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB2aWRlby5kdXJhdGlvbkZvcm1hdHRlZCB8fCBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHZpZGVvLmR1cmF0aW9uICogMTAwMCkpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB2aWRlby50aXRsZSEsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB0eXBlb2YgdmlkZW8udGh1bWJuYWlsID09PSAnc3RyaW5nJyA/IHZpZGVvLnRodW1ibmFpbCEgOiB2aWRlby50aHVtYm5haWwhLnVybCEsXG4gICAgICAgICAgICAgICAgdmlld3M6IHZpZGVvLnZpZXdzLFxuICAgICAgICAgICAgICAgIGF1dGhvcjogdmlkZW8uY2hhbm5lbCEubmFtZSEsXG4gICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IHRyYWNrLnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgIHNvdXJjZTogJ3lvdXR1YmUnLFxuICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ3lvdXR1YmVWaWRlbycsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHZpZGVvLFxuICAgICAgICAgICAgICAgIGFzeW5jIHJlcXVlc3RNZXRhZGF0YSgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZGVvO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbGl2ZTogdmlkZW8ubGl2ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHQuZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKG51bGwsIHNpbWlsYXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBlbXB0eVJlc3BvbnNlKCk6IEV4dHJhY3RvckluZm8ge1xuICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzdHJlYW0oaW5mbzogVHJhY2spOiBQcm9taXNlPEV4dHJhY3RvclN0cmVhbWFibGU+IHtcbiAgICAgICAgaWYgKCF0aGlzLl9zdHJlYW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgeW91dHViZSBzdHJlYW1pbmcgbGlicmFyeS4gSW5zdGFsbCBvbmUgb2YgJHtZb3VUdWJlTGlicy5qb2luKCcsICcpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVybCA9IGluZm8udXJsO1xuICAgICAgICB1cmwgPSB1cmwuaW5jbHVkZXMoJ3lvdXR1YmUuY29tJykgPyB1cmwucmVwbGFjZSgvKG0odXNpYyk/fGdhbWluZylcXC4vLCAnJykgOiB1cmw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmVhbSh1cmwsIHRoaXMsIHRoaXMuc3VwcG9ydHNEZW11eCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGJyaWRnZSh0cmFjazogVHJhY2ssIHNvdXJjZUV4dHJhY3RvcjogQmFzZUV4dHJhY3RvciB8IG51bGwpOiBQcm9taXNlPEV4dHJhY3RvclN0cmVhbWFibGUgfCBudWxsPiB7XG4gICAgICAgIGlmIChzb3VyY2VFeHRyYWN0b3I/LmlkZW50aWZpZXIgPT09IHRoaXMuaWRlbnRpZmllcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RyZWFtKHRyYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gc291cmNlRXh0cmFjdG9yPy5jcmVhdGVCcmlkZ2VRdWVyeSh0cmFjaykgPz8gYCR7dHJhY2suYXV0aG9yfSAtICR7dHJhY2sudGl0bGV9YDtcbiAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IHRoaXMuaGFuZGxlKHF1ZXJ5LCB7XG4gICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnksXG4gICAgICAgICAgICB0eXBlOiBRdWVyeVR5cGUuWU9VVFVCRVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWluZm8udHJhY2tzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmVhbShpbmZvLnRyYWNrc1swXSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB2YWxpZGF0ZVVSTChsaW5rOiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIFlvdXR1YmVFeHRyYWN0b3IucGFyc2VVUkwobGluayk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHZhbGlkYXRlSWQoaWQ6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gaWRSZWdleC50ZXN0KGlkLnRyaW0oKSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBwYXJzZVVSTChsaW5rOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTChsaW5rLnRyaW0oKSk7XG4gICAgICAgIGxldCBpZCA9IHBhcnNlZC5zZWFyY2hQYXJhbXMuZ2V0KCd2Jyk7XG4gICAgICAgIGlmICh2YWxpZFBhdGhEb21haW5zLnRlc3QobGluay50cmltKCkpICYmICFpZCkge1xuICAgICAgICAgICAgY29uc3QgcGF0aHMgPSBwYXJzZWQucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgIGlkID0gcGFyc2VkLmhvc3QgPT09ICd5b3V0dS5iZScgPyBwYXRoc1sxXSA6IHBhdGhzWzJdO1xuICAgICAgICB9IGVsc2UgaWYgKHBhcnNlZC5ob3N0bmFtZSAmJiAhdmFsaWRRdWVyeURvbWFpbnMuaGFzKHBhcnNlZC5ob3N0bmFtZSkpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdOb3QgYSBZb3VUdWJlIGRvbWFpbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBObyB2aWRlbyBpZCBmb3VuZDogXCIke2xpbmt9XCJgKTtcbiAgICAgICAgfVxuICAgICAgICBpZCA9IGlkLnN1YnN0cmluZygwLCAxMSk7XG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0ZUlkKGlkKSkge1xuICAgICAgICAgICAgdGhyb3cgVHlwZUVycm9yKGBWaWRlbyBpZCAoJHtpZH0pIGRvZXMgbm90IG1hdGNoIGV4cGVjdGVkIGAgKyBgZm9ybWF0ICgke2lkUmVnZXgudG9TdHJpbmcoKX0pYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgWW91dHViZUV4dHJhY3RvciBhcyBZb3VUdWJlRXh0cmFjdG9yIH07XG4iLCAiaW1wb3J0IHsgQ2xpZW50IGFzIEdlbml1c0NsaWVudCB9IGZyb20gJ2dlbml1cy1seXJpY3MnO1xuXG4vLyBsYXp5IGxvYWQgY2xpZW50XG5sZXQgY2xpZW50OiBHZW5pdXNDbGllbnQ7XG5cbmV4cG9ydCBmdW5jdGlvbiBseXJpY3NFeHRyYWN0b3IoYXBpS2V5Pzogc3RyaW5nLCBmb3JjZT86IGJvb2xlYW4pIHtcbiAgICBpZiAoIWNsaWVudCAmJiAhZm9yY2UpIGNsaWVudCA9IG5ldyBHZW5pdXNDbGllbnQoYXBpS2V5KTtcbiAgICByZXR1cm4geyBzZWFyY2gsIGNsaWVudCB9O1xufVxuXG5mdW5jdGlvbiBzZWFyY2gocXVlcnk6IHN0cmluZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxMeXJpY3NEYXRhIHwgbnVsbD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBzZWFyY2ggcXVlcnkgdG8gYmUgYSBzdHJpbmcsIHJlY2VpdmVkIFwiJHt0eXBlb2YgcXVlcnl9XCIhYCkpO1xuXG4gICAgICAgIGNsaWVudC5zb25nc1xuICAgICAgICAgICAgLnNlYXJjaChxdWVyeSlcbiAgICAgICAgICAgIC50aGVuKGFzeW5jIChzb25ncykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzb25nc1swXS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZnVsbFRpdGxlOiBzb25nc1swXS5mdWxsVGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBzb25nc1swXS5pZCxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzb25nc1swXS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiBzb25nc1swXS5pbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nc1swXS51cmwsXG4gICAgICAgICAgICAgICAgICAgIGFydGlzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc29uZ3NbMF0uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc29uZ3NbMF0uYXJ0aXN0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nc1swXS5hcnRpc3QudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHNvbmdzWzBdLmFydGlzdC5pbWFnZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBseXJpY3M6IGF3YWl0IHNvbmdzWzBdLmx5cmljcyhmYWxzZSlcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0NvdWxkIG5vdCBwYXJzZSBseXJpY3MnKSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMeXJpY3NEYXRhIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGZ1bGxUaXRsZTogc3RyaW5nO1xuICAgIGlkOiBudW1iZXI7XG4gICAgdGh1bWJuYWlsOiBzdHJpbmc7XG4gICAgaW1hZ2U6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgICBhcnRpc3Q6IHtcbiAgICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgICBpZDogbnVtYmVyO1xuICAgICAgICB1cmw6IHN0cmluZztcbiAgICAgICAgaW1hZ2U6IHN0cmluZztcbiAgICB9O1xuICAgIGx5cmljczogc3RyaW5nO1xufVxuIiwgIi8vIHByZXR0aWVyLWlnbm9yZVxuaW1wb3J0IHtcbiAgICBCYXNlRXh0cmFjdG9yLFxuICAgIEV4dHJhY3RvckluZm8sXG4gICAgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCxcbiAgICBRdWVyeVR5cGUsXG4gICAgU2VhcmNoUXVlcnlUeXBlLFxuICAgIFRyYWNrLFxuICAgIFV0aWxcbn0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHsgVmltZW8gfSBmcm9tICcuLi9pbnRlcm5hbC9WaW1lbyc7XG5cbmV4cG9ydCBjbGFzcyBWaW1lb0V4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3Ige1xuICAgIHB1YmxpYyBzdGF0aWMgaWRlbnRpZmllciA9ICdjb20uZGlzY29yZC1wbGF5ZXIudmltZW9leHRyYWN0b3InIGFzIGNvbnN0O1xuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGlmICh0eXBlb2YgcXVlcnkgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiAoW1F1ZXJ5VHlwZS5WSU1FT10gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaykge1xuICAgICAgICB2b2lkIHRyYWNrO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuVklNRU86IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja0luZm8gPSBhd2FpdCBWaW1lby5nZXRJbmZvKFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCcvJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKHgpID0+ICEheClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3AoKSFcbiAgICAgICAgICAgICAgICApLmNhdGNoKFV0aWwubm9vcCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRyYWNrSW5mbykgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbiB8fCAwKSksXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHt0cmFja0luZm8udGl0bGV9IGJ5ICR7dHJhY2tJbmZvLmF1dGhvci5uYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogdHJhY2tJbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogdHJhY2tJbmZvLmF1dGhvci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXJiaXRyYXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiB0cmFja0luZm8uc3RyZWFtLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHRyYWNrSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMgcmVxdWVzdE1ldGFkYXRhKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrSW5mbztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFt0cmFja10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlSZXNwb25zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGVtcHR5UmVzcG9uc2UoKTogRXh0cmFjdG9ySW5mbyB7XG4gICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFtdIH07XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHN0cmVhbShpbmZvOiBUcmFjaykge1xuICAgICAgICBjb25zdCBlbmdpbmUgPSBpbmZvLnJhdy5lbmdpbmUgYXMgc3RyaW5nO1xuICAgICAgICBpZiAoZW5naW5lKSB7XG4gICAgICAgICAgICByZXR1cm4gZW5naW5lO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdHJhY2sgPSBhd2FpdCBWaW1lby5nZXRJbmZvKGluZm8udXJsKS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICBpZiAoIXRyYWNrIHx8ICF0cmFjay5zdHJlYW0pIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGV4dHJhY3Qgc3RyZWFtIGZyb20gdGhpcyBzb3VyY2UnKTtcblxuICAgICAgICBpbmZvLnJhdy5lbmdpbmUgPSB7XG4gICAgICAgICAgICBzdHJlYW1VUkw6IHRyYWNrLnN0cmVhbVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB0cmFjay5zdHJlYW07XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcbmltcG9ydCBodHRwIGZyb20gJ2h0dHAnO1xuaW1wb3J0IGh0dHBzIGZyb20gJ2h0dHBzJztcbmltcG9ydCB7IGZldGNoIH0gZnJvbSAnLi4vZXh0cmFjdG9ycy9jb21tb24vaGVscGVyJztcblxuY2xhc3MgVmltZW8ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAke3RoaXMuY29uc3RydWN0b3IubmFtZX0gY2xhc3MgbWF5IG5vdCBiZSBpbnN0YW50aWF0ZWQhYCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHR5cGVkZWYge1JlYWRhYmxlfSBSZWFkYWJsZVxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogRG93bmxvYWRzIGZyb20gdmltZW9cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWQgVmltZW8gdmlkZW8gaWRcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxSZWFkYWJsZT59XG4gICAgICovXG4gICAgc3RhdGljIGRvd25sb2FkKGlkOiBudW1iZXIgfCBzdHJpbmcpOiBQcm9taXNlPFJlYWRhYmxlPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5mbyA9IGF3YWl0IFZpbWVvLmdldEluZm8oaWQpO1xuICAgICAgICAgICAgaWYgKCFpbmZvKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgZG93bmxvYWRlciA9IGluZm8uc3RyZWFtLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykgPyBodHRwcyA6IGh0dHA7XG5cbiAgICAgICAgICAgIGRvd25sb2FkZXIuZ2V0KGluZm8uc3RyZWFtLCAocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdmlkZW8gaW5mb1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpZCBWaWRlbyBpZFxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZXRJbmZvKGlkOiBudW1iZXIgfCBzdHJpbmcpOiBQcm9taXNlPFZpbWVvSW5mbyB8IG51bGw+IHtcbiAgICAgICAgaWYgKCFpZCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlkJyk7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3BsYXllci52aW1lby5jb20vdmlkZW8vJHtpZH1gO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy50ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShkYXRhLnNwbGl0KCd3aW5kb3cucGxheWVyQ29uZmlnID0nKVsxXS5zcGxpdCgnOycpWzBdLnRyaW0oKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAgICAgICAgICBpZDoganNvbi52aWRlby5pZCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjoganNvbi52aWRlby5kdXJhdGlvbiAqIDEwMDAsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGpzb24udmlkZW8udGl0bGUsXG4gICAgICAgICAgICAgICAgdXJsOiBqc29uLnZpZGVvLnVybCxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGpzb24udmlkZW8udGh1bWJzWycxMjgwJ10gfHwganNvbi52aWRlby50aHVtYnMuYmFzZSxcbiAgICAgICAgICAgICAgICBzdHJlYW06IGpzb24ucmVxdWVzdC5maWxlcy5wcm9ncmVzc2l2ZVswXS51cmwsXG4gICAgICAgICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBqc29uLnZpZGVvLm93bmVyLmlkLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBqc29uLnZpZGVvLm93bmVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHVybDoganNvbi52aWRlby5vd25lci51cmwsXG4gICAgICAgICAgICAgICAgICAgIGF2YXRhcjoganNvbi52aWRlby5vd25lci5pbWdfMnggfHwganNvbi52aWRlby5vd25lci5pbWdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpbWVvSW5mbyB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBkdXJhdGlvbjogbnVtYmVyO1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgdXJsOiBzdHJpbmc7XG4gICAgdGh1bWJuYWlsOiBzdHJpbmc7XG4gICAgc3RyZWFtOiBzdHJpbmc7XG4gICAgYXV0aG9yOiB7XG4gICAgICAgIGlkOiBudW1iZXI7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgdXJsOiBzdHJpbmc7XG4gICAgICAgIGF2YXRhcjogc3RyaW5nO1xuICAgIH07XG59XG5cbmV4cG9ydCB7IFZpbWVvIH07XG4iLCAiLy8gcHJldHRpZXItaWdub3JlXG5pbXBvcnQge1xuICAgIEJhc2VFeHRyYWN0b3IsXG4gICAgRXh0cmFjdG9ySW5mbyxcbiAgICBFeHRyYWN0b3JTZWFyY2hDb250ZXh0LFxuICAgIFF1ZXJ5VHlwZSxcbiAgICBTZWFyY2hRdWVyeVR5cGUsXG4gICAgVHJhY2ssXG4gICAgVXRpbFxufSBmcm9tICdkaXNjb3JkLXBsYXllcic7XG5pbXBvcnQgcmV2ZXJibmF0aW9uIGZyb20gJ3JldmVyYm5hdGlvbi1zY3JhcGVyJztcblxuZXhwb3J0IGNsYXNzIFJldmVyYm5hdGlvbkV4dHJhY3RvciBleHRlbmRzIEJhc2VFeHRyYWN0b3Ige1xuICAgIHB1YmxpYyBzdGF0aWMgaWRlbnRpZmllciA9ICdjb20uZGlzY29yZC1wbGF5ZXIucmV2ZXJibmF0aW9uZXh0cmFjdG9yJyBhcyBjb25zdDtcblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKFtRdWVyeVR5cGUuUkVWRVJCTkFUSU9OXSBhcyBTZWFyY2hRdWVyeVR5cGVbXSkuc29tZSgocikgPT4gciA9PT0gdHlwZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGdldFJlbGF0ZWRUcmFja3ModHJhY2s6IFRyYWNrKSB7XG4gICAgICAgIHZvaWQgdHJhY2s7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5SRVZFUkJOQVRJT046IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja0luZm8gPSBhd2FpdCByZXZlcmJuYXRpb24uZ2V0SW5mbyhxdWVyeSkuY2F0Y2goVXRpbC5ub29wKTtcblxuICAgICAgICAgICAgICAgIGlmICghdHJhY2tJbmZvKSByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0cmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0cmFja0luZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdHJhY2tJbmZvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVModHJhY2tJbmZvLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0cmFja0luZm8ubHlyaWNzIHx8IGAke3RyYWNrSW5mby50aXRsZX0gYnkgJHt0cmFja0luZm8uYXJ0aXN0Lm5hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB0cmFja0luZm8udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB0cmFja0luZm8uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcmJpdHJhcnknLFxuICAgICAgICAgICAgICAgICAgICBlbmdpbmU6IHRyYWNrSW5mby5zdHJlYW1VUkwsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICBhc3luYyByZXF1ZXN0TWV0YWRhdGEoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2tJbmZvO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW3RyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZW1wdHlSZXNwb25zZSgpOiBFeHRyYWN0b3JJbmZvIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc3RyZWFtKGluZm86IFRyYWNrKSB7XG4gICAgICAgIGNvbnN0IGVuZ2luZSA9IGluZm8ucmF3LmVuZ2luZSBhcyBzdHJpbmc7XG4gICAgICAgIGlmIChlbmdpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmdpbmU7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0cmFjayA9IGF3YWl0IHJldmVyYm5hdGlvbi5nZXRJbmZvKGluZm8udXJsKS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICBpZiAoIXRyYWNrIHx8ICF0cmFjay5zdHJlYW1VUkwpIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGV4dHJhY3Qgc3RyZWFtIGZyb20gdGhpcyBzb3VyY2UnKTtcblxuICAgICAgICBpbmZvLnJhdy5lbmdpbmUgPSB7XG4gICAgICAgICAgICBzdHJlYW1VUkw6IHRyYWNrLnN0cmVhbVVSTFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB0cmFjay5zdHJlYW1VUkw7XG4gICAgfVxufVxuIiwgIi8vIHByZXR0aWVyLWlnbm9yZVxuaW1wb3J0IHtcbiAgICBCYXNlRXh0cmFjdG9yLFxuICAgIEV4dHJhY3RvckluZm8sXG4gICAgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCxcbiAgICBRdWVyeVR5cGUsXG4gICAgU2VhcmNoUXVlcnlUeXBlLFxuICAgIFRyYWNrLFxuICAgIFV0aWxcbn0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ01lc3NhZ2UgfSBmcm9tICdodHRwJztcbmltcG9ydCB7IGNyZWF0ZVJlYWRTdHJlYW0sIGV4aXN0c1N5bmMgfSBmcm9tICdmcyc7XG5pbXBvcnQgeyBkb3dubG9hZFN0cmVhbSB9IGZyb20gJy4uL2ludGVybmFsL2Rvd25sb2FkZXInO1xuaW1wb3J0ICogYXMgZmlsZVR5cGUgZnJvbSAnZmlsZS10eXBlJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgc3RhdCB9IGZyb20gJ2ZzL3Byb21pc2VzJztcblxuY29uc3QgQVRUQUNITUVOVF9IRUFERVIgPSBbJ2F1ZGlvLycsICd2aWRlby8nLCAnYXBwbGljYXRpb24vb2dnJ10gYXMgY29uc3Q7XG5cbmV4cG9ydCBjbGFzcyBBdHRhY2htZW50RXh0cmFjdG9yIGV4dGVuZHMgQmFzZUV4dHJhY3RvciB7XG4gICAgcHVibGljIHN0YXRpYyBpZGVudGlmaWVyID0gJ2NvbS5kaXNjb3JkLXBsYXllci5hdHRhY2htZW50ZXh0cmFjdG9yJyBhcyBjb25zdDtcblxuICAgIC8vIHVzZSBsb3dlc3QgcHJpb3JpdHkgdG8gYXZvaWQgY29uZmxpY3Qgd2l0aCBvdGhlciBleHRyYWN0b3JzXG4gICAgcHVibGljIHByaW9yaXR5ID0gMDtcblxuICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZShxdWVyeTogc3RyaW5nLCB0eXBlPzogU2VhcmNoUXVlcnlUeXBlIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKFtRdWVyeVR5cGUuQVJCSVRSQVJZLCBRdWVyeVR5cGUuRklMRV0gYXMgU2VhcmNoUXVlcnlUeXBlW10pLnNvbWUoKHIpID0+IHIgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaykge1xuICAgICAgICB2b2lkIHRyYWNrO1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBoYW5kbGUocXVlcnk6IHN0cmluZywgY29udGV4dDogRXh0cmFjdG9yU2VhcmNoQ29udGV4dCk6IFByb21pc2U8RXh0cmFjdG9ySW5mbz4ge1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVJCSVRSQVJZOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IChhd2FpdCBkb3dubG9hZFN0cmVhbShxdWVyeSwgY29udGV4dC5yZXF1ZXN0T3B0aW9ucykpIGFzIEluY29taW5nTWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoIUFUVEFDSE1FTlRfSEVBREVSLnNvbWUoKHIpID0+ICEhZGF0YS5oZWFkZXJzWydjb250ZW50LXR5cGUnXT8uc3RhcnRzV2l0aChyKSkpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IChcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCcvJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCh4KSA9PiB4Lmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9wKCkgPz8gJ0F0dGFjaG1lbnQnXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnPycpWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJpbSgpLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiAnaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy8yLzJhL0lUdW5lc18xMi4yX2xvZ28ucG5nJyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogKChkYXRhIGFzIGFueSkuY2xpZW50Py5zZXJ2ZXJuYW1lIGFzIHN0cmluZykgfHwgJ0F0dGFjaG1lbnQnLFxuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICgoZGF0YSBhcyBhbnkpLmNsaWVudD8uc2VydmVybmFtZSBhcyBzdHJpbmcpIHx8ICdBdHRhY2htZW50JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBkYXRhLnVybCB8fCBxdWVyeVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVkaWFwbGV4ID0gcmVxdWlyZSgnbWVkaWFwbGV4JykgYXMgdHlwZW9mIGltcG9ydCgnbWVkaWFwbGV4Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVvdXQgPSB0aGlzLmNvbnRleHQucGxheWVyLm9wdGlvbnMucHJvYmVUaW1lb3V0ID8/IDUwMDA7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyByZXN1bHQsIHN0cmVhbSB9ID0gKGF3YWl0IFByb21pc2UucmFjZShbXG4gICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXBsZXgucHJvYmVTdHJlYW0oZGF0YSksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZSgoXywgcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcihuZXcgRXJyb3IoJ1RpbWVvdXQnKSksIHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXSkpIGFzIEF3YWl0ZWQ8UmV0dXJuVHlwZTx0eXBlb2YgbWVkaWFwbGV4LnByb2JlU3RyZWFtPj47XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tJbmZvLmR1cmF0aW9uID0gcmVzdWx0LmR1cmF0aW9uICogMTAwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBtZWRpYXBsZXgucmVhZE1ldGFkYXRhKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEuYXV0aG9yKSB0cmFja0luZm8uYXV0aG9yID0gbWV0YWRhdGEuYXV0aG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhLnRpdGxlKSB0cmFja0luZm8udGl0bGUgPSBtZXRhZGF0YS50aXRsZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tJbmZvLmRlc2NyaXB0aW9uID0gYCR7dHJhY2tJbmZvLnRpdGxlfSBieSAke3RyYWNrSW5mby5hdXRob3J9YDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdHJhY2tJbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHRyYWNrSW5mby5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdHJhY2tJbmZvLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrSW5mby50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHRyYWNrSW5mby5hdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcmJpdHJhcnknLFxuICAgICAgICAgICAgICAgICAgICBlbmdpbmU6IHRyYWNrSW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdHJhY2tJbmZvLFxuICAgICAgICAgICAgICAgICAgICBhc3luYyByZXF1ZXN0TWV0YWRhdGEoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2tJbmZvO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdHJhY2sucmF3LmlzRmlsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW3RyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuRklMRToge1xuICAgICAgICAgICAgICAgIGlmICghZXhpc3RzU3luYyhxdWVyeSkpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmc3RhdCA9IGF3YWl0IHN0YXQocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghZnN0YXQuaXNGaWxlKCkpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtaW1lID0gYXdhaXQgZmlsZVR5cGUuZnJvbUZpbGUocXVlcnkpLmNhdGNoKCgpID0+IG51bGwpO1xuICAgICAgICAgICAgICAgIGlmICghbWltZSB8fCAhQVRUQUNITUVOVF9IRUFERVIuc29tZSgocikgPT4gISFtaW1lLm1pbWUuc3RhcnRzV2l0aChyKSkpIHJldHVybiB0aGlzLmVtcHR5UmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHBhdGguYmFzZW5hbWUocXVlcnkpIHx8ICdBdHRhY2htZW50JyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvMi8yYS9JVHVuZXNfMTIuMl9sb2dvLnBuZycsXG4gICAgICAgICAgICAgICAgICAgIGVuZ2luZTogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogJ0F0dGFjaG1lbnQnLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0F0dGFjaG1lbnQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHF1ZXJ5XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZWRpYXBsZXggPSByZXF1aXJlKCdtZWRpYXBsZXgnKSBhcyB0eXBlb2YgaW1wb3J0KCdtZWRpYXBsZXgnKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lb3V0ID0gdGhpcy5jb250ZXh0LnBsYXllci5vcHRpb25zLnByb2JlVGltZW91dCA/PyA1MDAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcmVzdWx0LCBzdHJlYW0gfSA9IChhd2FpdCBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWFwbGV4LnByb2JlU3RyZWFtKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVJlYWRTdHJlYW0ocXVlcnksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogMTAyNCAqIDEwMjQgKiAxMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFByb21pc2UoKF8sIHIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHIobmV3IEVycm9yKCdUaW1lb3V0JykpLCB0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIF0pKSBhcyBBd2FpdGVkPFJldHVyblR5cGU8dHlwZW9mIG1lZGlhcGxleC5wcm9iZVN0cmVhbT4+O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrSW5mby5kdXJhdGlvbiA9IHJlc3VsdC5kdXJhdGlvbiAqIDEwMDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gbWVkaWFwbGV4LnJlYWRNZXRhZGF0YShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhLmF1dGhvcikgdHJhY2tJbmZvLmF1dGhvciA9IG1ldGFkYXRhLmF1dGhvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS50aXRsZSkgdHJhY2tJbmZvLnRpdGxlID0gbWV0YWRhdGEudGl0bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrSW5mby5kZXNjcmlwdGlvbiA9IGAke3RyYWNrSW5mby50aXRsZX0gYnkgJHt0cmFja0luZm8uYXV0aG9yfWA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzdHJlYW0uZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRyYWNrSW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0cmFja0luZm8udXJsLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyh0cmFja0luZm8uZHVyYXRpb24pKSxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRyYWNrSW5mby5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiB0cmFja0luZm8udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB0cmFja0luZm8uYXV0aG9yLFxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXJiaXRyYXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgZW5naW5lOiB0cmFja0luZm8udXJsLFxuICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IGNvbnRleHQudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHRyYWNrSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMgcmVxdWVzdE1ldGFkYXRhKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrSW5mbztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRyYWNrLnJhdy5pc0ZpbGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW3RyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eVJlc3BvbnNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZW1wdHlSZXNwb25zZSgpOiBFeHRyYWN0b3JJbmZvIHtcbiAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc3RyZWFtKGluZm86IFRyYWNrKSB7XG4gICAgICAgIGNvbnN0IGVuZ2luZSA9IGluZm8ucmF3LmVuZ2luZSBhcyBzdHJpbmc7XG5cbiAgICAgICAgY29uc3QgaXNGaWxlID0gaW5mby5yYXcuaXNGaWxlIGFzIGJvb2xlYW47XG5cbiAgICAgICAgaWYgKCFlbmdpbmUpIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgc3RyZWFtIHNvdXJjZScpO1xuXG4gICAgICAgIGlmICghaXNGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gZW5naW5lO1xuICAgICAgICAgICAgLy8gcmV0dXJuIGF3YWl0IGRvd25sb2FkU3RyZWFtKGVuZ2luZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY3JlYXRlUmVhZFN0cmVhbShlbmdpbmUpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgaHR0cCwgeyBSZXF1ZXN0T3B0aW9ucyB9IGZyb20gJ2h0dHAnO1xuaW1wb3J0IGh0dHBzIGZyb20gJ2h0dHBzJztcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcblxuZXhwb3J0IGZ1bmN0aW9uIGRvd25sb2FkU3RyZWFtKHVybDogc3RyaW5nLCBvcHRzOiBSZXF1ZXN0T3B0aW9ucyA9IHt9KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFJlYWRhYmxlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IGxpYiA9IHVybC5zdGFydHNXaXRoKCdodHRwOi8vJykgPyBodHRwIDogaHR0cHM7XG5cbiAgICAgICAgbGliLmdldCh1cmwsIG9wdHMsIChyZXMpID0+IHJlc29sdmUocmVzKSkub25jZSgnZXJyb3InLCByZWplY3QpO1xuICAgIH0pO1xufVxuIiwgImltcG9ydCB7IEV4dHJhY3RvckluZm8sIEV4dHJhY3RvclNlYXJjaENvbnRleHQsIEV4dHJhY3RvclN0cmVhbWFibGUsIEd1aWxkUXVldWVIaXN0b3J5LCBQbGF5bGlzdCwgUXVlcnlUeXBlLCBTZWFyY2hRdWVyeVR5cGUsIFRyYWNrLCBVdGlsIH0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHsgQXBwbGVNdXNpYyB9IGZyb20gJy4uL2ludGVybmFsJztcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJztcbmltcG9ydCB7IFN0cmVhbUZOLCBwdWxsWVRNZXRhZGF0YSB9IGZyb20gJy4vY29tbW9uL2hlbHBlcic7XG5pbXBvcnQgeyBCcmlkZ2VQcm92aWRlciB9IGZyb20gJy4vY29tbW9uL0JyaWRnZVByb3ZpZGVyJztcbmltcG9ydCB7IEJyaWRnZWRFeHRyYWN0b3IgfSBmcm9tICcuL0JyaWRnZWRFeHRyYWN0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFwcGxlTXVzaWNFeHRyYWN0b3JJbml0IHtcbiAgICBjcmVhdGVTdHJlYW0/OiAoZXh0OiBBcHBsZU11c2ljRXh0cmFjdG9yLCB1cmw6IHN0cmluZykgPT4gUHJvbWlzZTxSZWFkYWJsZSB8IHN0cmluZz47XG4gICAgYnJpZGdlUHJvdmlkZXI/OiBCcmlkZ2VQcm92aWRlcjtcbn1cblxuZXhwb3J0IGNsYXNzIEFwcGxlTXVzaWNFeHRyYWN0b3IgZXh0ZW5kcyBCcmlkZ2VkRXh0cmFjdG9yPEFwcGxlTXVzaWNFeHRyYWN0b3JJbml0PiB7XG4gICAgcHVibGljIHN0YXRpYyBpZGVudGlmaWVyID0gJ2NvbS5kaXNjb3JkLXBsYXllci5hcHBsZW11c2ljZXh0cmFjdG9yJyBhcyBjb25zdDtcbiAgICBwcml2YXRlIF9zdHJlYW0hOiBTdHJlYW1GTjtcblxuICAgIHB1YmxpYyBhc3luYyBhY3RpdmF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5wcm90b2NvbHMgPSBbJ2Ftc2VhcmNoJywgJ2FwcGxlbXVzaWMnXTtcbiAgICAgICAgY29uc3QgZm4gPSB0aGlzLm9wdGlvbnMuY3JlYXRlU3RyZWFtO1xuXG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0cmVhbSA9IChxOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4odGhpcywgcSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGRlYWN0aXZhdGUoKSB7XG4gICAgICAgIHRoaXMucHJvdG9jb2xzID0gW107XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICByZXR1cm4gKDxTZWFyY2hRdWVyeVR5cGVbXT5bXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfQUxCVU0sXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfUExBWUxJU1QsXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfU09ORyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TRUFSQ0gsXG4gICAgICAgICAgICBRdWVyeVR5cGUuQVVUTyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPX1NFQVJDSFxuICAgICAgICBdKS5zb21lKCh0KSA9PiB0ID09PSB0eXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0UmVsYXRlZFRyYWNrcyh0cmFjazogVHJhY2ssIGhpc3Rvcnk6IEd1aWxkUXVldWVIaXN0b3J5KSB7XG4gICAgICAgIGlmICh0cmFjay5xdWVyeVR5cGUgPT09IFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TT05HKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5oYW5kbGUodHJhY2suYXV0aG9yIHx8IHRyYWNrLnRpdGxlLCB7XG4gICAgICAgICAgICAgICAgdHlwZTogUXVlcnlUeXBlLkFQUExFX01VU0lDX1NFQVJDSCxcbiAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCB1bmlxdWUgPSBkYXRhLnRyYWNrcy5maWx0ZXIoKHQpID0+ICFoaXN0b3J5LnRyYWNrcy5zb21lKChoKSA9PiBoLnVybCA9PT0gdC51cmwpKTtcbiAgICAgICAgICAgIHJldHVybiB1bmlxdWUubGVuZ3RoID4gMCA/IHRoaXMuY3JlYXRlUmVzcG9uc2UobnVsbCwgdW5pcXVlKSA6IHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIGlmIChjb250ZXh0LnByb3RvY29sID09PSAnYW1zZWFyY2gnKSBjb250ZXh0LnR5cGUgPSBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfU0VBUkNIO1xuXG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BVVRPOlxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVVUT19TRUFSQ0g6XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19TRUFSQ0g6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgQXBwbGVNdXNpYy5zZWFyY2gocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhY2tzID0gZGF0YS5tYXAoXG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgIChtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYWNrOiBUcmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBtLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB0eXBlb2YgbS5kdXJhdGlvbiA9PT0gJ251bWJlcicgPyBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKG0uZHVyYXRpb24pKSA6IG0uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBtLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG0udXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FwcGxlX211c2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6ICdhcHBsZU11c2ljU29uZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlkZ2U6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIgPyAoYXdhaXQgdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyLnJlc29sdmUodGhpcywgdHJhY2spKS5kYXRhIDogYXdhaXQgcHVsbFlUTWV0YWRhdGEodGhpcywgdHJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFjaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZShudWxsLCB0cmFja3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfQUxCVU06IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgQXBwbGVNdXNpYy5nZXRBbGJ1bUluZm8ocXVlcnkpO1xuICAgICAgICAgICAgICAgIGlmICghaW5mbykgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpbmZvLmFydGlzdC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZm8uaWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FwcGxlX211c2ljJyxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBpbmZvLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGluZm8udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhbGJ1bScsXG4gICAgICAgICAgICAgICAgICAgIHVybDogaW5mby51cmwsXG4gICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBpbmZvXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSBpbmZvLnRyYWNrcy5tYXAoXG4gICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgIG06IGFueSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgICkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2s6IFRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IG0uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHR5cGVvZiBtLmR1cmF0aW9uID09PSAnbnVtYmVyJyA/IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMobS5kdXJhdGlvbikpIDogbS5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IG0udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbS51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXBwbGVfbXVzaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ2FwcGxlTXVzaWNTb25nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE1ldGFkYXRhOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlkZ2U6IChhd2FpdCB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXI/LnJlc29sdmUodGhpcywgdHJhY2spKT8uZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2sucGxheWxpc3QgPSBwbGF5bGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2s7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BUFBMRV9NVVNJQ19QTEFZTElTVDoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBBcHBsZU11c2ljLmdldFBsYXlsaXN0SW5mbyhxdWVyeSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpbmZvKSByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcGxheWxpc3QgPSBuZXcgUGxheWxpc3QodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGluZm8uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBpZDogaW5mby5pZCxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnYXBwbGVfbXVzaWMnLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGluZm8udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYXlsaXN0JyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBpbmZvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgcmF3UGxheWxpc3Q6IGluZm9cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHBsYXlsaXN0LnRyYWNrcyA9IGluZm8udHJhY2tzLm1hcChcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbTogYW55IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAgICAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmFjazogVHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogbS5hcnRpc3QubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdHlwZW9mIG0uZHVyYXRpb24gPT09ICdudW1iZXInID8gVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhtLmR1cmF0aW9uKSkgOiBtLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogbS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBtLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdhcHBsZV9tdXNpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnYXBwbGVNdXNpY1NvbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWV0YWRhdGE6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyID8gKGF3YWl0IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlci5yZXNvbHZlKHRoaXMsIHRyYWNrKSkuZGF0YSA6IGF3YWl0IHB1bGxZVE1ldGFkYXRhKHRoaXMsIHRyYWNrKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFjay5wbGF5bGlzdCA9IHBsYXlsaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYWNrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0LCB0cmFja3M6IHBsYXlsaXN0LnRyYWNrcyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVBQTEVfTVVTSUNfU09ORzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZm8gPSBhd2FpdCBBcHBsZU11c2ljLmdldFNvbmdJbmZvKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICBpZiAoIWluZm8pIHJldHVybiB0aGlzLmNyZWF0ZVJlc3BvbnNlKCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0cmFjazogVHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICBhdXRob3I6IGluZm8uYXJ0aXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpbmZvLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdHlwZW9mIGluZm8uZHVyYXRpb24gPT09ICdudW1iZXInID8gVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhpbmZvLmR1cmF0aW9uKSkgOiBpbmZvLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGluZm8udGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogaW5mby50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBpbmZvLnVybCxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ2FwcGxlX211c2ljJyxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogY29udGV4dC50eXBlLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBpbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGluZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIgPyAoYXdhaXQgdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyLnJlc29sdmUodGhpcywgdHJhY2spKS5kYXRhIDogYXdhaXQgcHVsbFlUTWV0YWRhdGEodGhpcywgdHJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0cmFjay5leHRyYWN0b3IgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW3RyYWNrXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHN0cmVhbShpbmZvOiBUcmFjayk6IFByb21pc2U8RXh0cmFjdG9yU3RyZWFtYWJsZT4ge1xuICAgICAgICBpZiAodGhpcy5fc3RyZWFtKSB7XG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSBhd2FpdCB0aGlzLl9zdHJlYW0oaW5mby51cmwsIHRoaXMpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdHJlYW0gPT09ICdzdHJpbmcnKSByZXR1cm4gc3RyZWFtO1xuICAgICAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGxlZ2FjeVxuICAgICAgICBpZiAoISgncmVxdWVzdEJyaWRnZScgaW4gdGhpcy5jb250ZXh0KSkge1xuICAgICAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmJyaWRnZVByb3ZpZGVyO1xuICAgICAgICAgICAgaWYgKCFwcm92aWRlcikgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBicmlkZ2UgcHJvdmlkZXIgZm9yICcke3RoaXMuY29uc3RydWN0b3IubmFtZX0nYCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwcm92aWRlci5yZXNvbHZlKHRoaXMsIGluZm8pO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBicmlkZ2UgdGhpcyB0cmFjaycpO1xuXG4gICAgICAgICAgICBpbmZvLnNldE1ldGFkYXRhKHtcbiAgICAgICAgICAgICAgICAuLi4oaW5mby5tZXRhZGF0YSB8fCB7fSksXG4gICAgICAgICAgICAgICAgYnJpZGdlOiBkYXRhLmRhdGFcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgcHJvdmlkZXIuc3RyZWFtKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbmV3IGFwaVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNvbnRleHQucmVxdWVzdEJyaWRnZShpbmZvLCB0aGlzKTtcblxuICAgICAgICBpZiAoIXJlc3VsdD8ucmVzdWx0KSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBicmlkZ2UgdGhpcyB0cmFjaycpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0O1xuICAgIH1cbn1cbiIsICJleHBvcnQgKiBmcm9tICcuL0FwcGxlTXVzaWMnO1xuZXhwb3J0ICogZnJvbSAnLi9WaW1lbyc7XG5leHBvcnQgKiBmcm9tICcuL2Rvd25sb2FkZXInO1xuZXhwb3J0ICogZnJvbSAnLi9TcG90aWZ5JztcbiIsICIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5pbXBvcnQgeyBRdWVyeVJlc29sdmVyIH0gZnJvbSAnZGlzY29yZC1wbGF5ZXInO1xuaW1wb3J0IHsgcGFyc2UsIEhUTUxFbGVtZW50IH0gZnJvbSAnbm9kZS1odG1sLXBhcnNlcic7XG5pbXBvcnQgeyBVQSwgZmV0Y2ggfSBmcm9tICcuLi9leHRyYWN0b3JzL2NvbW1vbi9oZWxwZXInO1xuXG5mdW5jdGlvbiBnZXRIVE1MKGxpbms6IHN0cmluZyk6IFByb21pc2U8SFRNTEVsZW1lbnQgfCBudWxsPiB7XG4gICAgcmV0dXJuIGZldGNoKGxpbmssIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiBVQVxuICAgICAgICB9XG4gICAgfSlcbiAgICAgICAgLnRoZW4oKHIpID0+IHIudGV4dCgpKVxuICAgICAgICAudGhlbihcbiAgICAgICAgICAgICh0eHQpID0+IHBhcnNlKHR4dCksXG4gICAgICAgICAgICAoKSA9PiBudWxsXG4gICAgICAgICk7XG59XG5cbmZ1bmN0aW9uIG1ha2VJbWFnZSh7IGhlaWdodCwgdXJsLCB3aWR0aCwgZXh0ID0gJ2pwZycgfTogeyB1cmw6IHN0cmluZzsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXI7IGV4dD86IHN0cmluZyB9KSB7XG4gICAgcmV0dXJuIHVybC5yZXBsYWNlKCd7d30nLCBgJHt3aWR0aH1gKS5yZXBsYWNlKCd7aH0nLCBgJHtoZWlnaHR9YCkucmVwbGFjZSgne2Z9JywgZXh0KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VEdXJhdGlvbihkOiBzdHJpbmcpIHtcbiAgICBjb25zdCByID0gKG5hbWU6IHN0cmluZywgdW5pdDogc3RyaW5nKSA9PiBgKCg/PCR7bmFtZX0+LT9cXFxcZCpbXFxcXC4sXT9cXFxcZCspJHt1bml0fSk/YDtcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoXG4gICAgICAgIFtcbiAgICAgICAgICAgICcoPzxuZWdhdGl2ZT4tKT9QJyxcbiAgICAgICAgICAgIHIoJ3llYXJzJywgJ1knKSxcbiAgICAgICAgICAgIHIoJ21vbnRocycsICdNJyksXG4gICAgICAgICAgICByKCd3ZWVrcycsICdXJyksXG4gICAgICAgICAgICByKCdkYXlzJywgJ0QnKSxcbiAgICAgICAgICAgICcoVCcsXG4gICAgICAgICAgICByKCdob3VycycsICdIJyksXG4gICAgICAgICAgICByKCdtaW51dGVzJywgJ00nKSxcbiAgICAgICAgICAgIHIoJ3NlY29uZHMnLCAnUycpLFxuICAgICAgICAgICAgJyk/JyAvLyBlbmQgb3B0aW9uYWwgdGltZVxuICAgICAgICBdLmpvaW4oJycpXG4gICAgKTtcbiAgICBjb25zdCB0ZXN0ID0gcmVnZXguZXhlYyhkKTtcbiAgICBpZiAoIXRlc3QgfHwgIXRlc3QuZ3JvdXBzKSByZXR1cm4gJzA6MDAnO1xuXG4gICAgY29uc3QgZHVyID0gW3Rlc3QuZ3JvdXBzLnllYXJzLCB0ZXN0Lmdyb3Vwcy5tb250aHMsIHRlc3QuZ3JvdXBzLndlZWtzLCB0ZXN0Lmdyb3Vwcy5kYXlzLCB0ZXN0Lmdyb3Vwcy5ob3VycywgdGVzdC5ncm91cHMubWludXRlcywgdGVzdC5ncm91cHMuc2Vjb25kc107XG5cbiAgICByZXR1cm4gKFxuICAgICAgICBkdXJcbiAgICAgICAgICAgIC5maWx0ZXIoKHIsIGksIGEpID0+ICEhciB8fCBpID4gYS5sZW5ndGggLSAyKVxuICAgICAgICAgICAgLm1hcCgobSwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghbSkgbSA9ICcwJztcbiAgICAgICAgICAgICAgICByZXR1cm4gaSA8IDEgPyBtIDogbS5wYWRTdGFydCgyLCAnMCcpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKCc6JykgfHwgJzA6MDAnXG4gICAgKTtcbn1cblxuZXhwb3J0IGNsYXNzIEFwcGxlTXVzaWMge1xuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuIEFwcGxlTXVzaWM7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBzZWFyY2gocXVlcnk6IHN0cmluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vbXVzaWMuYXBwbGUuY29tL3VzL3NlYXJjaD90ZXJtPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX1gO1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGF3YWl0IGdldEhUTUwodXJsKTtcbiAgICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuIFtdO1xuXG4gICAgICAgICAgICBjb25zdCByYXdEYXRhID0gbm9kZS5nZXRFbGVtZW50QnlJZCgnc2VyaWFsaXplZC1zZXJ2ZXItZGF0YScpO1xuICAgICAgICAgICAgaWYgKCFyYXdEYXRhKSByZXR1cm4gW107XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJhd0RhdGEuaW5uZXJUZXh0KVswXS5kYXRhLnNlY3Rpb25zO1xuICAgICAgICAgICAgY29uc3QgdHJhY2tzID0gZGF0YS5maW5kKChzOiBhbnkpID0+IHMuaXRlbUtpbmQgPT09ICd0cmFja0xvY2t1cCcpPy5pdGVtcztcbiAgICAgICAgICAgIGlmICghdHJhY2tzKSByZXR1cm4gW107XG5cbiAgICAgICAgICAgIHJldHVybiB0cmFja3MubWFwKCh0cmFjazogYW55KSA9PiAoe1xuICAgICAgICAgICAgICAgIGlkOiB0cmFjay5jb250ZW50RGVzY3JpcHRvci5pZGVudGlmaWVycy5zdG9yZUFkYW1JRCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogdHJhY2suZHVyYXRpb24gfHwgJzA6MDAnLFxuICAgICAgICAgICAgICAgIHRpdGxlOiB0cmFjay50aXRsZSxcbiAgICAgICAgICAgICAgICB1cmw6IHRyYWNrLmNvbnRlbnREZXNjcmlwdG9yLnVybCxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHRyYWNrPy5hcnR3b3JrPy5kaWN0aW9uYXJ5XG4gICAgICAgICAgICAgICAgICAgID8gbWFrZUltYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB0cmFjay5hcnR3b3JrLmRpY3Rpb25hcnkudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHRyYWNrLmFydHdvcmsuZGljdGlvbmFyeS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0cmFjay5hcnR3b3JrLmRpY3Rpb25hcnkud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICA6ICdodHRwczovL211c2ljLmFwcGxlLmNvbS9hc3NldHMvZmF2aWNvbi9mYXZpY29uLTE4MC5wbmcnLFxuICAgICAgICAgICAgICAgIGFydGlzdDoge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cmFjay5zdWJ0aXRsZUxpbmtzPy5bMF0/LnRpdGxlID8/ICdVbmtub3duIEFydGlzdCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRTb25nSW5mb0ZhbGxiYWNrKHJlczogSFRNTEVsZW1lbnQsIG5hbWU6IHN0cmluZywgaWQ6IHN0cmluZywgbGluazogc3RyaW5nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtZXRhVGFncyA9IHJlcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWV0YScpO1xuICAgICAgICAgICAgaWYgKCFtZXRhVGFncy5sZW5ndGgpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCB0aXRsZSA9IG1ldGFUYWdzLmZpbmQoKHIpID0+IHIuZ2V0QXR0cmlidXRlKCduYW1lJykgPT09ICdhcHBsZTp0aXRsZScpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKSB8fCByZXMucXVlcnlTZWxlY3RvcigndGl0bGUnKT8uaW5uZXJUZXh0IHx8IG5hbWU7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50SWQgPSBtZXRhVGFncy5maW5kKChyKSA9PiByLmdldEF0dHJpYnV0ZSgnbmFtZScpID09PSAnYXBwbGU6Y29udGVudF9pZCcpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKSB8fCBpZDtcbiAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uUmF3ID0gbWV0YVRhZ3MuZmluZCgocikgPT4gci5nZXRBdHRyaWJ1dGUoJ3Byb3BlcnR5JykgPT09ICdtdXNpYzpzb25nOmR1cmF0aW9uJyk/LmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xuXG4gICAgICAgICAgICBjb25zdCBzb25nID0ge1xuICAgICAgICAgICAgICAgIGlkOiBjb250ZW50SWQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uUmF3XG4gICAgICAgICAgICAgICAgICAgID8gcGFyc2VEdXJhdGlvbihkdXJhdGlvblJhdylcbiAgICAgICAgICAgICAgICAgICAgOiBtZXRhVGFnc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgobSkgPT4gbS5nZXRBdHRyaWJ1dGUoJ25hbWUnKSA9PT0gJ2FwcGxlOmRlc2NyaXB0aW9uJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPy50ZXh0Q29udGVudC5zcGxpdCgnRHVyYXRpb246ICcpPy5bMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCdcIicpPy5bMF0gfHwgJzA6MDAnLFxuICAgICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICAgIHVybDogbGluayxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6XG4gICAgICAgICAgICAgICAgICAgIG1ldGFUYWdzLmZpbmQoKHIpID0+IFsnb2c6aW1hZ2U6c2VjdXJlX3VybCcsICdvZzppbWFnZSddLmluY2x1ZGVzKHIuZ2V0QXR0cmlidXRlKCdwcm9wZXJ0eScpISkpPy5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKSB8fFxuICAgICAgICAgICAgICAgICAgICAnaHR0cHM6Ly9tdXNpYy5hcHBsZS5jb20vYXNzZXRzL2Zhdmljb24vZmF2aWNvbi0xODAucG5nJyxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmVzLnF1ZXJ5U2VsZWN0b3IoJy5zb25nLXN1YnRpdGxlc19fYXJ0aXN0cz5hJyk/LnRleHRDb250ZW50Py50cmltKCkgfHwgJ0FwcGxlIE11c2ljJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBzb25nO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRTb25nSW5mbyhsaW5rOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCFRdWVyeVJlc29sdmVyLnJlZ2V4LmFwcGxlTXVzaWNTb25nUmVnZXgudGVzdChsaW5rKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGxpbmspO1xuICAgICAgICBjb25zdCBpZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdpJyk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB1cmwucGF0aG5hbWUuc3BsaXQoJ2FsYnVtLycpWzFdPy5zcGxpdCgnLycpWzBdO1xuXG4gICAgICAgIGlmICghaWQgfHwgIW5hbWUpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEhUTUwoYGh0dHBzOi8vbXVzaWMuYXBwbGUuY29tL3VzL3NvbmcvJHtuYW1lfS8ke2lkfWApO1xuICAgICAgICBpZiAoIXJlcykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFzcmMgPVxuICAgICAgICAgICAgICAgIHJlcy5nZXRFbGVtZW50QnlJZCgnc2VyaWFsaXplZC1zZXJ2ZXItZGF0YScpPy5pbm5lclRleHQgfHwgcmVzLmlubmVyVGV4dC5zcGxpdCgnPHNjcmlwdCB0eXBlPVwiYXBwbGljYXRpb24vanNvblwiIGlkPVwic2VyaWFsaXplZC1zZXJ2ZXItZGF0YVwiPicpPy5bMV0/LnNwbGl0KCc8L3NjcmlwdD4nKT8uWzBdO1xuICAgICAgICAgICAgaWYgKCFkYXRhc3JjKSB0aHJvdyAnbm90IGZvdW5kJztcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGRhdGFzcmMpWzBdLmRhdGEuc2VvRGF0YTtcbiAgICAgICAgICAgIGNvbnN0IHNvbmcgPSBkYXRhLm9nU29uZ3NbMF0/LmF0dHJpYnV0ZXM7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaWQ6IGRhdGEub2dTb25nc1swXT8uaWQgfHwgZGF0YS5hcHBsZUNvbnRlbnRJZCB8fCBpZCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogc29uZz8uZHVyYXRpb25Jbk1pbGxpcyB8fCAnMDowMCcsXG4gICAgICAgICAgICAgICAgdGl0bGU6IHNvbmc/Lm5hbWUgfHwgZGF0YS5hcHBsZVRpdGxlLFxuICAgICAgICAgICAgICAgIHVybDogc29uZz8udXJsIHx8IGRhdGEudXJsIHx8IGxpbmssXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzb25nPy5hcnR3b3JrXG4gICAgICAgICAgICAgICAgICAgID8gbWFrZUltYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nLmFydHdvcmsudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHNvbmcuYXJ0d29yay5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzb25nLmFydHdvcmsud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICA6IGRhdGEuYXJ0d29ya1VybFxuICAgICAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogZGF0YS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBkYXRhLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGRhdGEuYXJ0d29ya1VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0OiBkYXRhLmZpbGVUeXBlIHx8ICdqcGcnXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgOiAnaHR0cHM6Ly9tdXNpYy5hcHBsZS5jb20vYXNzZXRzL2Zhdmljb24vZmF2aWNvbi0xODAucG5nJyxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc29uZz8uYXJ0aXN0TmFtZSB8fCBkYXRhLnNvY2lhbFRpdGxlIHx8ICdBcHBsZSBNdXNpYydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNvbmdJbmZvRmFsbGJhY2socmVzLCBuYW1lLCBpZCwgbGluayk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldFBsYXlsaXN0SW5mbyhsaW5rOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCFRdWVyeVJlc29sdmVyLnJlZ2V4LmFwcGxlTXVzaWNQbGF5bGlzdFJlZ2V4LnRlc3QobGluaykpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0SFRNTChsaW5rKTtcbiAgICAgICAgaWYgKCFyZXMpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhc3JjID1cbiAgICAgICAgICAgICAgICByZXMuZ2V0RWxlbWVudEJ5SWQoJ3NlcmlhbGl6ZWQtc2VydmVyLWRhdGEnKT8uaW5uZXJUZXh0IHx8IHJlcy5pbm5lclRleHQuc3BsaXQoJzxzY3JpcHQgdHlwZT1cImFwcGxpY2F0aW9uL2pzb25cIiBpZD1cInNlcmlhbGl6ZWQtc2VydmVyLWRhdGFcIj4nKT8uWzFdPy5zcGxpdCgnPC9zY3JpcHQ+Jyk/LlswXTtcbiAgICAgICAgICAgIGlmICghZGF0YXNyYykgdGhyb3cgJ25vdCBmb3VuZCc7XG4gICAgICAgICAgICBjb25zdCBwbCA9IEpTT04ucGFyc2UoZGF0YXNyYylbMF0uZGF0YS5zZW9EYXRhO1xuICAgICAgICAgICAgY29uc3QgdGh1bWJuYWlsID0gcGwuYXJ0d29ya1VybFxuICAgICAgICAgICAgICAgID8gbWFrZUltYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHBsLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGwud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgdXJsOiBwbC5hcnR3b3JrVXJsLFxuICAgICAgICAgICAgICAgICAgICAgIGV4dDogcGwuZmlsZVR5cGUgfHwgJ2pwZydcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgOiAnaHR0cHM6Ly9tdXNpYy5hcHBsZS5jb20vYXNzZXRzL2Zhdmljb24vZmF2aWNvbi0xODAucG5nJztcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaWQ6IHBsLmFwcGxlQ29udGVudElkLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBwbC5hcHBsZVRpdGxlLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogcGwub2dTb25ncz8uWzBdPy5hdHRyaWJ1dGVzPy5hcnRpc3ROYW1lIHx8ICdBcHBsZSBNdXNpYydcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHVybDogcGwudXJsLFxuICAgICAgICAgICAgICAgIHRyYWNrczpcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgICAgICAgICAgICAgIHBsLm9nU29uZ3M/Lm1hcCgobTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzb25nID0gbS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogc29uZy5kdXJhdGlvbkluTWlsbGlzIHx8ICcwOjAwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc29uZy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc29uZy51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzb25nLmFydHdvcmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBtYWtlSW1hZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNvbmcuYXJ0d29yay51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogc29uZy5hcnR3b3JrLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNvbmcuYXJ0d29yay53aWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGh1bWJuYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFydGlzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzb25nLmFydGlzdE5hbWUgfHwgJ0FwcGxlIE11c2ljJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pIHx8IFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRBbGJ1bUluZm8obGluazogc3RyaW5nKSB7XG4gICAgICAgIGlmICghUXVlcnlSZXNvbHZlci5yZWdleC5hcHBsZU11c2ljQWxidW1SZWdleC50ZXN0KGxpbmspKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEhUTUwobGluayk7XG4gICAgICAgIGlmICghcmVzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YXNyYyA9XG4gICAgICAgICAgICAgICAgcmVzLmdldEVsZW1lbnRCeUlkKCdzZXJpYWxpemVkLXNlcnZlci1kYXRhJyk/LmlubmVyVGV4dCB8fCByZXMuaW5uZXJUZXh0LnNwbGl0KCc8c2NyaXB0IHR5cGU9XCJhcHBsaWNhdGlvbi9qc29uXCIgaWQ9XCJzZXJpYWxpemVkLXNlcnZlci1kYXRhXCI+Jyk/LlsxXT8uc3BsaXQoJzwvc2NyaXB0PicpPy5bMF07XG4gICAgICAgICAgICBpZiAoIWRhdGFzcmMpIHRocm93ICdub3QgZm91bmQnO1xuICAgICAgICAgICAgY29uc3QgcGwgPSBKU09OLnBhcnNlKGRhdGFzcmMpWzBdLmRhdGEuc2VvRGF0YTtcbiAgICAgICAgICAgIGNvbnN0IHRodW1ibmFpbCA9IHBsLmFydHdvcmtVcmxcbiAgICAgICAgICAgICAgICA/IG1ha2VJbWFnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwbC5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBsLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgIHVybDogcGwuYXJ0d29ya1VybCxcbiAgICAgICAgICAgICAgICAgICAgICBleHQ6IHBsLmZpbGVUeXBlIHx8ICdqcGcnXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIDogJ2h0dHBzOi8vbXVzaWMuYXBwbGUuY29tL2Fzc2V0cy9mYXZpY29uL2Zhdmljb24tMTgwLnBuZyc7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiBwbC5hcHBsZUNvbnRlbnRJZCxcbiAgICAgICAgICAgICAgICB0aXRsZTogcGwuYXBwbGVUaXRsZSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHBsLm9nU29uZ3M/LlswXT8uYXR0cmlidXRlcz8uYXJ0aXN0TmFtZSB8fCAnQXBwbGUgTXVzaWMnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cmw6IHBsLnVybCxcbiAgICAgICAgICAgICAgICB0cmFja3M6XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgICAgICAgICBwbC5vZ1NvbmdzPy5tYXAoKG06IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29uZyA9IG0uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHNvbmcuZHVyYXRpb25Jbk1pbGxpcyB8fCAnMDowMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNvbmcubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNvbmcudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc29uZy5hcnR3b3JrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbWFrZUltYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzb25nLmFydHdvcmsudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHNvbmcuYXJ0d29yay5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzb25nLmFydHdvcmsud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRodW1ibmFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc29uZy5hcnRpc3ROYW1lIHx8ICdBcHBsZSBNdXNpYydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KSB8fCBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBmZXRjaCwgVUEgfSBmcm9tICcuLi9leHRyYWN0b3JzJztcblxuY29uc3QgU1BfQU5PTl9UT0tFTl9VUkwgPSAnaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL2dldF9hY2Nlc3NfdG9rZW4/cmVhc29uPXRyYW5zcG9ydCZwcm9kdWN0VHlwZT1lbWJlZCc7XG5jb25zdCBTUF9BQ0NFU1NfVE9LRU5fVVJMID0gJ2h0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXBpL3Rva2VuP2dyYW50X3R5cGU9Y2xpZW50X2NyZWRlbnRpYWxzJztcbmNvbnN0IFNQX0JBU0UgPSAnaHR0cHM6Ly9hcGkuc3BvdGlmeS5jb20vdjEnO1xuXG5pbnRlcmZhY2UgU1BfQUNDRVNTX1RPS0VOIHtcbiAgICB0b2tlbjogc3RyaW5nO1xuICAgIGV4cGlyZXNBZnRlcjogbnVtYmVyO1xuICAgIHR5cGU6ICdCZWFyZXInO1xufVxuXG5leHBvcnQgY2xhc3MgU3BvdGlmeUFQSSB7XG4gICAgcHVibGljIGFjY2Vzc1Rva2VuOiBTUF9BQ0NFU1NfVE9LRU4gfCBudWxsID0gbnVsbDtcblxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGNyZWRlbnRpYWxzOiB7IGNsaWVudElkOiBzdHJpbmcgfCBudWxsOyBjbGllbnRTZWNyZXQ6IHN0cmluZyB8IG51bGwgfSA9IHtcbiAgICAgICAgICAgIGNsaWVudElkOiBudWxsLFxuICAgICAgICAgICAgY2xpZW50U2VjcmV0OiBudWxsXG4gICAgICAgIH1cbiAgICApIHt9XG5cbiAgICBwdWJsaWMgZ2V0IGF1dGhvcml6YXRpb25LZXkoKSB7XG4gICAgICAgIGlmICghdGhpcy5jcmVkZW50aWFscy5jbGllbnRJZCB8fCAhdGhpcy5jcmVkZW50aWFscy5jbGllbnRTZWNyZXQpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gQnVmZmVyLmZyb20oYCR7dGhpcy5jcmVkZW50aWFscy5jbGllbnRJZH06JHt0aGlzLmNyZWRlbnRpYWxzLmNsaWVudFNlY3JldH1gKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlcXVlc3RUb2tlbigpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5hdXRob3JpemF0aW9uS2V5O1xuXG4gICAgICAgIGlmICgha2V5KSByZXR1cm4gYXdhaXQgdGhpcy5yZXF1ZXN0QW5vbnltb3VzVG9rZW4oKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goU1BfQUNDRVNTX1RPS0VOX1VSTCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiBVQSxcbiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7a2V5fWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgIGlmICghYm9keS5hY2Nlc3NfdG9rZW4pIHRocm93ICdubyB0b2tlbic7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdG9rZW46IGJvZHkuYWNjZXNzX3Rva2VuIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICBleHBpcmVzQWZ0ZXI6IGJvZHkuZXhwaXJlc19pbiBhcyBudW1iZXIsXG4gICAgICAgICAgICAgICAgdHlwZTogJ0JlYXJlcicgYXMgY29uc3RcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiAodGhpcy5hY2Nlc3NUb2tlbiA9IGRhdGEpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlcXVlc3RBbm9ueW1vdXNUb2tlbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlcXVlc3RBbm9ueW1vdXNUb2tlbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFNQX0FOT05fVE9LRU5fVVJMLCB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyAnbm90X29rJztcblxuICAgICAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgIGlmICghYm9keS5hY2Nlc3NUb2tlbikgdGhyb3cgJ25vX2FjY2Vzc190b2tlbic7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdG9rZW46IGJvZHkuYWNjZXNzVG9rZW4gYXMgc3RyaW5nLFxuICAgICAgICAgICAgICAgIGV4cGlyZXNBZnRlcjogYm9keS5hY2Nlc3NUb2tlbkV4cGlyYXRpb25UaW1lc3RhbXBNcyBhcyBudW1iZXIsXG4gICAgICAgICAgICAgICAgdHlwZTogJ0JlYXJlcicgYXMgY29uc3RcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiAodGhpcy5hY2Nlc3NUb2tlbiA9IGRhdGEpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGlzVG9rZW5FeHBpcmVkKCkge1xuICAgICAgICBpZiAoIXRoaXMuYWNjZXNzVG9rZW4pIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSA+IHRoaXMuYWNjZXNzVG9rZW4uZXhwaXJlc0FmdGVyO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBzZWFyY2gocXVlcnk6IHN0cmluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gcmVxXG4gICAgICAgICAgICBpZiAodGhpcy5pc1Rva2VuRXhwaXJlZCgpKSBhd2FpdCB0aGlzLnJlcXVlc3RUb2tlbigpO1xuICAgICAgICAgICAgLy8gZmFpbGVkXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWNjZXNzVG9rZW4pIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtTUF9CQVNFfS9zZWFyY2gvP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfSZ0eXBlPXRyYWNrJm1hcmtldD1VU2AsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogVUEsXG4gICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGAke3RoaXMuYWNjZXNzVG9rZW4udHlwZX0gJHt0aGlzLmFjY2Vzc1Rva2VuLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXMub2spIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhOiB7IHRyYWNrczogeyBpdGVtczogU3BvdGlmeVRyYWNrW10gfSB9ID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgICAgICAgICAgcmV0dXJuIGRhdGEudHJhY2tzLml0ZW1zLm1hcCgobSkgPT4gKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogbS5uYW1lLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBtLmR1cmF0aW9uX21zLFxuICAgICAgICAgICAgICAgIGFydGlzdDogbS5hcnRpc3RzLm1hcCgobSkgPT4gbS5uYW1lKS5qb2luKCcsICcpLFxuICAgICAgICAgICAgICAgIHVybDogbS5leHRlcm5hbF91cmxzPy5zcG90aWZ5IHx8IGBodHRwczovL29wZW4uc3BvdGlmeS5jb20vdHJhY2svJHttLmlkfWAsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBtLmFsYnVtLmltYWdlcz8uWzBdPy51cmwgfHwgbnVsbFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGdldFBsYXlsaXN0KGlkOiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIHJlcVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNUb2tlbkV4cGlyZWQoKSkgYXdhaXQgdGhpcy5yZXF1ZXN0VG9rZW4oKTtcbiAgICAgICAgICAgIC8vIGZhaWxlZFxuICAgICAgICAgICAgaWYgKCF0aGlzLmFjY2Vzc1Rva2VuKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7U1BfQkFTRX0vcGxheWxpc3RzLyR7aWR9P21hcmtldD1VU2AsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogVUEsXG4gICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGAke3RoaXMuYWNjZXNzVG9rZW4udHlwZX0gJHt0aGlzLmFjY2Vzc1Rva2VuLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgZGF0YToge1xuICAgICAgICAgICAgICAgIGV4dGVybmFsX3VybHM6IHsgc3BvdGlmeTogc3RyaW5nIH07XG4gICAgICAgICAgICAgICAgb3duZXI6IHsgZGlzcGxheV9uYW1lOiBzdHJpbmcgfTtcbiAgICAgICAgICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgICAgICAgICBpbWFnZXM6IHsgdXJsOiBzdHJpbmcgfVtdO1xuICAgICAgICAgICAgICAgIHRyYWNrczoge1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogeyB0cmFjazogU3BvdGlmeVRyYWNrIH1bXTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dD86IHN0cmluZztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICAgICAgICAgIGlmICghZGF0YS50cmFja3MuaXRlbXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgdDogeyB0cmFjazogU3BvdGlmeVRyYWNrIH1bXSA9IGRhdGEudHJhY2tzLml0ZW1zO1xuXG4gICAgICAgICAgICBsZXQgbmV4dDogc3RyaW5nIHwgdW5kZWZpbmVkID0gZGF0YS50cmFja3MubmV4dDtcblxuICAgICAgICAgICAgd2hpbGUgKHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKG5leHQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGAke3RoaXMuYWNjZXNzVG9rZW4udHlwZX0gJHt0aGlzLmFjY2Vzc1Rva2VuLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMub2spIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0UGFnZTogeyBpdGVtczogeyB0cmFjazogU3BvdGlmeVRyYWNrIH1bXTsgbmV4dD86IHN0cmluZyB9ID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgICAgICAgICAgICAgICAgICB0LnB1c2goLi4ubmV4dFBhZ2UuaXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gbmV4dFBhZ2UubmV4dDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5leHQpIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHRyYWNrcyA9IHQubWFwKCh7IHRyYWNrOiBtIH0pID0+ICh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IG0ubmFtZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogbS5kdXJhdGlvbl9tcyxcbiAgICAgICAgICAgICAgICBhcnRpc3Q6IG0uYXJ0aXN0cy5tYXAoKG0pID0+IG0ubmFtZSkuam9pbignLCAnKSxcbiAgICAgICAgICAgICAgICB1cmw6IG0uZXh0ZXJuYWxfdXJscz8uc3BvdGlmeSB8fCBgaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3RyYWNrLyR7bS5pZH1gLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbDogbS5hbGJ1bS5pbWFnZXM/LlswXT8udXJsIHx8IG51bGxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgaWYgKCF0cmFja3MubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgIGF1dGhvcjogZGF0YS5vd25lci5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLmltYWdlcz8uWzBdPy51cmwgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBpZDogZGF0YS5pZCxcbiAgICAgICAgICAgICAgICB1cmw6IGRhdGEuZXh0ZXJuYWxfdXJscy5zcG90aWZ5IHx8IGBodHRwczovL29wZW4uc3BvdGlmeS5jb20vcGxheWxpc3QvJHtpZH1gLFxuICAgICAgICAgICAgICAgIHRyYWNrc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRBbGJ1bShpZDogc3RyaW5nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyByZXFcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVG9rZW5FeHBpcmVkKCkpIGF3YWl0IHRoaXMucmVxdWVzdFRva2VuKCk7XG4gICAgICAgICAgICAvLyBmYWlsZWRcbiAgICAgICAgICAgIGlmICghdGhpcy5hY2Nlc3NUb2tlbikgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke1NQX0JBU0V9L2FsYnVtcy8ke2lkfT9tYXJrZXQ9VVNgLCB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6IFVBLFxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgJHt0aGlzLmFjY2Vzc1Rva2VuLnR5cGV9ICR7dGhpcy5hY2Nlc3NUb2tlbi50b2tlbn1gLFxuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXJlcy5vaykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IHtcbiAgICAgICAgICAgICAgICBleHRlcm5hbF91cmxzOiB7IHNwb3RpZnk6IHN0cmluZyB9O1xuICAgICAgICAgICAgICAgIGFydGlzdHM6IHsgbmFtZTogc3RyaW5nIH1bXTtcbiAgICAgICAgICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICAgICAgICAgIG5hbWU6IHN0cmluZztcbiAgICAgICAgICAgICAgICBpbWFnZXM6IHsgdXJsOiBzdHJpbmcgfVtdO1xuICAgICAgICAgICAgICAgIHRyYWNrczoge1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogU3BvdGlmeVRyYWNrW107XG4gICAgICAgICAgICAgICAgICAgIG5leHQ/OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gPSBhd2FpdCByZXMuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoIWRhdGEudHJhY2tzLml0ZW1zLmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IHQ6IFNwb3RpZnlUcmFja1tdID0gZGF0YS50cmFja3MuaXRlbXM7XG5cbiAgICAgICAgICAgIGxldCBuZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQgPSBkYXRhLnRyYWNrcy5uZXh0O1xuXG4gICAgICAgICAgICB3aGlsZSAodHlwZW9mIG5leHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2gobmV4dCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogVUEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYCR7dGhpcy5hY2Nlc3NUb2tlbi50eXBlfSAke3RoaXMuYWNjZXNzVG9rZW4udG9rZW59YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcy5vaykgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRQYWdlOiB7IGl0ZW1zOiBTcG90aWZ5VHJhY2tbXTsgbmV4dD86IHN0cmluZyB9ID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgICAgICAgICAgICAgICAgICB0LnB1c2goLi4ubmV4dFBhZ2UuaXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gbmV4dFBhZ2UubmV4dDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5leHQpIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHRyYWNrcyA9IHQubWFwKChtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBtLm5hbWUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IG0uZHVyYXRpb25fbXMsXG4gICAgICAgICAgICAgICAgYXJ0aXN0OiBtLmFydGlzdHMubWFwKChtKSA9PiBtLm5hbWUpLmpvaW4oJywgJyksXG4gICAgICAgICAgICAgICAgdXJsOiBtLmV4dGVybmFsX3VybHM/LnNwb3RpZnkgfHwgYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFjay8ke20uaWR9YCxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGRhdGEuaW1hZ2VzPy5bMF0/LnVybCB8fCBudWxsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGlmICghdHJhY2tzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBhdXRob3I6IGRhdGEuYXJ0aXN0cy5tYXAoKG0pID0+IG0ubmFtZSkuam9pbignLCAnKSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGRhdGEuaW1hZ2VzPy5bMF0/LnVybCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkLFxuICAgICAgICAgICAgICAgIHVybDogZGF0YS5leHRlcm5hbF91cmxzLnNwb3RpZnkgfHwgYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS9hbGJ1bS8ke2lkfWAsXG4gICAgICAgICAgICAgICAgdHJhY2tzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNwb3RpZnlUcmFjayB7XG4gICAgYWxidW06IHtcbiAgICAgICAgaW1hZ2VzOiB7XG4gICAgICAgICAgICBoZWlnaHQ6IG51bWJlcjtcbiAgICAgICAgICAgIHVybDogc3RyaW5nO1xuICAgICAgICAgICAgd2lkdGg6IG51bWJlcjtcbiAgICAgICAgfVtdO1xuICAgIH07XG4gICAgYXJ0aXN0czoge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgfVtdO1xuICAgIGR1cmF0aW9uX21zOiBudW1iZXI7XG4gICAgZXhwbGljaXQ6IGJvb2xlYW47XG4gICAgZXh0ZXJuYWxfdXJsczogeyBzcG90aWZ5OiBzdHJpbmcgfTtcbiAgICBpZDogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbn1cbiIsICJpbXBvcnQgeyBCYXNlRXh0cmFjdG9yLCB0eXBlIEV4dHJhY3RvckV4ZWN1dGlvbkNvbnRleHQgfSBmcm9tICdkaXNjb3JkLXBsYXllcic7XG5pbXBvcnQgeyBCcmlkZ2VQcm92aWRlciwgQnJpZGdlU291cmNlLCBkZWZhdWx0QnJpZGdlUHJvdmlkZXIsIElCcmlkZ2VTb3VyY2UgfSBmcm9tICcuL2NvbW1vbi9CcmlkZ2VQcm92aWRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnJpZGdlZE9wdGlvbiB7XG4gICAgYnJpZGdlUHJvdmlkZXI/OiBCcmlkZ2VQcm92aWRlcjtcbn1cblxuZXhwb3J0IGNsYXNzIEJyaWRnZWRFeHRyYWN0b3I8VCBleHRlbmRzIEJyaWRnZWRPcHRpb24+IGV4dGVuZHMgQmFzZUV4dHJhY3RvcjxUPiB7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGNvbnRleHQ6IEV4dHJhY3RvckV4ZWN1dGlvbkNvbnRleHQsIG9wdGlvbnM/OiBUIHwgdW5kZWZpbmVkKSB7XG4gICAgICAgIHN1cGVyKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRCcmlkZ2VQcm92aWRlcihwcm92aWRlcjogQnJpZGdlUHJvdmlkZXIpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyID0gcHJvdmlkZXI7XG4gICAgfVxuXG4gICAgcHVibGljIHNldEJyaWRnZVByb3ZpZGVyU291cmNlKHNvdXJjZTogQnJpZGdlU291cmNlIHwgSUJyaWRnZVNvdXJjZSkge1xuICAgICAgICB0aGlzLmJyaWRnZVByb3ZpZGVyLnNldEJyaWRnZVNvdXJjZShzb3VyY2UpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgYnJpZGdlUHJvdmlkZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIgPz8gZGVmYXVsdEJyaWRnZVByb3ZpZGVyO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBCYXNlRXh0cmFjdG9yLCBUcmFjayB9IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB7IFNvdW5kY2xvdWRUcmFja1YyIH0gZnJvbSAnc291bmRjbG91ZC50cyc7XG5pbXBvcnQgeyBWaWRlbyB9IGZyb20gJ3lvdXR1YmUtc3InO1xuaW1wb3J0IHsgU291bmRDbG91ZEV4dHJhY3RvciB9IGZyb20gJy4uL1NvdW5kQ2xvdWRFeHRyYWN0b3InO1xuaW1wb3J0IHsgWW91VHViZUV4dHJhY3RvciB9IGZyb20gJy4uL1lvdXR1YmVFeHRyYWN0b3InO1xuaW1wb3J0IHsgcHVsbFNDTWV0YWRhdGEsIHB1bGxZVE1ldGFkYXRhIH0gZnJvbSAnLi9oZWxwZXInO1xuXG5leHBvcnQgZW51bSBCcmlkZ2VTb3VyY2Uge1xuICAgIC8qKlxuICAgICAqIEF1dG9tYXRpY2FsbHkgcmVzb2x2ZSB0aGUgYnJpZGdlIHNvdXJjZVxuICAgICAqL1xuICAgIEF1dG8gPSAnYXV0bycsXG4gICAgLyoqXG4gICAgICogVXNlIFNvdW5kQ2xvdWQgYXMgdGhlIGJyaWRnZSBzb3VyY2VcbiAgICAgKi9cbiAgICBTb3VuZENsb3VkID0gJ3NvdW5kY2xvdWQnLFxuICAgIC8qKlxuICAgICAqIFVzZSBZb3VUdWJlIGFzIHRoZSBicmlkZ2Ugc291cmNlXG4gICAgICovXG4gICAgWW91VHViZSA9ICd5b3V0dWJlJ1xufVxuXG5leHBvcnQgdHlwZSBJQnJpZGdlU291cmNlID0gJ3NvdW5kY2xvdWQnIHwgJ3lvdXR1YmUnIHwgJ2F1dG8nO1xuXG5leHBvcnQgY2xhc3MgQnJpZGdlUHJvdmlkZXIge1xuICAgIHB1YmxpYyBicmlkZ2VTb3VyY2U6IEJyaWRnZVNvdXJjZSA9IEJyaWRnZVNvdXJjZS5Tb3VuZENsb3VkO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHNvdXJjZTogSUJyaWRnZVNvdXJjZSkge1xuICAgICAgICB0aGlzLnNldEJyaWRnZVNvdXJjZShzb3VyY2UpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRCcmlkZ2VTb3VyY2Uoc291cmNlOiBCcmlkZ2VTb3VyY2UgfCBJQnJpZGdlU291cmNlKSB7XG4gICAgICAgIHN3aXRjaCAoc291cmNlKSB7XG4gICAgICAgICAgICBjYXNlICdzb3VuZGNsb3VkJzpcbiAgICAgICAgICAgIGNhc2UgQnJpZGdlU291cmNlLlNvdW5kQ2xvdWQ6XG4gICAgICAgICAgICAgICAgdGhpcy5icmlkZ2VTb3VyY2UgPSBCcmlkZ2VTb3VyY2UuU291bmRDbG91ZDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3lvdXR1YmUnOlxuICAgICAgICAgICAgY2FzZSBCcmlkZ2VTb3VyY2UuWW91VHViZTpcbiAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZVNvdXJjZSA9IEJyaWRnZVNvdXJjZS5Zb3VUdWJlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYXV0byc6XG4gICAgICAgICAgICBjYXNlIEJyaWRnZVNvdXJjZS5BdXRvOlxuICAgICAgICAgICAgICAgIHRoaXMuYnJpZGdlU291cmNlID0gQnJpZGdlU291cmNlLkF1dG87XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgYnJpZGdlIHNvdXJjZScpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGlzU291bmRDbG91ZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnJpZGdlU291cmNlID09PSBCcmlkZ2VTb3VyY2UuU291bmRDbG91ZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgaXNZb3VUdWJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5icmlkZ2VTb3VyY2UgPT09IEJyaWRnZVNvdXJjZS5Zb3VUdWJlO1xuICAgIH1cblxuICAgIHB1YmxpYyBpc0F1dG8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJyaWRnZVNvdXJjZSA9PT0gQnJpZGdlU291cmNlLkF1dG87XG4gICAgfVxuXG4gICAgcHVibGljIHJlc29sdmVQcm92aWRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvKCkpIHtcbiAgICAgICAgICAgIGlmIChZb3VUdWJlRXh0cmFjdG9yLmluc3RhbmNlICYmICFpc0V4dERpc2FibGVkKFlvdVR1YmVFeHRyYWN0b3IuaW5zdGFuY2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEJyaWRnZVNvdXJjZS5Zb3VUdWJlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoU291bmRDbG91ZEV4dHJhY3Rvci5pbnN0YW5jZSAmJiAhaXNFeHREaXNhYmxlZChTb3VuZENsb3VkRXh0cmFjdG9yLmluc3RhbmNlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBCcmlkZ2VTb3VyY2UuU291bmRDbG91ZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgZmluZCBhbnkgYXZhaWxhYmxlIGV4dHJhY3RvcnMgZm9yIGF1dG9tYXRpYyBicmlkZ2luZy4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmJyaWRnZVNvdXJjZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcmVzb2x2ZShleHQ6IEJhc2VFeHRyYWN0b3IsIHRyYWNrOiBUcmFjaykge1xuICAgICAgICBjb25zdCBpc1NvdW5kY2xvdWQgPSB0aGlzLnJlc29sdmVQcm92aWRlcigpID09PSBCcmlkZ2VTb3VyY2UuU291bmRDbG91ZDtcbiAgICAgICAgY29uc3QgYnJpZGdlZm4gPSBpc1NvdW5kY2xvdWQgPyBwdWxsU0NNZXRhZGF0YSA6IHB1bGxZVE1ldGFkYXRhO1xuXG4gICAgICAgIC8vIHBhdGNoIHF1ZXJ5XG4gICAgICAgIGNvbnN0IG9sZFFjID0gZXh0LmNyZWF0ZUJyaWRnZVF1ZXJ5O1xuICAgICAgICBpZiAoaXNTb3VuZGNsb3VkKSBleHQuY3JlYXRlQnJpZGdlUXVlcnkgPSAodHJhY2spID0+IGAke3RyYWNrLmF1dGhvcn0gJHt0cmFjay50aXRsZX1gO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBicmlkZ2VmbihleHQsIHRyYWNrKTtcblxuICAgICAgICBleHQuZGVidWcoYEV4dHJhY3RlZCBicmlkZ2UgbWV0YWRhdGEgdXNpbmcgJHtpc1NvdW5kY2xvdWQgPyAnc291bmRjbG91ZCcgOiAneW91dHViZSd9IGV4dHJhY3RvcjogJHtKU09OLnN0cmluZ2lmeShyZXMpfWApO1xuXG4gICAgICAgIGV4dC5jcmVhdGVCcmlkZ2VRdWVyeSA9IG9sZFFjO1xuXG4gICAgICAgIHJldHVybiB7IHNvdXJjZTogaXNTb3VuZGNsb3VkID8gJ3NvdW5kY2xvdWQnIDogJ3lvdXR1YmUnLCBkYXRhOiByZXMgfSBhcyBCcmlkZ2VkTWV0YWRhdGE7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHN0cmVhbShtZXRhOiBCcmlkZ2VkTWV0YWRhdGEpIHtcbiAgICAgICAgaWYgKCFtZXRhLmRhdGEpIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgYnJpZGdlIG1ldGFkYXRhIGluZm8uJyk7XG5cbiAgICAgICAgaWYgKG1ldGEuc291cmNlID09PSAnc291bmRjbG91ZCcpIHtcbiAgICAgICAgICAgIGlmICghU291bmRDbG91ZEV4dHJhY3Rvci5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgc291bmRjbG91ZCBleHRyYWN0b3IsIG1ha2Ugc3VyZSBTb3VuZENsb3VkRXh0cmFjdG9yIGlzIGluc3RhbnRpYXRlZCBwcm9wZXJseS4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzRXh0RGlzYWJsZWQoU291bmRDbG91ZEV4dHJhY3Rvci5pbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBzdHJlYW0sIFNvdW5kQ2xvdWRFeHRyYWN0b3IgaXMgZGlzYWJsZWQuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBTb3VuZENsb3VkRXh0cmFjdG9yLmluc3RhbmNlLmludGVybmFsLnV0aWwuc3RyZWFtTGluayhtZXRhLmRhdGEgYXMgU291bmRjbG91ZFRyYWNrVjIsICdwcm9ncmVzc2l2ZScpO1xuICAgICAgICB9IGVsc2UgaWYgKG1ldGEuc291cmNlID09PSAneW91dHViZScpIHtcbiAgICAgICAgICAgIGlmICghWW91VHViZUV4dHJhY3Rvci5pbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgeW91dHViZSBleHRyYWN0b3IsIG1ha2Ugc3VyZSBZb3VUdWJlRXh0cmFjdG9yIGlzIGluc3RhbnRpYXRlZCBwcm9wZXJseS4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzRXh0RGlzYWJsZWQoWW91VHViZUV4dHJhY3Rvci5pbnN0YW5jZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBzdHJlYW0sIFlvdVR1YmVFeHRyYWN0b3IgaXMgZGlzYWJsZWQuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBZb3VUdWJlRXh0cmFjdG9yLmluc3RhbmNlLl9zdHJlYW0oKG1ldGEuZGF0YSBhcyBWaWRlbykudXJsLCBZb3VUdWJlRXh0cmFjdG9yLmluc3RhbmNlLCBZb3VUdWJlRXh0cmFjdG9yLmluc3RhbmNlLnN1cHBvcnRzRGVtdXgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBicmlkZ2Ugc291cmNlJyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGlzRXh0RGlzYWJsZWQoZXh0OiBCYXNlRXh0cmFjdG9yKSB7XG4gICAgY29uc3Qgc3RyZWFtQmxvY2tlZCA9ICEhZXh0LmNvbnRleHQucGxheWVyLm9wdGlvbnMuYmxvY2tTdHJlYW1Gcm9tPy5zb21lKCh4KSA9PiB4ID09PSBleHQuaWRlbnRpZmllcik7XG4gICAgLy8gY29uc3QgZXh0QmxvY2tlZCA9ICEhZXh0LmNvbnRleHQucGxheWVyLm9wdGlvbnMuYmxvY2tFeHRyYWN0b3JzPy5zb21lKCh4KSA9PiB4ID09PSBleHQuaWRlbnRpZmllcik7XG5cbiAgICByZXR1cm4gc3RyZWFtQmxvY2tlZDtcbn1cblxuaW50ZXJmYWNlIEJyaWRnZWRNZXRhZGF0YSB7XG4gICAgc291cmNlOiBJQnJpZGdlU291cmNlO1xuICAgIGRhdGE6IFNvdW5kY2xvdWRUcmFja1YyIHwgVmlkZW8gfCBudWxsO1xufVxuXG5leHBvcnQgY29uc3QgZGVmYXVsdEJyaWRnZVByb3ZpZGVyID0gbmV3IEJyaWRnZVByb3ZpZGVyKEJyaWRnZVNvdXJjZS5BdXRvKTtcbmV4cG9ydCBjb25zdCBjcmVhdGVCcmlkZ2VQcm92aWRlciA9IChzb3VyY2U6IEJyaWRnZVNvdXJjZSkgPT4gbmV3IEJyaWRnZVByb3ZpZGVyKHNvdXJjZSk7XG4iLCAiaW1wb3J0IHsgRXh0cmFjdG9ySW5mbywgRXh0cmFjdG9yU2VhcmNoQ29udGV4dCwgRXh0cmFjdG9yU3RyZWFtYWJsZSwgUGxheWxpc3QsIFF1ZXJ5VHlwZSwgU2VhcmNoUXVlcnlUeXBlLCBUcmFjaywgVXRpbCB9IGZyb20gJ2Rpc2NvcmQtcGxheWVyJztcbmltcG9ydCB0eXBlIHsgUmVhZGFibGUgfSBmcm9tICdzdHJlYW0nO1xuaW1wb3J0IHsgU3RyZWFtRk4sIGZldGNoLCBwdWxsWVRNZXRhZGF0YSB9IGZyb20gJy4vY29tbW9uL2hlbHBlcic7XG5pbXBvcnQgc3BvdGlmeSwgeyBTcG90aWZ5LCBTcG90aWZ5QWxidW0sIFNwb3RpZnlQbGF5bGlzdCwgU3BvdGlmeVNvbmcgfSBmcm9tICdzcG90aWZ5LXVybC1pbmZvJztcbmltcG9ydCB7IFNwb3RpZnlBUEkgfSBmcm9tICcuLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBCcmlkZ2VQcm92aWRlciB9IGZyb20gJy4vY29tbW9uL0JyaWRnZVByb3ZpZGVyJztcbmltcG9ydCB7IEJyaWRnZWRFeHRyYWN0b3IgfSBmcm9tICcuL0JyaWRnZWRFeHRyYWN0b3InO1xuXG5jb25zdCByZSA9IC9eKD86aHR0cHM6XFwvXFwvb3BlblxcLnNwb3RpZnlcXC5jb21cXC8oaW50bC0oW2Etel18W0EtWl0pezAsM31cXC8pPyg/OnVzZXJcXC9bQS1aYS16MC05XStcXC8pP3xzcG90aWZ5OikoYWxidW18cGxheWxpc3R8dHJhY2spKD86Wy86XSkoW0EtWmEtejAtOV0rKS4qJC87XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3BvdGlmeUV4dHJhY3RvckluaXQge1xuICAgIGNsaWVudElkPzogc3RyaW5nIHwgbnVsbDtcbiAgICBjbGllbnRTZWNyZXQ/OiBzdHJpbmcgfCBudWxsO1xuICAgIGNyZWF0ZVN0cmVhbT86IChleHQ6IFNwb3RpZnlFeHRyYWN0b3IsIHVybDogc3RyaW5nKSA9PiBQcm9taXNlPFJlYWRhYmxlIHwgc3RyaW5nPjtcbiAgICBicmlkZ2VQcm92aWRlcj86IEJyaWRnZVByb3ZpZGVyO1xufVxuXG5leHBvcnQgY2xhc3MgU3BvdGlmeUV4dHJhY3RvciBleHRlbmRzIEJyaWRnZWRFeHRyYWN0b3I8U3BvdGlmeUV4dHJhY3RvckluaXQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGlkZW50aWZpZXIgPSAnY29tLmRpc2NvcmQtcGxheWVyLnNwb3RpZnlleHRyYWN0b3InIGFzIGNvbnN0O1xuICAgIHByaXZhdGUgX3N0cmVhbSE6IFN0cmVhbUZOO1xuICAgIHByaXZhdGUgX2xpYiE6IFNwb3RpZnk7XG4gICAgcHJpdmF0ZSBfY3JlZGVudGlhbHMgPSB7XG4gICAgICAgIGNsaWVudElkOiB0aGlzLm9wdGlvbnMuY2xpZW50SWQgfHwgcHJvY2Vzcy5lbnYuRFBfU1BPVElGWV9DTElFTlRfSUQgfHwgbnVsbCxcbiAgICAgICAgY2xpZW50U2VjcmV0OiB0aGlzLm9wdGlvbnMuY2xpZW50U2VjcmV0IHx8IHByb2Nlc3MuZW52LkRQX1NQT1RJRllfQ0xJRU5UX1NFQ1JFVCB8fCBudWxsXG4gICAgfTtcbiAgICBwdWJsaWMgaW50ZXJuYWwgPSBuZXcgU3BvdGlmeUFQSSh0aGlzLl9jcmVkZW50aWFscyk7XG5cbiAgICBwdWJsaWMgYXN5bmMgYWN0aXZhdGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMucHJvdG9jb2xzID0gWydzcHNlYXJjaCcsICdzcG90aWZ5J107XG4gICAgICAgIHRoaXMuX2xpYiA9IHNwb3RpZnkoZmV0Y2gpO1xuICAgICAgICBpZiAodGhpcy5pbnRlcm5hbC5pc1Rva2VuRXhwaXJlZCgpKSBhd2FpdCB0aGlzLmludGVybmFsLnJlcXVlc3RUb2tlbigpO1xuXG4gICAgICAgIGNvbnN0IGZuID0gdGhpcy5vcHRpb25zLmNyZWF0ZVN0cmVhbTtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5fc3RyZWFtID0gKHE6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbih0aGlzLCBxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZGVhY3RpdmF0ZSgpIHtcbiAgICAgICAgdGhpcy5fc3RyZWFtID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgU3RyZWFtRk47XG4gICAgICAgIHRoaXMuX2xpYiA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFNwb3RpZnk7XG4gICAgICAgIHRoaXMucHJvdG9jb2xzID0gW107XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHZhbGlkYXRlKHF1ZXJ5OiBzdHJpbmcsIHR5cGU/OiBTZWFyY2hRdWVyeVR5cGUgfCBudWxsIHwgdW5kZWZpbmVkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICByZXR1cm4gKDxTZWFyY2hRdWVyeVR5cGVbXT5bXG4gICAgICAgICAgICBRdWVyeVR5cGUuU1BPVElGWV9BTEJVTSxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TUE9USUZZX1BMQVlMSVNULFxuICAgICAgICAgICAgUXVlcnlUeXBlLlNQT1RJRllfU09ORyxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5TUE9USUZZX1NFQVJDSCxcbiAgICAgICAgICAgIFF1ZXJ5VHlwZS5BVVRPLFxuICAgICAgICAgICAgUXVlcnlUeXBlLkFVVE9fU0VBUkNIXG4gICAgICAgIF0pLnNvbWUoKHQpID0+IHQgPT09IHR5cGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkVHJhY2tzKHRyYWNrOiBUcmFjaykge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGUodHJhY2suYXV0aG9yIHx8IHRyYWNrLnRpdGxlLCB7XG4gICAgICAgICAgICB0eXBlOiBRdWVyeVR5cGUuU1BPVElGWV9TRUFSQ0gsXG4gICAgICAgICAgICByZXF1ZXN0ZWRCeTogdHJhY2sucmVxdWVzdGVkQnlcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGhhbmRsZShxdWVyeTogc3RyaW5nLCBjb250ZXh0OiBFeHRyYWN0b3JTZWFyY2hDb250ZXh0KTogUHJvbWlzZTxFeHRyYWN0b3JJbmZvPiB7XG4gICAgICAgIGlmIChjb250ZXh0LnByb3RvY29sID09PSAnc3BzZWFyY2gnKSBjb250ZXh0LnR5cGUgPSBRdWVyeVR5cGUuU1BPVElGWV9TRUFSQ0g7XG4gICAgICAgIHN3aXRjaCAoY29udGV4dC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5BVVRPOlxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuQVVUT19TRUFSQ0g6XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5TUE9USUZZX1NFQVJDSDoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmludGVybmFsLnNlYXJjaChxdWVyeSk7XG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gdGhpcy5jcmVhdGVSZXNwb25zZSgpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVzcG9uc2UoXG4gICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWFwKChzcG90aWZ5RGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJhY2s6IFRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeURhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke3Nwb3RpZnlEYXRhLnRpdGxlfSBieSAke3Nwb3RpZnlEYXRhLmFydGlzdH1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc3BvdGlmeURhdGEuYXJ0aXN0ID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzcG90aWZ5RGF0YS51cmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5RGF0YS50aHVtYm5haWwgfHwgJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMoc3BvdGlmeURhdGEuZHVyYXRpb24gPz8gMCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogUXVlcnlUeXBlLlNQT1RJRllfU09ORyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHNwb3RpZnlEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlkZ2U6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBzcG90aWZ5RGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogKGF3YWl0IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlcj8ucmVzb2x2ZSh0aGlzLCB0cmFjaykpPy5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLmV4dHJhY3RvciA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFjaztcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBRdWVyeVR5cGUuU1BPVElGWV9TT05HOiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BvdGlmeURhdGE6IFNwb3RpZnlTb25nIHwgdm9pZCA9IGF3YWl0IHRoaXMuX2xpYi5nZXREYXRhKHF1ZXJ5LCBjb250ZXh0LnJlcXVlc3RPcHRpb25zIGFzIHVua25vd24gYXMgUmVxdWVzdEluaXQpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzcG90aWZ5RGF0YSkgcmV0dXJuIHsgcGxheWxpc3Q6IG51bGwsIHRyYWNrczogW10gfTtcbiAgICAgICAgICAgICAgICBjb25zdCBzcG90aWZ5VHJhY2s6IFRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNwb3RpZnlEYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7c3BvdGlmeURhdGEubmFtZX0gYnkgJHtzcG90aWZ5RGF0YS5hcnRpc3RzLm1hcCgobSkgPT4gbS5uYW1lKS5qb2luKCcsICcpfWAsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogc3BvdGlmeURhdGEuYXJ0aXN0c1swXT8ubmFtZSA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHNwb3RpZnlEYXRhLmlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFjay8ke3Nwb3RpZnlEYXRhLmlkfWAgOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5RGF0YS5jb3ZlckFydD8uc291cmNlcz8uWzBdPy51cmwgfHwgJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHNwb3RpZnlEYXRhLmR1cmF0aW9uID8/IHNwb3RpZnlEYXRhLm1heER1cmF0aW9uID8/IDApKSxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBjb250ZXh0LnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHNwb3RpZnlEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RNZXRhZGF0YTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHNwb3RpZnlEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyID8gKGF3YWl0IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlci5yZXNvbHZlKHRoaXMsIHNwb3RpZnlUcmFjaykpLmRhdGEgOiBhd2FpdCBwdWxsWVRNZXRhZGF0YSh0aGlzLCBzcG90aWZ5VHJhY2spXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzcG90aWZ5VHJhY2suZXh0cmFjdG9yID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFtzcG90aWZ5VHJhY2tdIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFF1ZXJ5VHlwZS5TUE9USUZZX1BMQVlMSVNUOiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBxdWVyeVR5cGUsIGlkIH0gPSB0aGlzLnBhcnNlKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5VHlwZSAhPT0gJ3BsYXlsaXN0JykgdGhyb3cgJ2Vycic7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BvdGlmeVBsYXlsaXN0ID0gYXdhaXQgdGhpcy5pbnRlcm5hbC5nZXRQbGF5bGlzdChpZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc3BvdGlmeVBsYXlsaXN0KSB0aHJvdyAnZXJyJztcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwbGF5bGlzdCA9IG5ldyBQbGF5bGlzdCh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogc3BvdGlmeVBsYXlsaXN0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc3BvdGlmeVBsYXlsaXN0Lm5hbWUgPz8gJycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNwb3RpZnlQbGF5bGlzdC50aHVtYm5haWwgPz8gJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGxheWxpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzcG90aWZ5UGxheWxpc3QuYXV0aG9yID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBudWxsIGFzIHVua25vd24gYXMgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzcG90aWZ5UGxheWxpc3QuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNwb3RpZnlQbGF5bGlzdC51cmwgfHwgcXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICByYXdQbGF5bGlzdDogc3BvdGlmeVBsYXlsaXN0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHBsYXlsaXN0LnRyYWNrcyA9IHNwb3RpZnlQbGF5bGlzdC50cmFja3MubWFwKChzcG90aWZ5RGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YTogVHJhY2sgPSBuZXcgVHJhY2sodGhpcy5jb250ZXh0LnBsYXllciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzcG90aWZ5RGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7c3BvdGlmeURhdGEudGl0bGV9IGJ5ICR7c3BvdGlmeURhdGEuYXJ0aXN0fWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBzcG90aWZ5RGF0YS5hcnRpc3QgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNwb3RpZnlEYXRhLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWw6IHNwb3RpZnlEYXRhLnRodW1ibmFpbCB8fCAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhzcG90aWZ5RGF0YS5kdXJhdGlvbiA/PyAwKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiBRdWVyeVR5cGUuU1BPVElGWV9TT05HLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc3BvdGlmeURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE1ldGFkYXRhOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHNwb3RpZnlEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIgPyAoYXdhaXQgdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyLnJlc29sdmUodGhpcywgZGF0YSkpLmRhdGEgOiBhd2FpdCBwdWxsWVRNZXRhZGF0YSh0aGlzLCBkYXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5leHRyYWN0b3IgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wbGF5bGlzdCA9IHBsYXlsaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH0pIGFzIFRyYWNrW107XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgcGxheWxpc3QsIHRyYWNrczogcGxheWxpc3QudHJhY2tzIH07XG4gICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwb3RpZnlQbGF5bGlzdDogU3BvdGlmeVBsYXlsaXN0IHwgdm9pZCA9IGF3YWl0IHRoaXMuX2xpYi5nZXREYXRhKHF1ZXJ5LCBjb250ZXh0LnJlcXVlc3RPcHRpb25zIGFzIHVua25vd24gYXMgUmVxdWVzdEluaXQpLmNhdGNoKFV0aWwubm9vcCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc3BvdGlmeVBsYXlsaXN0KSByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzcG90aWZ5UGxheWxpc3QubmFtZSA/PyBzcG90aWZ5UGxheWxpc3QudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc3BvdGlmeVBsYXlsaXN0LnRpdGxlID8/ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBzcG90aWZ5UGxheWxpc3QuY292ZXJBcnQ/LnNvdXJjZXM/LlswXT8udXJsID8/ICdodHRwczovL3d3dy5zY2RuLmNvL2kvX2dsb2JhbC90d2l0dGVyX2NhcmQtZGVmYXVsdC5qcGcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogc3BvdGlmeVBsYXlsaXN0LnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNwb3RpZnlQbGF5bGlzdC5zdWJ0aXRsZSA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCBhcyB1bmtub3duIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc3BvdGlmeVBsYXlsaXN0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzcG90aWZ5UGxheWxpc3QuaWQgPyBgaHR0cHM6Ly9vcGVuLnNwb3RpZnkuY29tL3BsYXlsaXN0LyR7c3BvdGlmeVBsYXlsaXN0LmlkfWAgOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBzcG90aWZ5UGxheWxpc3RcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QudHJhY2tzID0gc3BvdGlmeVBsYXlsaXN0LnRyYWNrTGlzdC5tYXAoKG0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGE6IFRyYWNrID0gbmV3IFRyYWNrKHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbS50aXRsZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IG0uc3VidGl0bGUgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG0udWlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS90cmFja3MvJHttLnVpZH1gIDogcXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogVXRpbC5idWlsZFRpbWVDb2RlKFV0aWwucGFyc2VNUyhtLmR1cmF0aW9uKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld3M6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkQnk6IGNvbnRleHQucmVxdWVzdGVkQnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUeXBlOiAnc3BvdGlmeVNvbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWV0YWRhdGE6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogdGhpcy5vcHRpb25zLmJyaWRnZVByb3ZpZGVyID8gKGF3YWl0IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlci5yZXNvbHZlKHRoaXMsIGRhdGEpKS5kYXRhIDogYXdhaXQgcHVsbFlUTWV0YWRhdGEodGhpcywgZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZXh0cmFjdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucGxheWxpc3QgPSBwbGF5bGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9KSBhcyBUcmFja1tdO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0LCB0cmFja3M6IHBsYXlsaXN0LnRyYWNrcyB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgUXVlcnlUeXBlLlNQT1RJRllfQUxCVU06IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHF1ZXJ5VHlwZSwgaWQgfSA9IHRoaXMucGFyc2UocXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlUeXBlICE9PSAnYWxidW0nKSB0aHJvdyAnZXJyJztcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcG90aWZ5QWxidW0gPSBhd2FpdCB0aGlzLmludGVybmFsLmdldEFsYnVtKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzcG90aWZ5QWxidW0pIHRocm93ICdlcnInO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBzcG90aWZ5QWxidW0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzcG90aWZ5QWxidW0ubmFtZSA/PyAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc3BvdGlmeUFsYnVtLnRodW1ibmFpbCA/PyAnaHR0cHM6Ly93d3cuc2Nkbi5jby9pL19nbG9iYWwvdHdpdHRlcl9jYXJkLWRlZmF1bHQuanBnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhbGJ1bScsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNwb3RpZnlBbGJ1bS5hdXRob3IgPz8gJ1Vua25vd24gQXJ0aXN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG51bGwgYXMgdW5rbm93biBhcyBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFja3M6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNwb3RpZnlBbGJ1bS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc3BvdGlmeUFsYnVtLnVybCB8fCBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBzcG90aWZ5QWxidW1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcGxheWxpc3QudHJhY2tzID0gc3BvdGlmeUFsYnVtLnRyYWNrcy5tYXAoKHNwb3RpZnlEYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhOiBUcmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNwb3RpZnlEYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtzcG90aWZ5RGF0YS50aXRsZX0gYnkgJHtzcG90aWZ5RGF0YS5hcnRpc3R9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHNwb3RpZnlEYXRhLmFydGlzdCA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc3BvdGlmeURhdGEudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogc3BvdGlmeURhdGEudGh1bWJuYWlsIHx8ICdodHRwczovL3d3dy5zY2RuLmNvL2kvX2dsb2JhbC90d2l0dGVyX2NhcmQtZGVmYXVsdC5qcGcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBVdGlsLmJ1aWxkVGltZUNvZGUoVXRpbC5wYXJzZU1TKHNwb3RpZnlEYXRhLmR1cmF0aW9uID8/IDApKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3czogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0ZWRCeTogY29udGV4dC5yZXF1ZXN0ZWRCeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVR5cGU6IFF1ZXJ5VHlwZS5TUE9USUZZX1NPTkcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBzcG90aWZ5RGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpZGdlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0TWV0YWRhdGE6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc3BvdGlmeURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlkZ2U6IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlciA/IChhd2FpdCB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIucmVzb2x2ZSh0aGlzLCBkYXRhKSkuZGF0YSA6IGF3YWl0IHB1bGxZVE1ldGFkYXRhKHRoaXMsIGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnBsYXlsaXN0ID0gcGxheWxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSkgYXMgVHJhY2tbXTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdCwgdHJhY2tzOiBwbGF5bGlzdC50cmFja3MgfTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWxidW06IFNwb3RpZnlBbGJ1bSB8IHZvaWQgPSBhd2FpdCB0aGlzLl9saWIuZ2V0RGF0YShxdWVyeSwgY29udGV4dC5yZXF1ZXN0T3B0aW9ucyBhcyB1bmtub3duIGFzIFJlcXVlc3RJbml0KS5jYXRjaChVdGlsLm5vb3ApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFsYnVtKSByZXR1cm4geyBwbGF5bGlzdDogbnVsbCwgdHJhY2tzOiBbXSB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYXlsaXN0ID0gbmV3IFBsYXlsaXN0KHRoaXMuY29udGV4dC5wbGF5ZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBhbGJ1bS5uYW1lID8/IGFsYnVtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFsYnVtLnRpdGxlID8/ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBhbGJ1bS5jb3ZlckFydD8uc291cmNlcz8uWzBdPy51cmwgPz8gJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBhbGJ1bS50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3BvdGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhbGJ1bS5zdWJ0aXRsZSA/PyAnVW5rbm93biBBcnRpc3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCBhcyB1bmtub3duIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogYWxidW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGFsYnVtLmlkID8gYGh0dHBzOi8vb3Blbi5zcG90aWZ5LmNvbS9wbGF5bGlzdC8ke2FsYnVtLmlkfWAgOiBxdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1BsYXlsaXN0OiBhbGJ1bVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBwbGF5bGlzdC50cmFja3MgPSBhbGJ1bS50cmFja0xpc3QubWFwKChtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhOiBUcmFjayA9IG5ldyBUcmFjayh0aGlzLmNvbnRleHQucGxheWVyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG0udGl0bGUgPz8gJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IG0udGl0bGUgPz8gJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBtLnN1YnRpdGxlID8/ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBtLnVpZCA/IGBodHRwczovL29wZW4uc3BvdGlmeS5jb20vdHJhY2tzLyR7bS51aWR9YCA6IHF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbDogJ2h0dHBzOi8vd3d3LnNjZG4uY28vaS9fZ2xvYmFsL3R3aXR0ZXJfY2FyZC1kZWZhdWx0LmpwZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFV0aWwuYnVpbGRUaW1lQ29kZShVdGlsLnBhcnNlTVMobS5kdXJhdGlvbikpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZEJ5OiBjb250ZXh0LnJlcXVlc3RlZEJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3Nwb3RpZnknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VHlwZTogJ3Nwb3RpZnlTb25nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IG0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyaWRnZTogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE1ldGFkYXRhOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IG0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmlkZ2U6IHRoaXMub3B0aW9ucy5icmlkZ2VQcm92aWRlciA/IChhd2FpdCB0aGlzLm9wdGlvbnMuYnJpZGdlUHJvdmlkZXIucmVzb2x2ZSh0aGlzLCBkYXRhKSkuZGF0YSA6IGF3YWl0IHB1bGxZVE1ldGFkYXRhKHRoaXMsIGRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmV4dHJhY3RvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnBsYXlsaXN0ID0gcGxheWxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfSkgYXMgVHJhY2tbXTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBwbGF5bGlzdCwgdHJhY2tzOiBwbGF5bGlzdC50cmFja3MgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7IHBsYXlsaXN0OiBudWxsLCB0cmFja3M6IFtdIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc3RyZWFtKGluZm86IFRyYWNrKTogUHJvbWlzZTxFeHRyYWN0b3JTdHJlYW1hYmxlPiB7XG4gICAgICAgIGlmICh0aGlzLl9zdHJlYW0pIHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IHRoaXMuX3N0cmVhbShpbmZvLnVybCwgdGhpcyk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0cmVhbSA9PT0gJ3N0cmluZycpIHJldHVybiBzdHJlYW07XG4gICAgICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGVnYWN5IGFwaVxuICAgICAgICBpZiAoISgncmVxdWVzdEJyaWRnZScgaW4gdGhpcy5jb250ZXh0KSkge1xuICAgICAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmJyaWRnZVByb3ZpZGVyO1xuICAgICAgICAgICAgaWYgKCFwcm92aWRlcikgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBicmlkZ2UgcHJvdmlkZXIgZm9yICcke3RoaXMuY29uc3RydWN0b3IubmFtZX0nYCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwcm92aWRlci5yZXNvbHZlKHRoaXMsIGluZm8pO1xuICAgICAgICAgICAgaWYgKCFkYXRhKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBicmlkZ2UgdGhpcyB0cmFjaycpO1xuXG4gICAgICAgICAgICBpbmZvLnNldE1ldGFkYXRhKHtcbiAgICAgICAgICAgICAgICAuLi4oaW5mby5tZXRhZGF0YSB8fCB7fSksXG4gICAgICAgICAgICAgICAgYnJpZGdlOiBkYXRhLmRhdGFcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgcHJvdmlkZXIuc3RyZWFtKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbmV3IGFwaVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNvbnRleHQucmVxdWVzdEJyaWRnZShpbmZvLCB0aGlzKTtcblxuICAgICAgICBpZiAoIXJlc3VsdD8ucmVzdWx0KSB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBicmlkZ2UgdGhpcyB0cmFjaycpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0O1xuICAgIH1cblxuICAgIHB1YmxpYyBwYXJzZShxOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgWywgLCAsIHF1ZXJ5VHlwZSwgaWRdID0gcmUuZXhlYyhxKSB8fCBbXTtcblxuICAgICAgICByZXR1cm4geyBxdWVyeVR5cGUsIGlkIH07XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FDQ0EsNEJBV087QUFDUCxpQkFBNEI7OztBQ1o1Qix3QkFBd0I7QUFFeEIsZ0NBQW9CO0FBQ3BCLGtCQUFpQjtBQUNqQixtQkFBa0I7QUFHbEIsSUFBSTtBQU1HLElBQU0sZUFBZSx3QkFBQyxRQUFnQixPQUFPLEtBQUssTUFBTSxNQUFNLElBQUksR0FB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Q3RCLFFBQVEsS0FBSztBQUFBLE1BQ2pCLENBQUM7QUFFRCxhQUFPLE1BQU0sU0FBUyxPQUFPLElBQUk7QUFBQSxJQUNyQztBQUdBLFVBQU0sU0FBUyxNQUFNLEtBQUssUUFBUSxjQUFjLE1BQU0sSUFBSTtBQUUxRCxRQUFJLENBQUMsUUFBUTtBQUFRLFlBQU0sSUFBSSxNQUFNLDZCQUE2QjtBQUVsRSxXQUFPLE9BQU87QUFBQSxFQUNsQjtBQUFBLEVBRU8sTUFBTSxHQUFXO0FBQ3BCLFVBQU0sQ0FBQyxFQUFFLEVBQUUsRUFBRSxXQUFXLEVBQUUsSUFBSSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7QUFFN0MsV0FBTyxFQUFFLFdBQVcsR0FBRztBQUFBLEVBQzNCO0FBQ0o7QUFsWDZFO0FBQWhFLGtCQUNLLGFBQWE7QUFEeEIsSUFBTSxtQkFBTjs7O0FoQmJBLElBQU0sVUFBa0I7IiwKICAibmFtZXMiOiBbInVuZmV0Y2giLCAibGliIiwgIm9wdGlvbnMiLCAiaHR0cCIsICJodHRwcyIsICJmbXQiLCAiZm9ybWF0IiwgImltcG9ydF95b3V0dWJlX3NyIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJHZW5pdXNDbGllbnQiLCAiaW1wb3J0X2Rpc2NvcmRfcGxheWVyIiwgImltcG9ydF9odHRwIiwgImltcG9ydF9odHRwcyIsICJodHRwcyIsICJodHRwIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJyZXZlcmJuYXRpb24iLCAiaW1wb3J0X2Rpc2NvcmRfcGxheWVyIiwgImltcG9ydF9odHRwIiwgImltcG9ydF9odHRwcyIsICJodHRwIiwgImh0dHBzIiwgInBhdGgiLCAiaW1wb3J0X2Rpc2NvcmRfcGxheWVyIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJyIiwgIm0iLCAicmVzIiwgImltcG9ydF9kaXNjb3JkX3BsYXllciIsICJCcmlkZ2VTb3VyY2UiLCAidHJhY2siLCAiaW1wb3J0X2Rpc2NvcmRfcGxheWVyIiwgInNwb3RpZnkiXQp9Cg==